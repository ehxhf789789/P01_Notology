/* Global Font - Default */
*, *::before, *::after { font-family: var(--app-font, "Malgun Gothic", "맑은 고딕", "Gulim", "굴림", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif); }

/* Prevent white flash on window load - set background before CSS variables load */
html, body { background-color: #1a1a1a; margin: 0; padding: 0; }
html[data-theme="light"], html[data-theme="light"] body { background-color: #f5f5f5; }

/* Font Settings */
:root {
  --app-font: "Malgun Gothic", "맑은 고딕", "Gulim", "굴림", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;
  --editor-font-size: 14px;
}

html[data-font="default"] { --app-font: "Pretendard", "Malgun Gothic", "맑은 고딕", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif; }
html[data-font="nanum"] { --app-font: "NanumGothic", "나눔고딕", "Malgun Gothic", "맑은 고딕", sans-serif; }
html[data-font="noto"] { --app-font: "Noto Sans KR", "Malgun Gothic", "맑은 고딕", sans-serif; }
html[data-font="malgun"] { --app-font: "Malgun Gothic", "맑은 고딕", "Gulim", "굴림", sans-serif; }
html[data-font="custom"] { --app-font: var(--custom-font-family, "Malgun Gothic"), "Malgun Gothic", "맑은 고딕", sans-serif; }

/* ============================================================ */
/* Theme Variables - Dark (Default) */
/* ============================================================ */
:root,
html[data-theme="dark"] {
  --bg-primary: #1a1a1a;
  --bg-secondary: #242424;
  --bg-tertiary: #2d2d2d;
  --bg-elevated: #333;
  --bg-hover: #3a3a3a;
  --bg-hover-rgba: rgba(42, 42, 42, 1);
  --text-primary: #e0e0e0;
  --text-secondary: #aaa;
  --text-muted: #888;
  --border-color: #444;
  --border-light: #555;
  --accent-color: #00d4aa;
  --accent-hover: #00e5bb;
  --accent-primary: #60a5fa;
  --shadow-color: rgba(0, 0, 0, 0.3);
  --calendar-today-bg: #264f78;
  --calendar-today-hover: #2d5a89;
  --calendar-selected-bg: #094771;
  --calendar-selected-border: #007acc;
  /* Code Block - Dark Theme (Catppuccin Mocha inspired) */
  --code-bg: #1e1e2e;
  --code-border: #313244;
  --code-text: #cdd6f4;
  --code-inline-bg: rgba(122, 162, 247, 0.15);
  --code-inline-text: #7aa2f7;
  --code-comment: #6c7086;
  --code-keyword: #cba6f7;
  --code-string: #a6e3a1;
  --code-number: #fab387;
  --code-function: #89b4fa;
  --code-variable: #f38ba8;
  --code-property: #89dceb;
  --code-operator: #94e2d5;
  --code-tag: #f38ba8;
  --code-attribute: #fab387;
  --code-punctuation: #9399b2;
  --code-type: #f9e2af;
}

/* ============================================================ */
/* Theme Variables - Light */
/* ============================================================ */
html[data-theme="light"] {
  --bg-primary: #ffffff;
  --bg-secondary: #f5f5f5;
  --bg-tertiary: #e8e8e8;
  --bg-elevated: #ffffff;
  --bg-hover: #e0e0e0;
  --bg-hover-rgba: rgba(220, 220, 220, 1);
  --text-primary: #1a1a1a;
  --text-secondary: #555;
  --text-muted: #888;
  --border-color: #ddd;
  --border-light: #ccc;
  --accent-color: #00a884;
  --accent-hover: #00b894;
  --accent-primary: #3b82f6;
  --shadow-color: rgba(0, 0, 0, 0.1);
  --calendar-today-bg: #e3f0ff;
  --calendar-today-hover: #d4e6fc;
  --calendar-selected-bg: #cce5ff;
  --calendar-selected-border: #007acc;
  /* Code Block - Light Theme */
  --code-bg: #f8f9fc;
  --code-border: #e2e4e9;
  --code-text: #3c3f4a;
  --code-inline-bg: rgba(59, 130, 246, 0.1);
  --code-inline-text: #2563eb;
  --code-comment: #6b7280;
  --code-keyword: #8b5cf6;
  --code-string: #059669;
  --code-number: #d97706;
  --code-function: #2563eb;
  --code-variable: #dc2626;
  --code-property: #0891b2;
  --code-operator: #0d9488;
  --code-tag: #dc2626;
  --code-attribute: #d97706;
  --code-punctuation: #6b7280;
  --code-type: #ca8a04;
}

/* System theme - follow OS preference */
@media (prefers-color-scheme: light) {
  html[data-theme="system"] {
    --bg-primary: #ffffff;
    --bg-secondary: #f5f5f5;
    --bg-tertiary: #e8e8e8;
    --bg-elevated: #ffffff;
    --bg-hover: #e0e0e0;
    --bg-hover-rgba: rgba(220, 220, 220, 1);
    --text-primary: #1a1a1a;
    --text-secondary: #555;
    --text-muted: #888;
    --border-color: #ddd;
    --border-light: #ccc;
    --accent-color: #00a884;
    --accent-hover: #00b894;
    --accent-primary: #3b82f6;
    --shadow-color: rgba(0, 0, 0, 0.1);
    --calendar-today-bg: #e3f0ff;
    --calendar-today-hover: #d4e6fc;
    --calendar-selected-bg: #cce5ff;
    --calendar-selected-border: #007acc;
    /* Code Block - Light Theme */
    --code-bg: #f8f9fc;
    --code-border: #e2e4e9;
    --code-text: #3c3f4a;
    --code-inline-bg: rgba(59, 130, 246, 0.1);
    --code-inline-text: #2563eb;
    --code-comment: #6b7280;
    --code-keyword: #8b5cf6;
    --code-string: #059669;
    --code-number: #d97706;
    --code-function: #2563eb;
    --code-variable: #dc2626;
    --code-property: #0891b2;
    --code-operator: #0d9488;
    --code-tag: #dc2626;
    --code-attribute: #d97706;
    --code-punctuation: #6b7280;
    --code-type: #ca8a04;
  }
}

@media (prefers-color-scheme: dark) {
  html[data-theme="system"] {
    --bg-primary: #1a1a1a;
    --bg-secondary: #242424;
    --bg-tertiary: #2d2d2d;
    --bg-elevated: #333;
    --bg-hover: #3a3a3a;
    --bg-hover-rgba: rgba(42, 42, 42, 1);
    --text-primary: #e0e0e0;
    --text-secondary: #aaa;
    --text-muted: #888;
    --border-color: #444;
    --border-light: #555;
    --accent-color: #00d4aa;
    --accent-hover: #00e5bb;
    --accent-primary: #60a5fa;
    --shadow-color: rgba(0, 0, 0, 0.3);
    --calendar-today-bg: #264f78;
    --calendar-today-hover: #2d5a89;
    --calendar-selected-bg: #094771;
    --calendar-selected-border: #007acc;
    /* Code Block - Dark Theme */
    --code-bg: #1e1e2e;
    --code-border: #313244;
    --code-text: #cdd6f4;
    --code-inline-bg: rgba(122, 162, 247, 0.15);
    --code-inline-text: #7aa2f7;
    --code-comment: #6c7086;
    --code-keyword: #cba6f7;
    --code-string: #a6e3a1;
    --code-number: #fab387;
    --code-function: #89b4fa;
    --code-variable: #f38ba8;
    --code-property: #89dceb;
    --code-operator: #94e2d5;
    --code-tag: #f38ba8;
    --code-attribute: #fab387;
    --code-punctuation: #9399b2;
    --code-type: #f9e2af;
  }
}

/* ============================================================ */
/* Scrollbar Styling - Dark/Light Mode */
/* ============================================================ */

/* Dark mode scrollbar */
:root,
html[data-theme="dark"] {
  --scrollbar-track: rgba(0, 0, 0, 0.2);
  --scrollbar-thumb: rgba(255, 255, 255, 0.15);
  --scrollbar-thumb-hover: rgba(255, 255, 255, 0.25);
  --scrollbar-thumb-active: rgba(255, 255, 255, 0.35);
}

/* Light mode scrollbar */
html[data-theme="light"] {
  --scrollbar-track: rgba(0, 0, 0, 0.05);
  --scrollbar-thumb: rgba(0, 0, 0, 0.2);
  --scrollbar-thumb-hover: rgba(0, 0, 0, 0.3);
  --scrollbar-thumb-active: rgba(0, 0, 0, 0.4);
}

/* System theme scrollbar */
@media (prefers-color-scheme: light) {
  html[data-theme="system"] {
    --scrollbar-track: rgba(0, 0, 0, 0.05);
    --scrollbar-thumb: rgba(0, 0, 0, 0.2);
    --scrollbar-thumb-hover: rgba(0, 0, 0, 0.3);
    --scrollbar-thumb-active: rgba(0, 0, 0, 0.4);
  }
}

@media (prefers-color-scheme: dark) {
  html[data-theme="system"] {
    --scrollbar-track: rgba(0, 0, 0, 0.2);
    --scrollbar-thumb: rgba(255, 255, 255, 0.15);
    --scrollbar-thumb-hover: rgba(255, 255, 255, 0.25);
    --scrollbar-thumb-active: rgba(255, 255, 255, 0.35);
  }
}

/* Webkit scrollbar styling (Chrome, Safari, Edge) */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: var(--scrollbar-track);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: var(--scrollbar-thumb);
  border-radius: 4px;
  transition: background 0.15s ease;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--scrollbar-thumb-hover);
}

::-webkit-scrollbar-thumb:active {
  background: var(--scrollbar-thumb-active);
}

::-webkit-scrollbar-corner {
  background: transparent;
}

/* Thin scrollbar variant for smaller containers */
.thin-scrollbar::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

/* Firefox scrollbar styling */
* {
  scrollbar-width: thin;
  scrollbar-color: var(--scrollbar-thumb) var(--scrollbar-track);
}

/* Apply editor font size to editor content */
.tiptap-editor, .hover-tiptap-editor, .ProseMirror { font-size: var(--editor-font-size); }

/* ============================================================ */
/* CSS Variables - Note Type Colors */
/* ============================================================ */
:root {
  /* NOTE - 연구노트 (Purple) */
  --note-color: #a78bfa;
  --note-bg: rgba(167, 139, 250, 0.06);
  --note-bg-hover: rgba(167, 139, 250, 0.12);
  --note-border: rgba(167, 139, 250, 0.6);
  --note-header: rgba(167, 139, 250, 0.15);

  /* MTG - 회의록 (Blue) */
  --mtg-color: #60a5fa;
  --mtg-bg: rgba(96, 165, 250, 0.06);
  --mtg-bg-hover: rgba(96, 165, 250, 0.12);
  --mtg-border: rgba(96, 165, 250, 0.6);
  --mtg-header: rgba(96, 165, 250, 0.15);

  /* SEM - 세미나 (Orange) */
  --sem-color: #fb923c;
  --sem-bg: rgba(251, 146, 60, 0.06);
  --sem-bg-hover: rgba(251, 146, 60, 0.12);
  --sem-border: rgba(251, 146, 60, 0.6);
  --sem-header: rgba(251, 146, 60, 0.15);

  /* EVENT - 행사 (Red) */
  --event-color: #f87171;
  --event-bg: rgba(248, 113, 113, 0.06);
  --event-bg-hover: rgba(248, 113, 113, 0.12);
  --event-border: rgba(248, 113, 113, 0.6);
  --event-header: rgba(248, 113, 113, 0.15);

  /* OFA - 공무행정 (Green) */
  --ofa-color: #34d399;
  --ofa-bg: rgba(52, 211, 153, 0.06);
  --ofa-bg-hover: rgba(52, 211, 153, 0.12);
  --ofa-border: rgba(52, 211, 153, 0.6);
  --ofa-header: rgba(52, 211, 153, 0.15);

  /* CONTACT - 연락처 (Cyan) */
  --contact-color: #22d3ee;
  --contact-bg: rgba(34, 211, 238, 0.06);
  --contact-bg-hover: rgba(34, 211, 238, 0.12);
  --contact-border: rgba(34, 211, 238, 0.6);
  --contact-header: rgba(34, 211, 238, 0.15);

  /* SETUP - 설정 (Gray) */
  --setup-color: #9ca3af;
  --setup-bg: rgba(156, 163, 175, 0.06);
  --setup-bg-hover: rgba(156, 163, 175, 0.12);
  --setup-border: rgba(156, 163, 175, 0.6);
  --setup-header: rgba(156, 163, 175, 0.15);

  /* DATA - 자료 (Amber) */
  --data-color: #fbbf24;
  --data-bg: rgba(251, 191, 36, 0.06);
  --data-bg-hover: rgba(251, 191, 36, 0.12);
  --data-border: rgba(251, 191, 36, 0.6);
  --data-header: rgba(251, 191, 36, 0.15);

  /* THEO - 이론 (Indigo) */
  --theo-color: #818cf8;
  --theo-bg: rgba(129, 140, 248, 0.06);
  --theo-bg-hover: rgba(129, 140, 248, 0.12);
  --theo-border: rgba(129, 140, 248, 0.6);
  --theo-header: rgba(129, 140, 248, 0.15);

  /* PAPER - 논문 (Teal) */
  --paper-color: #5eead4;
  --paper-bg: rgba(94, 234, 212, 0.06);
  --paper-bg-hover: rgba(94, 234, 212, 0.12);
  --paper-border: rgba(94, 234, 212, 0.6);
  --paper-header: rgba(94, 234, 212, 0.15);

  /* LIT - 문헌 (Lime) */
  --lit-color: #a3e635;
  --lit-bg: rgba(163, 230, 53, 0.06);
  --lit-bg-hover: rgba(163, 230, 53, 0.12);
  --lit-border: rgba(163, 230, 53, 0.6);
  --lit-header: rgba(163, 230, 53, 0.15);

  /* SKETCH - 스케치/캔버스 (Pink) */
  --sketch-color: #f472b6;
  --sketch-bg: rgba(244, 114, 182, 0.06);
  --sketch-bg-hover: rgba(244, 114, 182, 0.12);
  --sketch-border: rgba(244, 114, 182, 0.6);
  --sketch-header: rgba(244, 114, 182, 0.15);
}

/* ============================================================ */
/* CSS Variables - Note Type Colors (Light Mode) */
/* ============================================================ */
html[data-theme="light"] {
  /* NOTE - 연구노트 (Purple - darker for light mode) */
  --note-color: #7c3aed;
  --note-bg: rgba(124, 58, 237, 0.08);
  --note-bg-hover: rgba(124, 58, 237, 0.15);
  --note-border: rgba(124, 58, 237, 0.5);
  --note-header: rgba(124, 58, 237, 0.12);

  /* MTG - 회의록 (Blue - darker) */
  --mtg-color: #2563eb;
  --mtg-bg: rgba(37, 99, 235, 0.08);
  --mtg-bg-hover: rgba(37, 99, 235, 0.15);
  --mtg-border: rgba(37, 99, 235, 0.5);
  --mtg-header: rgba(37, 99, 235, 0.12);

  /* SEM - 세미나 (Orange - darker) */
  --sem-color: #ea580c;
  --sem-bg: rgba(234, 88, 12, 0.08);
  --sem-bg-hover: rgba(234, 88, 12, 0.15);
  --sem-border: rgba(234, 88, 12, 0.5);
  --sem-header: rgba(234, 88, 12, 0.12);

  /* EVENT - 행사 (Red - darker) */
  --event-color: #dc2626;
  --event-bg: rgba(220, 38, 38, 0.08);
  --event-bg-hover: rgba(220, 38, 38, 0.15);
  --event-border: rgba(220, 38, 38, 0.5);
  --event-header: rgba(220, 38, 38, 0.12);

  /* OFA - 공무행정 (Green - darker) */
  --ofa-color: #059669;
  --ofa-bg: rgba(5, 150, 105, 0.08);
  --ofa-bg-hover: rgba(5, 150, 105, 0.15);
  --ofa-border: rgba(5, 150, 105, 0.5);
  --ofa-header: rgba(5, 150, 105, 0.12);

  /* CONTACT - 연락처 (Cyan - darker) */
  --contact-color: #0891b2;
  --contact-bg: rgba(8, 145, 178, 0.08);
  --contact-bg-hover: rgba(8, 145, 178, 0.15);
  --contact-border: rgba(8, 145, 178, 0.5);
  --contact-header: rgba(8, 145, 178, 0.12);

  /* SETUP - 설정 (Gray - darker) */
  --setup-color: #6b7280;
  --setup-bg: rgba(107, 114, 128, 0.08);
  --setup-bg-hover: rgba(107, 114, 128, 0.15);
  --setup-border: rgba(107, 114, 128, 0.5);
  --setup-header: rgba(107, 114, 128, 0.12);

  /* DATA - 자료 (Amber - darker) */
  --data-color: #d97706;
  --data-bg: rgba(217, 119, 6, 0.08);
  --data-bg-hover: rgba(217, 119, 6, 0.15);
  --data-border: rgba(217, 119, 6, 0.5);
  --data-header: rgba(217, 119, 6, 0.12);

  /* THEO - 이론 (Indigo - darker) */
  --theo-color: #4f46e5;
  --theo-bg: rgba(79, 70, 229, 0.08);
  --theo-bg-hover: rgba(79, 70, 229, 0.15);
  --theo-border: rgba(79, 70, 229, 0.5);
  --theo-header: rgba(79, 70, 229, 0.12);

  /* PAPER - 논문 (Teal - darker) */
  --paper-color: #0d9488;
  --paper-bg: rgba(13, 148, 136, 0.08);
  --paper-bg-hover: rgba(13, 148, 136, 0.15);
  --paper-border: rgba(13, 148, 136, 0.5);
  --paper-header: rgba(13, 148, 136, 0.12);

  /* LIT - 문헌 (Lime - darker) */
  --lit-color: #65a30d;
  --lit-bg: rgba(101, 163, 13, 0.08);
  --lit-bg-hover: rgba(101, 163, 13, 0.15);
  --lit-border: rgba(101, 163, 13, 0.5);
  --lit-header: rgba(101, 163, 13, 0.12);

  /* SKETCH - 스케치/캔버스 (Pink - darker) */
  --sketch-color: #db2777;
  --sketch-bg: rgba(219, 39, 119, 0.08);
  --sketch-bg-hover: rgba(219, 39, 119, 0.15);
  --sketch-border: rgba(219, 39, 119, 0.5);
  --sketch-header: rgba(219, 39, 119, 0.12);
}

@media (prefers-color-scheme: light) {
  html[data-theme="system"] {
    /* NOTE - 연구노트 (Purple - darker for light mode) */
    --note-color: #7c3aed;
    --note-bg: rgba(124, 58, 237, 0.08);
    --note-bg-hover: rgba(124, 58, 237, 0.15);
    --note-border: rgba(124, 58, 237, 0.5);
    --note-header: rgba(124, 58, 237, 0.12);

    /* MTG - 회의록 (Blue - darker) */
    --mtg-color: #2563eb;
    --mtg-bg: rgba(37, 99, 235, 0.08);
    --mtg-bg-hover: rgba(37, 99, 235, 0.15);
    --mtg-border: rgba(37, 99, 235, 0.5);
    --mtg-header: rgba(37, 99, 235, 0.12);

    /* SEM - 세미나 (Orange - darker) */
    --sem-color: #ea580c;
    --sem-bg: rgba(234, 88, 12, 0.08);
    --sem-bg-hover: rgba(234, 88, 12, 0.15);
    --sem-border: rgba(234, 88, 12, 0.5);
    --sem-header: rgba(234, 88, 12, 0.12);

    /* EVENT - 행사 (Red - darker) */
    --event-color: #dc2626;
    --event-bg: rgba(220, 38, 38, 0.08);
    --event-bg-hover: rgba(220, 38, 38, 0.15);
    --event-border: rgba(220, 38, 38, 0.5);
    --event-header: rgba(220, 38, 38, 0.12);

    /* OFA - 공무행정 (Green - darker) */
    --ofa-color: #059669;
    --ofa-bg: rgba(5, 150, 105, 0.08);
    --ofa-bg-hover: rgba(5, 150, 105, 0.15);
    --ofa-border: rgba(5, 150, 105, 0.5);
    --ofa-header: rgba(5, 150, 105, 0.12);

    /* CONTACT - 연락처 (Cyan - darker) */
    --contact-color: #0891b2;
    --contact-bg: rgba(8, 145, 178, 0.08);
    --contact-bg-hover: rgba(8, 145, 178, 0.15);
    --contact-border: rgba(8, 145, 178, 0.5);
    --contact-header: rgba(8, 145, 178, 0.12);

    /* SETUP - 설정 (Gray - darker) */
    --setup-color: #6b7280;
    --setup-bg: rgba(107, 114, 128, 0.08);
    --setup-bg-hover: rgba(107, 114, 128, 0.15);
    --setup-border: rgba(107, 114, 128, 0.5);
    --setup-header: rgba(107, 114, 128, 0.12);

    /* DATA - 자료 (Amber - darker) */
    --data-color: #d97706;
    --data-bg: rgba(217, 119, 6, 0.08);
    --data-bg-hover: rgba(217, 119, 6, 0.15);
    --data-border: rgba(217, 119, 6, 0.5);
    --data-header: rgba(217, 119, 6, 0.12);

    /* THEO - 이론 (Indigo - darker) */
    --theo-color: #4f46e5;
    --theo-bg: rgba(79, 70, 229, 0.08);
    --theo-bg-hover: rgba(79, 70, 229, 0.15);
    --theo-border: rgba(79, 70, 229, 0.5);
    --theo-header: rgba(79, 70, 229, 0.12);

    /* PAPER - 논문 (Teal - darker) */
    --paper-color: #0d9488;
    --paper-bg: rgba(13, 148, 136, 0.08);
    --paper-bg-hover: rgba(13, 148, 136, 0.15);
    --paper-border: rgba(13, 148, 136, 0.5);
    --paper-header: rgba(13, 148, 136, 0.12);

    /* LIT - 문헌 (Lime - darker) */
    --lit-color: #65a30d;
    --lit-bg: rgba(101, 163, 13, 0.08);
    --lit-bg-hover: rgba(101, 163, 13, 0.15);
    --lit-border: rgba(101, 163, 13, 0.5);
    --lit-header: rgba(101, 163, 13, 0.12);

    /* SKETCH - 스케치/캔버스 (Pink - darker) */
    --sketch-color: #db2777;
    --sketch-bg: rgba(219, 39, 119, 0.08);
    --sketch-bg-hover: rgba(219, 39, 119, 0.15);
    --sketch-border: rgba(219, 39, 119, 0.5);
    --sketch-header: rgba(219, 39, 119, 0.12);
  }
}

/* Container */
.app-container {
  display: flex;
  flex-direction: column;
  height: 100vh;
  width: 100vw;
  overflow: hidden;
}

/* Title Bar */
.titlebar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  height: 32px;
  background-color: var(--bg-primary, #1e1e1e);
  border-bottom: 1px solid var(--border-color, #3c3c3c);
  flex-shrink: 0;
  cursor: default;
  user-select: none;
}

.titlebar-left {
  display: flex;
  align-items: center;
  padding-left: 12px;
  gap: 6px;
}

.titlebar-icon {
  width: 16px;
  height: 16px;
  -webkit-user-drag: none;
}

.titlebar-title {
  font-size: 12px;
  color: var(--text-secondary);
  font-weight: 500;
}

.titlebar-vault-btn {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-left: 12px;
  padding: 4px 10px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border-color);
  border-radius: 4px;
  color: var(--text-muted);
  font-size: 11px;
  cursor: pointer;
  transition: all 0.15s ease;
}

.titlebar-vault-btn:hover {
  background: var(--bg-hover);
  border-color: var(--accent-color);
  color: var(--text-primary);
}

.titlebar-vault-name {
  max-width: 150px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.titlebar-actions {
  display: flex;
  align-items: center;
  gap: 4px;
  margin-right: 12px;
}

.titlebar-action-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 4px;
  height: 28px;
  padding: 0 10px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border-color);
  border-radius: 6px;
  color: var(--text-secondary);
  cursor: pointer;
  transition: all 0.15s ease;
}

.titlebar-action-btn:hover {
  background: var(--bg-hover);
  color: var(--text-primary);
  border-color: var(--border-light);
}

.titlebar-action-btn.active {
  background: rgba(100, 150, 255, 0.2);
  color: #6496ff;
  border-color: rgba(100, 150, 255, 0.4);
}

.hover-panel-badge {
  font-size: 11px;
  font-weight: 600;
  background: rgba(100, 150, 255, 0.3);
  color: #a0c4ff;
  padding: 1px 6px;
  border-radius: 10px;
  min-width: 18px;
  text-align: center;
}

.titlebar-action-btn.active .hover-panel-badge {
  background: rgba(100, 150, 255, 0.4);
  color: #fff;
}

.titlebar-controls {
  display: flex;
  height: 100%;
}

.titlebar-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 46px;
  height: 100%;
  border: none;
  background: transparent;
  color: var(--text-secondary);
  cursor: pointer;
  border-radius: 0;
  padding: 0;
}

.titlebar-btn:hover {
  background-color: var(--bg-hover);
}

.titlebar-btn-close:hover {
  background-color: #e81123;
  color: #ffffff;
}

.titlebar-btn-panel {
  position: relative;
  gap: 4px;
  border-left: 1px solid var(--border-color);
  margin-left: 4px;
}

.titlebar-btn-panel.active {
  background-color: rgba(100, 150, 255, 0.15);
  color: #6496ff;
}

.titlebar-btn-panel .hover-panel-badge {
  font-size: 9px;
  font-weight: 600;
  background: rgba(100, 150, 255, 0.4);
  color: #fff;
  padding: 0px 4px;
  border-radius: 8px;
  min-width: 14px;
  text-align: center;
  line-height: 14px;
}

/* Layout */
.app-layout {
  display: flex;
  flex: 1;
  overflow: hidden;
}

/* ============================================================ */
/* Panel Slide Animations - GPU Accelerated */
/* ============================================================ */
/*
 * PERFORMANCE OPTIMIZATION:
 * 1. All animations use GPU-only properties: transform, opacity, scale
 * 2. translate3d() forces GPU compositing layer
 * 3. will-change hints browser to prepare for animation
 * 4. contain: layout style - isolates repaint/reflow
 * 5. backface-visibility: hidden - enables 3D acceleration
 * 6. Using cubic-bezier(0.22, 1, 0.36, 1) - smooth deceleration curve
 */

/* Sidebar Wrapper - Left Panel (GPU-optimized, instant width change)
 * OPTIMIZATION: No width transition - causes reflow. Only content animates.
 */
.sidebar-wrapper {
  display: flex;
  flex-shrink: 0;
  overflow: hidden;
  contain: layout style;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  transform: translateZ(0);
}

.sidebar-wrapper.open {
  /* Width is set inline - instant change */
}

.sidebar-wrapper.closed {
  width: 44px !important; /* Collapsed bar width - instant */
}

/* Closing state - instant width, content fades */
.sidebar-wrapper.closing {
  width: 44px !important;
}

/* Sidebar content - GPU layer ready */
.sidebar-wrapper > .sidebar {
  flex: 1;
  min-width: 0;
  will-change: transform, opacity;
  backface-visibility: hidden;
  transform: translateZ(0);
}

/* Opening animation - fast fade in */
.sidebar-wrapper.opening > .sidebar {
  animation: sidebarOpen 0.1s cubic-bezier(0.22, 1, 0.36, 1) forwards;
}

/* Closing animation - very fast fade out */
.sidebar-wrapper.closing > .sidebar {
  animation: sidebarClose 0.06s ease-out forwards;
  pointer-events: none;
}

/* Divider fade animation */
.sidebar-wrapper.opening > .divider {
  animation: fadeIn 0.1s ease-out forwards;
}

.sidebar-wrapper.closing > .divider {
  animation: fadeOut 0.05s ease-out forwards;
}

.sidebar-wrapper.closed > .sidebar-collapsed-bar {
  animation: fadeIn 0.05s ease-out forwards;
}

/* Hover Panel Wrapper - Right Panel (GPU-optimized, instant width change)
 * OPTIMIZATION: No width transition - causes reflow. Only content animates.
 */
.hover-panel-wrapper {
  display: flex;
  flex-shrink: 0;
  overflow: hidden;
  contain: layout style;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  transform: translateZ(0);
}

.hover-panel-wrapper.open {
  /* Width is set inline - instant change */
}

.hover-panel-wrapper.closed {
  width: 44px !important; /* Collapsed bar width - instant */
}

/* Closing state - instant width, content fades */
.hover-panel-wrapper.closing {
  width: 44px !important;
}

/* Panel content - GPU layer ready */
.hover-panel-wrapper > .hover-windows-panel {
  flex-shrink: 0;
  will-change: transform, opacity;
  backface-visibility: hidden;
  transform: translateZ(0);
}

/* Opening animation - fast fade in */
.hover-panel-wrapper.opening > .hover-windows-panel {
  animation: panelOpen 0.1s cubic-bezier(0.22, 1, 0.36, 1) forwards;
}

/* Closing animation - very fast fade out */
.hover-panel-wrapper.closing > .hover-windows-panel {
  animation: panelClose 0.06s ease-out forwards;
  pointer-events: none;
}

.hover-panel-wrapper.closed > .hover-panel-collapsed-bar {
  animation: fadeIn 0.05s ease-out forwards;
}

/* Sidebar-specific animations */
@keyframes sidebarOpen {
  0% {
    opacity: 0;
    transform: translate3d(-30px, 0, 0);
  }
  100% {
    opacity: 1;
    transform: translate3d(0, 0, 0);
  }
}

@keyframes sidebarClose {
  0% {
    opacity: 1;
    transform: translate3d(0, 0, 0);
  }
  100% {
    opacity: 0;
    transform: translate3d(-30px, 0, 0);
  }
}

/* Panel-specific animations */
@keyframes panelOpen {
  0% {
    opacity: 0;
    transform: translate3d(30px, 0, 0);
  }
  100% {
    opacity: 1;
    transform: translate3d(0, 0, 0);
  }
}

@keyframes panelClose {
  0% {
    opacity: 1;
    transform: translate3d(0, 0, 0);
  }
  100% {
    opacity: 0;
    transform: translate3d(30px, 0, 0);
  }
}

/* Slide animations - GPU accelerated with will-change for performance */
@keyframes slideInLeft {
  0% {
    opacity: 0;
    transform: translate3d(-100%, 0, 0);
  }
  100% {
    opacity: 1;
    transform: translate3d(0, 0, 0);
  }
}

@keyframes slideOutLeft {
  0% {
    opacity: 1;
    transform: translate3d(0, 0, 0);
  }
  100% {
    opacity: 0;
    transform: translate3d(-100%, 0, 0);
  }
}

@keyframes slideInRight {
  0% {
    opacity: 0;
    transform: translate3d(100%, 0, 0);
  }
  100% {
    opacity: 1;
    transform: translate3d(0, 0, 0);
  }
}

@keyframes slideOutRight {
  0% {
    opacity: 1;
    transform: translate3d(0, 0, 0);
  }
  100% {
    opacity: 0;
    transform: translate3d(100%, 0, 0);
  }
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}

/* ============================================================ */

/* Sidebar Collapsed Bar */
.sidebar-collapsed-bar {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  padding: 8px 12px;
  background-color: var(--bg-secondary, #252526);
  border-right: 1px solid var(--border-color, #3c3c3c);
  flex-shrink: 0;
}

.sidebar-collapsed-toggle {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  background: none;
  border: none;
  border-radius: 4px;
  color: var(--text-muted, #888);
  cursor: pointer;
  transition: all 0.15s ease;
}

.sidebar-collapsed-toggle:hover {
  background: var(--bg-hover, rgba(255, 255, 255, 0.1));
  color: var(--text-primary, #fff);
}

/* Minimized windows in collapsed sidebar */
.sidebar-collapsed-minimized {
  display: flex;
  flex-direction: column;
  gap: 4px;
  margin-top: 8px;
  padding-top: 8px;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.sidebar-collapsed-minimized-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  background: transparent;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.15s ease;
  opacity: 0.7;
}

.sidebar-collapsed-minimized-btn:hover {
  background: rgba(255, 255, 255, 0.1);
  opacity: 1;
}

.sidebar-collapsed-minimized-icon {
  font-size: 16px;
  line-height: 1;
}

/* Hover Panel Collapsed Bar */
.hover-panel-collapsed-bar {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 8px 12px;
  width: 48px;
  background-color: var(--bg-primary);
  border-left: 1px solid var(--border-color);
  flex-shrink: 0;
}

.hover-panel-collapsed-toggle {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  padding: 0;
  background: none;
  border: none;
  border-radius: 4px;
  color: var(--text-muted);
  cursor: pointer;
  transition: all 0.15s ease;
}

.hover-panel-collapsed-toggle:hover {
  background-color: var(--bg-hover);
  color: var(--text-primary);
}

.hover-panel-collapsed-badge {
  position: absolute;
  top: -4px;
  right: -6px;
  font-size: 9px;
  font-weight: 600;
  background: rgba(100, 150, 255, 0.6);
  color: #fff;
  padding: 0px 4px;
  border-radius: 8px;
  min-width: 14px;
  text-align: center;
}

/* All windows in collapsed right panel */
.hover-panel-collapsed-windows {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  margin-top: 8px;
  padding-top: 8px;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  width: 100%;
}

.hover-panel-collapsed-window-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 26px;
  height: 26px;
  background: transparent;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  position: relative;
  /* Smooth transitions - GPU accelerated */
  transition:
    opacity 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94),
    transform 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94),
    background-color 0.15s ease,
    border-color 0.15s ease,
    box-shadow 0.15s ease;
  will-change: opacity, filter;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  transform: translateZ(0);
  -webkit-tap-highlight-color: transparent;
  /* Blur fade entrance animation */
  animation: collapsedBtnEnter 0.18s cubic-bezier(0.22, 1, 0.36, 1) forwards;
}

/* Blur fade entrance animation */
@keyframes collapsedBtnEnter {
  0% {
    opacity: 0;
    filter: blur(6px);
  }
  100% {
    opacity: 1;
    filter: blur(0);
  }
}

/* GPU acceleration for all buttons - forces compositor layer */
.hover-panel-collapsed-window-btn {
  will-change: opacity, filter;
  transform: translateZ(0);
  backface-visibility: hidden;
}

/* Active press feedback - instant haptic feel (no transition delay) */
.hover-panel-collapsed-window-btn:active:not(.is-exiting) {
  transform: scale(0.95) translateZ(0);
  /* No transition - instant response */
}

/* Blur fade exit animation */
.hover-panel-collapsed-window-btn.is-exiting {
  animation: collapsedBtnExit 0.15s ease-out forwards;
  pointer-events: none;
}

@keyframes collapsedBtnExit {
  0% {
    opacity: 1;
    filter: blur(0);
  }
  100% {
    opacity: 0;
    filter: blur(6px);
  }
}

/* Minimized state - low opacity, no border */
.hover-panel-collapsed-window-btn.minimized {
  opacity: 0.5;
}

.hover-panel-collapsed-window-btn.minimized:hover {
  background: rgba(255, 255, 255, 0.08);
  opacity: 0.7;
}

/* Active state - medium opacity, subtle border */
.hover-panel-collapsed-window-btn.active {
  opacity: 0.75;
  border: 1px solid rgba(255, 255, 255, 0.15);
}

.hover-panel-collapsed-window-btn.active:hover {
  background: rgba(255, 255, 255, 0.1);
  opacity: 0.9;
}

/* Focused state - full opacity, bright border, highlight effect */
.hover-panel-collapsed-window-btn.focused {
  opacity: 1;
  border: 1px solid rgba(100, 150, 255, 0.6);
  background: rgba(100, 150, 255, 0.15);
  box-shadow: 0 0 6px rgba(100, 150, 255, 0.3);
}

.hover-panel-collapsed-window-btn.focused::before {
  content: '';
  position: absolute;
  left: -8px;
  top: 50%;
  transform: translateY(-50%);
  width: 3px;
  height: 16px;
  background: rgba(100, 150, 255, 0.8);
  border-radius: 2px;
}

.hover-panel-collapsed-window-btn.focused:hover {
  background: rgba(100, 150, 255, 0.2);
  border-color: rgba(100, 150, 255, 0.8);
}

/* Custom color override for window buttons */
.hover-panel-collapsed-window-btn.has-custom-color.active,
.hover-panel-collapsed-window-btn.has-custom-color.focused {
  background: color-mix(in srgb, var(--template-color) 20%, transparent);
  border: 1px solid color-mix(in srgb, var(--template-color) 40%, transparent);
}

.hover-panel-collapsed-window-btn.has-custom-color.focused {
  box-shadow: 0 0 6px color-mix(in srgb, var(--template-color) 50%, transparent);
}

.hover-panel-collapsed-window-btn.has-custom-color.focused::before {
  background: var(--template-color);
}

.hover-panel-collapsed-window-btn.has-custom-color:hover {
  background: color-mix(in srgb, var(--template-color) 30%, transparent);
  border-color: var(--template-color);
}

.hover-panel-collapsed-window-icon {
  font-size: 16px;
  line-height: 1;
}

.hover-panel-collapsed-window-icon.lucide-icon {
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-secondary);
}

/* Sidebar */
.sidebar {
  display: flex;
  flex-direction: column;
  height: 100%;
  background-color: var(--bg-secondary, #252526);
  flex-shrink: 0;
  overflow: hidden;
}

.sidebar-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 8px 12px;
  border-bottom: 1px solid var(--border-color, #3c3c3c);
  flex-shrink: 0;
}

.sidebar-header-left {
  display: flex;
  align-items: center;
}

.sidebar-toggle-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  background: none;
  border: none;
  border-radius: 4px;
  color: var(--text-muted, #888);
  cursor: pointer;
  transition: all 0.15s ease;
}

.sidebar-toggle-btn:hover {
  background: var(--bg-hover, rgba(255, 255, 255, 0.1));
  color: var(--text-primary, #fff);
}

.sidebar-section-label {
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  color: var(--text-secondary, #bbbbbb);
  letter-spacing: 0.5px;
}

.sidebar-actions {
  display: flex;
  gap: 2px;
}

.sidebar-action-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  border: none;
  background: transparent;
  color: var(--text-secondary, #cccccc);
  cursor: pointer;
  border-radius: 4px;
  font-size: 14px;
  padding: 0;
}

.sidebar-action-btn:hover:not(:disabled) {
  background-color: var(--bg-hover, #3c3c3c);
}

.sidebar-action-btn:disabled {
  opacity: 0.3;
  cursor: not-allowed;
}

.sidebar-action-btn.active {
  color: var(--accent-color, #007acc);
}

/* Sidebar Input */
.sidebar-input-row {
  padding: 4px 8px;
  border-bottom: 1px solid var(--border-color, #3c3c3c);
  flex-shrink: 0;
}

.sidebar-input {
  width: 100%;
  padding: 4px 8px;
  font-size: 12px;
  background-color: var(--bg-tertiary, #3c3c3c);
  border: 1px solid var(--border-light, #5a5a5a);
  border-radius: 3px;
  color: var(--text-primary, #e0e0e0);
  outline: none;
}

.sidebar-input:focus {
  border-color: var(--accent-color, #007acc);
}

/* Sidebar Content */
.sidebar-content {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
}

.sidebar-empty {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 32px 16px;
  gap: 12px;
}

.open-vault-btn {
  padding: 8px 16px;
  font-size: 13px;
  background-color: #007acc;
  border: none;
  border-radius: 4px;
  color: #ffffff;
  cursor: pointer;
  font-weight: 500;
}

.open-vault-btn:hover {
  background-color: #0098ff;
}

.sidebar-empty-text {
  font-size: 12px;
  color: var(--text-muted);
}

/* Sidebar Footer (Vault & Settings) */
.sidebar-footer {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 8px 8px;
  border-top: 1px solid var(--border-color);
  flex-shrink: 0;
  background-color: var(--bg-secondary);
}

.sidebar-footer-btn {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 6px 10px;
  border: none;
  background: transparent;
  color: var(--text-secondary);
  cursor: pointer;
  border-radius: 4px;
  font-size: 12px;
}

.sidebar-footer-btn:hover {
  background-color: var(--bg-hover);
}

.sidebar-footer-btn.vault-btn {
  flex: 1;
  min-width: 0;
}

.sidebar-footer-btn-text {
  flex: 1;
  text-align: left;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.sidebar-footer-btn.settings-btn {
  padding: 6px 8px;
}

/* ============================================================ */
/* Folder Tree (Unified Container + Folder View) */
/* ============================================================ */

.folder-tree-container {
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
}

.folder-tree-unified-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 8px 12px;
  font-size: 11px;
  color: var(--text-muted);
  text-transform: uppercase;
  border-bottom: 1px solid var(--border-color);
  flex-shrink: 0;
}

.folder-tree-header-left {
  display: flex;
  align-items: center;
  gap: 6px;
}

.folder-tree-section-label {
  font-weight: 500;
  letter-spacing: 0.5px;
}

.folder-tree-expand-btn,
.folder-tree-new-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  background: none;
  border: none;
  color: var(--text-muted);
  cursor: pointer;
  padding: 2px;
  border-radius: 3px;
  transition: background-color 0.15s, color 0.15s;
}

.folder-tree-expand-btn:hover,
.folder-tree-new-btn:hover {
  background-color: var(--bg-hover);
  color: var(--text-secondary);
}

.folder-tree-content {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 4px 0;
}

/* Container Tree Section */
.container-tree-section {
  user-select: none;
  transition: opacity 0.15s ease, transform 0.15s ease;
}

.container-tree-section.dragging {
  opacity: 0.5;
}

.container-tree-section.drag-over {
  background-color: rgba(100, 150, 255, 0.1);
  border-top: 2px solid rgba(100, 150, 255, 0.5);
}

/* Drag handle for container reordering */
.container-drag-handle {
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  color: var(--text-muted);
  cursor: grab;
  padding: 2px;
  margin-left: -4px;
  margin-right: 2px;
  border-radius: 3px;
  transition: opacity 0.15s ease, background-color 0.1s ease;
}

.container-tree-item:hover .container-drag-handle {
  opacity: 0.6;
}

.container-drag-handle:hover {
  opacity: 1 !important;
  background-color: var(--bg-tertiary);
}

.container-drag-handle:active,
.container-tree-section.dragging .container-drag-handle {
  cursor: grabbing;
}

/* Show handle when dragging is active (any container being dragged) */
.container-tree-section.dragging .container-drag-handle,
.container-tree-content:has(.dragging) .container-drag-handle {
  opacity: 0.6;
}

/* Force grabbing cursor on entire document during drag */
body:has(.container-tree-section.dragging) {
  cursor: grabbing !important;
}

body:has(.container-tree-section.dragging) * {
  cursor: grabbing !important;
}

.container-tree-item {
  display: flex;
  align-items: center;
  padding: 6px 12px;
  cursor: pointer;
  font-size: 13px;
  color: var(--text-secondary);
  gap: 8px;
  transition: background-color 0.1s, transform 0.08s ease;
  white-space: nowrap;
  overflow: hidden;
  /* Click optimization */
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
  will-change: background-color;
}

.container-tree-item:hover {
  background-color: var(--bg-tertiary);
}

.container-tree-item:active {
  transform: scale(0.99);
}

.container-tree-item.selected {
  background-color: var(--calendar-selected-bg);
  color: var(--text-primary);
}

.container-tree-item.selected:hover {
  background-color: var(--calendar-today-bg);
}

.container-tree-item.focused {
  background-color: rgba(122, 162, 247, 0.1);
  border-left: 2px solid rgba(122, 162, 247, 0.5);
}

.container-tree-item.root-active {
  background-color: var(--calendar-selected-bg);
  border-left: 2px solid #007acc;
}

.container-tree-item.storage {
  color: #8b9a6b;
}

.container-tree-icon {
  display: flex;
  align-items: center;
  flex-shrink: 0;
}

.container-tree-name {
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Folder Tree Items */
.folder-tree-item-wrapper {
  user-select: none;
}

.folder-tree-item {
  display: flex;
  align-items: center;
  padding: 4px 8px;
  cursor: pointer;
  font-size: 12px;
  color: var(--text-secondary);
  gap: 6px;
  transition: background-color 0.1s, transform 0.08s ease;
  white-space: nowrap;
  overflow: hidden;
  /* Click optimization */
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
  will-change: background-color;
}

.folder-tree-item:hover {
  background-color: var(--bg-tertiary);
}

.folder-tree-item:active {
  transform: scale(0.99);
}

.folder-tree-item.folder {
  color: #cca700;
}

.folder-tree-item.folder-note {
  color: #007acc;
}

.folder-tree-item.focused {
  background-color: rgba(122, 162, 247, 0.1);
  border-left: 2px solid rgba(122, 162, 247, 0.5);
}

.folder-tree-item.selected {
  background-color: #094771;
  color: #ffffff;
}

.folder-tree-item.selected:hover {
  background-color: #0a5788;
}

.folder-tree-icon {
  display: flex;
  align-items: center;
  flex-shrink: 0;
  cursor: pointer;
}

.folder-tree-name {
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
}

.folder-tree-children {
  /* Children are indented via paddingLeft in JS */
}

.folder-tree-empty {
  padding: 12px;
  font-size: 12px;
  color: var(--text-muted);
  text-align: center;
}

/* Folder Icons (Lucide) */
.folder-icon {
  color: #cca700;
  flex-shrink: 0;
}

.folder-icon.container {
  color: #007acc;
}

.folder-icon.container.root {
  color: #007acc;
}

.folder-icon.container.root.expanded {
  color: #4da6ff;
}

.folder-icon.container.storage {
  color: #8b9a6b;
}

.folder-icon.container.storage.expanded {
  color: #a0b080;
}

.folder-icon.expanded {
  color: #e0a800;
}

/* Folders with children have brighter/distinct color */
.folder-icon.has-children {
  color: #f0c000;
}

.folder-icon.container.has-children {
  color: #4da6ff;
}

.folder-icon.container.storage.has-children {
  color: #a0b080;
}

/* Note Count Badge */
.folder-note-count {
  margin-left: auto;
  font-size: 10px;
  color: var(--text-muted);
  background-color: var(--bg-tertiary);
  padding: 1px 5px;
  border-radius: 8px;
  flex-shrink: 0;
}

.folder-tree-item.selected .folder-note-count,
.container-tree-item.selected .folder-note-count {
  background-color: rgba(255, 255, 255, 0.15);
  color: #ccc;
}

/* Container Type Badge */
.container-type-badge {
  font-size: 9px;
  color: #8b9a6b;
  background-color: rgba(139, 154, 107, 0.15);
  padding: 1px 4px;
  border-radius: 3px;
  font-weight: 600;
  flex-shrink: 0;
}

/* Folder Status Indicator */
.folder-status-indicator {
  font-size: 11px;
  flex-shrink: 0;
  margin-left: 4px;
  line-height: 1;
}

.folder-status-indicator.status-in_progress {
  color: #60a5fa;
}

.folder-status-indicator.status-completed {
  color: #4ade80;
}

.folder-status-indicator.status-on_hold {
  color: #fbbf24;
}

/* Context Menu Status Icon */
.context-menu-status-icon {
  margin-right: 6px;
  font-size: 12px;
}

/* Divider */
.divider {
  width: 6px;
  cursor: col-resize;
  background-color: transparent;
  flex-shrink: 0;
  position: relative;
  z-index: 10;
  transition: background-color 0.1s ease;
}

/* Larger click area */
.divider::before {
  content: '';
  position: absolute;
  top: 0;
  left: -4px;
  right: -4px;
  bottom: 0;
  cursor: col-resize;
}

.divider:hover,
.divider:active {
  background-color: var(--accent-color, #007acc);
}

/* Editor Area */
.editor-area {
  flex: 1;
  display: flex;
  flex-direction: column;
  min-width: 0;
  overflow: hidden;
}

.editor-empty-area {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  background-color: var(--bg-primary);
}

.editor-empty-text {
  font-size: 14px;
  color: var(--text-muted);
}

/* ============================================================ */
/* ContainerView */
/* ============================================================ */

.container-view {
  display: flex;
  flex-direction: column;
  height: 100%;
  background-color: var(--bg-primary);
}

.container-description-section {
  flex-shrink: 0;
  max-height: 40%;
  display: flex;
  flex-direction: column;
  border-bottom: 1px solid var(--border-color);
}

.container-description-header {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 16px;
  background-color: var(--bg-secondary);
  border-bottom: 1px solid var(--border-color);
  flex-shrink: 0;
}

.container-parent-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  background-color: transparent;
  border: 1px solid var(--border-light);
  border-radius: 4px;
  color: var(--text-secondary);
  cursor: pointer;
  font-size: 14px;
  flex-shrink: 0;
  transition: background-color 0.15s, border-color 0.15s;
}

.container-parent-btn:hover {
  background-color: var(--bg-hover);
  border-color: var(--accent-color);
  color: var(--text-primary);
}

.container-description-title {
  font-size: 15px;
  font-weight: 600;
  color: var(--text-primary);
}

.container-dirty-indicator {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background-color: #d7ba7d;
}

.container-description-body {
  flex: 1;
  overflow-y: auto;
}

/* Note Type Background Colors for Container */
.container-description-body.note-type { background-color: var(--note-bg); }
.container-description-body.sketch-type { background-color: var(--sketch-bg); }
.container-description-body.mtg-type { background-color: var(--mtg-bg); }
.container-description-body.sem-type { background-color: var(--sem-bg); }
.container-description-body.event-type { background-color: var(--event-bg); }
.container-description-body.ofa-type { background-color: var(--ofa-bg); }
.container-description-body.paper-type { background-color: var(--paper-bg); }
.container-description-body.lit-type { background-color: var(--lit-bg); }
.container-description-body.data-type { background-color: var(--data-bg); }
.container-description-body.theo-type { background-color: var(--theo-bg); }
.container-description-body.contact-type { background-color: var(--contact-bg); }
.container-description-body.setup-type { background-color: var(--setup-bg); }

.tiptap-editor.container-description-editor {
  padding: 12px 16px;
  max-width: none;
  margin: 0;
  font-size: 14px;
  min-height: 80px;
}

.container-actions {
  display: flex;
  gap: 8px;
  padding: 6px 16px;
  background-color: var(--bg-secondary);
  border-bottom: 1px solid var(--border-color);
  flex-shrink: 0;
}

.container-action-btn {
  padding: 4px 12px;
  font-size: 12px;
  background-color: var(--bg-hover);
  border: 1px solid var(--border-light);
  border-radius: 4px;
  color: var(--text-secondary);
  cursor: pointer;
}

.container-action-btn:hover {
  background-color: var(--bg-elevated);
}

.container-new-input {
  padding: 4px 16px;
  border-bottom: 1px solid var(--border-color);
  flex-shrink: 0;
}

.container-search-section {
  flex: 1;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

/* ============================================================ */
/* Search View */
/* ============================================================ */

.search-view {
  display: flex;
  flex-direction: column;
  height: 100%;
  background-color: var(--bg-primary);
}

.search-tabs {
  display: flex;
  align-items: center;
  border-bottom: 1px solid var(--border-color);
  flex-shrink: 0;
  background-color: var(--bg-secondary);
}

.search-tab {
  padding: 6px 14px;
  font-size: 11px;
  background: none;
  border: none;
  border-bottom: 2px solid transparent;
  color: var(--text-muted);
  cursor: pointer;
  white-space: nowrap;
  transition: color 0.15s, border-color 0.15s;
}

.search-tab.active {
  color: var(--text-primary);
  border-bottom-color: var(--accent-color);
}

.search-tab:hover:not(.active) {
  color: var(--text-secondary);
}

.search-create-note-btn {
  display: flex;
  align-items: center;
  gap: 6px;
  margin: 4px 10px 4px auto;
  padding: 5px 12px;
  background-color: transparent;
  border: 1px solid var(--border-light);
  border-radius: 6px;
  color: var(--text-secondary);
  font-size: 12px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.15s ease;
}

.search-create-note-btn:hover {
  background-color: var(--accent-color);
  border-color: var(--accent-color);
  color: #ffffff;
}

.search-create-note-btn:active {
  transform: scale(0.97);
}

.search-create-note-btn span {
  white-space: nowrap;
}

.search-toolbar {
  display: flex;
  align-items: center;
  padding: 6px 10px;
  flex-shrink: 0;
}

.search-bar {
  flex: 1;
  display: flex;
  align-items: center;
  gap: 8px;
}

.search-input {
  flex: 1;
  padding: 5px 10px;
  font-size: 12px;
  background-color: var(--bg-tertiary);
  border: 1px solid var(--border-color);
  border-radius: 4px;
  color: var(--text-primary);
  outline: none;
}

.search-input:focus {
  border-color: var(--accent-color);
}

.search-input::placeholder {
  color: var(--text-muted);
}

/* Search filter button */
.search-filter-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 28px;
  height: 28px;
  margin-left: 6px;
  padding: 0;
  background: var(--bg-tertiary);
  border: 1px solid var(--border-color);
  border-radius: 4px;
  color: var(--text-muted);
  cursor: pointer;
  transition: all 0.15s ease;
}

.search-filter-btn:hover {
  background: var(--bg-hover);
  color: var(--text-primary);
}

.search-filter-btn.active {
  background: var(--accent-color);
  border-color: var(--accent-color);
  color: #fff;
}

/* Date filters panel */
.search-date-filters {
  display: flex;
  flex-direction: column;
  gap: 6px;
  padding: 8px 10px;
  background: var(--bg-secondary);
  border-bottom: 1px solid var(--border-color);
}

.search-date-filter-row {
  display: flex;
  align-items: center;
  gap: 6px;
}

.search-date-filter-label {
  min-width: 70px;
  width: auto;
  font-size: 11px;
  color: var(--text-muted);
  flex-shrink: 0;
  white-space: nowrap;
}

.search-date-input {
  padding: 4px 6px;
  font-size: 11px;
  background-color: var(--bg-tertiary);
  border: 1px solid var(--border-color);
  border-radius: 4px;
  color: var(--text-primary);
  outline: none;
}

.search-date-input:focus {
  border-color: var(--accent-color);
}

.search-date-separator {
  font-size: 11px;
  color: var(--text-muted);
}

.search-date-clear-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 18px;
  height: 18px;
  padding: 0;
  background: transparent;
  border: none;
  border-radius: 3px;
  color: var(--text-muted);
  cursor: pointer;
  transition: all 0.15s ease;
}

.search-date-clear-btn:hover {
  background: rgba(255, 255, 255, 0.1);
  color: #e04040;
}

.search-filter-toggle-btn {
  padding: 4px 12px;
  font-size: 12px;
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 4px;
  color: #888;
  cursor: pointer;
  transition: all 0.15s ease;
}

.search-filter-toggle-btn:hover {
  background: rgba(255, 255, 255, 0.1);
}

.search-filter-toggle-btn.active {
  background: rgba(100, 150, 255, 0.2);
  border-color: rgba(100, 150, 255, 0.4);
  color: #6496ff;
}

/* Batch action buttons */
.search-batch-actions {
  display: flex;
  gap: 8px;
  padding: 8px 16px;
  background: var(--bg-tertiary);
  border-bottom: 1px solid var(--border-color);
}

.search-batch-btn {
  padding: 6px 12px;
  font-size: 12px;
  background: rgba(220, 38, 38, 0.15);
  border: 1px solid rgba(220, 38, 38, 0.3);
  border-radius: 4px;
  color: #f87171;
  cursor: pointer;
  transition: all 0.15s ease;
}

.search-batch-btn:hover {
  background: rgba(220, 38, 38, 0.25);
  border-color: rgba(220, 38, 38, 0.5);
}

/* Batch delete button in filter panel */
.search-batch-delete-filter-btn {
  width: 100%;
  padding: 8px 12px;
  font-size: 12px;
  background: rgba(220, 38, 38, 0.15);
  border: 1px solid rgba(220, 38, 38, 0.3);
  border-radius: 4px;
  color: #f87171;
  cursor: pointer;
  transition: all 0.15s ease;
  font-weight: 500;
}

.search-batch-delete-filter-btn:hover {
  background: rgba(220, 38, 38, 0.25);
  border-color: rgba(220, 38, 38, 0.5);
}

.search-status-bar {
  display: flex;
  align-items: center;
  padding: 4px 16px;
  border-top: 1px solid var(--border-color);
  flex-shrink: 0;
}

.search-count {
  font-size: 11px;
  color: var(--text-muted);
}

/* Search Table (Frontmatter mode) */
.search-table-wrapper {
  flex: 1;
  overflow: auto;
}

.search-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 12px;
}

.search-th {
  text-align: left;
  padding: 8px 12px;
  color: var(--text-muted);
  font-weight: 500;
  border-bottom: 1px solid var(--border-color);
  position: sticky;
  top: 0;
  background-color: var(--bg-secondary);
  white-space: nowrap;
}

.search-th.clickable {
  cursor: pointer;
}

.search-th.clickable:hover {
  color: var(--text-secondary);
}

.search-row {
  cursor: pointer;
  transition: background-color 0.1s;
}

.search-row:hover {
  background-color: var(--bg-tertiary);
}

.search-row.selected {
  background-color: #1e3a5f !important;
}

.search-row.selected:hover {
  background-color: #2a4a7c !important;
}

/* Multi-selected note rows in Search */
.search-row.multi-selected,
.search-details-item.multi-selected {
  background-color: rgba(122, 162, 247, 0.15) !important;
  border-left: 3px solid #7aa2f7;
}

.search-row.multi-selected:hover,
.search-details-item.multi-selected:hover {
  background-color: rgba(122, 162, 247, 0.25) !important;
}

/* Attachment extension category row colors in Search */
.search-row.att-row-image { border-left: 3px solid rgba(52, 211, 153, 0.5); }
.search-row.att-row-document { border-left: 3px solid rgba(251, 146, 60, 0.5); }
.search-row.att-row-data { border-left: 3px solid rgba(251, 191, 36, 0.5); }
.search-row.att-row-code { border-left: 3px solid rgba(34, 211, 238, 0.5); }
.search-row.att-row-contact { border-left: 3px solid rgba(56, 189, 248, 0.5); }
.search-row.att-row-media { border-left: 3px solid rgba(192, 132, 252, 0.5); }
.search-row.att-row-archive { border-left: 3px solid rgba(156, 163, 175, 0.5); }
.search-row.att-row-markdown { border-left: 3px solid rgba(45, 212, 191, 0.5); }
.search-row.att-row-other { border-left: 3px solid rgba(0, 212, 170, 0.5); }

/* Synology conflict file styling */
.search-row.conflict-file {
  border-left: 3px solid #e8a838;
  background: linear-gradient(to right, rgba(232, 168, 56, 0.1) 0%, transparent 40%);
}
.search-row.conflict-file:hover {
  background: linear-gradient(to right, rgba(232, 168, 56, 0.18) 0%, transparent 40%);
}
.conflict-badge {
  display: inline-block;
  font-size: 9px;
  font-weight: 600;
  color: #1a1a1a;
  background: #e8a838;
  padding: 1px 4px;
  border-radius: 3px;
  margin-right: 5px;
  vertical-align: middle;
  line-height: 1.2;
}

/* Bulk sync banner */
.bulk-sync-banner {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 12px;
  background: linear-gradient(90deg, rgba(232, 168, 56, 0.15), rgba(232, 168, 56, 0.05));
  border-bottom: 1px solid rgba(232, 168, 56, 0.3);
  font-size: 12px;
  color: #e8a838;
  animation: pulse-subtle 2s ease-in-out infinite;
}
@keyframes pulse-subtle {
  0%, 100% { opacity: 0.8; }
  50% { opacity: 1; }
}

/* Search Row Type Colors (Frontmatter mode) */
.search-row.note-type { border-left: 3px solid var(--note-color); background: linear-gradient(to right, var(--note-bg) 0%, transparent 30%); }
.search-row.sketch-type { border-left: 3px solid var(--sketch-color); background: linear-gradient(to right, var(--sketch-bg) 0%, transparent 30%); }
.search-row.mtg-type { border-left: 3px solid var(--mtg-color); background: linear-gradient(to right, var(--mtg-bg) 0%, transparent 30%); }
.search-row.sem-type { border-left: 3px solid var(--sem-color); background: linear-gradient(to right, var(--sem-bg) 0%, transparent 30%); }
.search-row.event-type { border-left: 3px solid var(--event-color); background: linear-gradient(to right, var(--event-bg) 0%, transparent 30%); }
.search-row.ofa-type { border-left: 3px solid var(--ofa-color); background: linear-gradient(to right, var(--ofa-bg) 0%, transparent 30%); }
.search-row.paper-type { border-left: 3px solid var(--paper-color); background: linear-gradient(to right, var(--paper-bg) 0%, transparent 30%); }
.search-row.lit-type { border-left: 3px solid var(--lit-color); background: linear-gradient(to right, var(--lit-bg) 0%, transparent 30%); }
.search-row.data-type { border-left: 3px solid var(--data-color); background: linear-gradient(to right, var(--data-bg) 0%, transparent 30%); }
.search-row.theo-type { border-left: 3px solid var(--theo-color); background: linear-gradient(to right, var(--theo-bg) 0%, transparent 30%); }
.search-row.contact-type { border-left: 3px solid var(--contact-color); background: linear-gradient(to right, var(--contact-bg) 0%, transparent 30%); }
.search-row.setup-type { border-left: 3px solid var(--setup-color); background: linear-gradient(to right, var(--setup-bg) 0%, transparent 30%); }

.search-row.note-type:hover { background: linear-gradient(to right, var(--note-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-row.sketch-type:hover { background: linear-gradient(to right, var(--sketch-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-row.mtg-type:hover { background: linear-gradient(to right, var(--mtg-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-row.sem-type:hover { background: linear-gradient(to right, var(--sem-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-row.event-type:hover { background: linear-gradient(to right, var(--event-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-row.ofa-type:hover { background: linear-gradient(to right, var(--ofa-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-row.paper-type:hover { background: linear-gradient(to right, var(--paper-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-row.lit-type:hover { background: linear-gradient(to right, var(--lit-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-row.data-type:hover { background: linear-gradient(to right, var(--data-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-row.theo-type:hover { background: linear-gradient(to right, var(--theo-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-row.contact-type:hover { background: linear-gradient(to right, var(--contact-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-row.setup-type:hover { background: linear-gradient(to right, var(--setup-bg-hover) 0%, var(--bg-hover-rgba) 40%); }

/* Custom color override for search rows */
.search-row.has-custom-color {
  border-left: 3px solid var(--template-color) !important;
  background: linear-gradient(to right, color-mix(in srgb, var(--template-color) 12%, transparent) 0%, transparent 30%) !important;
}
.search-row.has-custom-color:hover {
  background: linear-gradient(to right, color-mix(in srgb, var(--template-color) 20%, transparent) 0%, var(--bg-hover-rgba) 40%) !important;
}

.search-td {
  padding: 6px 12px;
  border-bottom: 1px solid var(--bg-tertiary);
  color: var(--text-secondary);
  vertical-align: middle;
}

.search-title {
  color: var(--text-primary);
  font-weight: 500;
}

.search-type {
  color: var(--text-muted);
  font-size: 11px;
}

.search-tags {
  display: flex;
  gap: 4px;
  flex-wrap: wrap;
  align-items: center;
  min-height: 22px;
}

.search-tag {
  padding: 1px 6px;
  background-color: #2d3748;
  border-radius: 3px;
  font-size: 11px;
  color: #a0aec0;
  font-family: "Malgun Gothic", "맑은 고딕", "Apple SD Gothic Neo", "Noto Sans KR", sans-serif !important;
  white-space: nowrap;
  /* No transition - instant style application for better performance */
}

/* Tag Category Colors */
.search-tag.tag-domain {
  background-color: rgba(139, 92, 246, 0.15);
  color: #a78bfa;
  border: 1px solid rgba(139, 92, 246, 0.3);
}

.search-tag.tag-who {
  background-color: rgba(34, 211, 238, 0.15);
  color: #22d3ee;
  border: 1px solid rgba(34, 211, 238, 0.3);
}

.search-tag.tag-org {
  background-color: rgba(251, 146, 60, 0.15);
  color: #fb923c;
  border: 1px solid rgba(251, 146, 60, 0.3);
}

.search-tag.tag-ctx {
  background-color: rgba(52, 211, 153, 0.15);
  color: #34d399;
  border: 1px solid rgba(52, 211, 153, 0.3);
}

.search-tag-empty {
  color: var(--text-muted);
  font-size: 11px;
}

.search-date {
  color: var(--text-muted);
  font-size: 11px;
  white-space: nowrap;
}

.search-empty {
  text-align: center;
  color: var(--text-muted);
  padding: 24px;
}

/* Search Content Results (Contents mode) */
.search-content-results {
  flex: 1;
  overflow-y: auto;
  padding: 4px 0;
}

.search-content-empty {
  padding: 24px;
  text-align: center;
  color: var(--text-muted);
  font-size: 13px;
}

.search-content-item {
  padding: 8px 16px;
  cursor: pointer;
  border-bottom: 1px solid var(--bg-tertiary);
  transition: background-color 0.1s;
}

.search-content-item:hover {
  background-color: var(--bg-tertiary);
}

/* Search Content Item Type Colors */
.search-content-item.note-type { border-left: 3px solid var(--note-color); background: linear-gradient(to right, var(--note-bg) 0%, transparent 30%); }
.search-content-item.sketch-type { border-left: 3px solid var(--sketch-color); background: linear-gradient(to right, var(--sketch-bg) 0%, transparent 30%); }
.search-content-item.mtg-type { border-left: 3px solid var(--mtg-color); background: linear-gradient(to right, var(--mtg-bg) 0%, transparent 30%); }
.search-content-item.sem-type { border-left: 3px solid var(--sem-color); background: linear-gradient(to right, var(--sem-bg) 0%, transparent 30%); }
.search-content-item.event-type { border-left: 3px solid var(--event-color); background: linear-gradient(to right, var(--event-bg) 0%, transparent 30%); }
.search-content-item.ofa-type { border-left: 3px solid var(--ofa-color); background: linear-gradient(to right, var(--ofa-bg) 0%, transparent 30%); }
.search-content-item.paper-type { border-left: 3px solid var(--paper-color); background: linear-gradient(to right, var(--paper-bg) 0%, transparent 30%); }
.search-content-item.lit-type { border-left: 3px solid var(--lit-color); background: linear-gradient(to right, var(--lit-bg) 0%, transparent 30%); }
.search-content-item.data-type { border-left: 3px solid var(--data-color); background: linear-gradient(to right, var(--data-bg) 0%, transparent 30%); }
.search-content-item.theo-type { border-left: 3px solid var(--theo-color); background: linear-gradient(to right, var(--theo-bg) 0%, transparent 30%); }
.search-content-item.contact-type { border-left: 3px solid var(--contact-color); background: linear-gradient(to right, var(--contact-bg) 0%, transparent 30%); }
.search-content-item.setup-type { border-left: 3px solid var(--setup-color); background: linear-gradient(to right, var(--setup-bg) 0%, transparent 30%); }

.search-content-item.note-type:hover { background: linear-gradient(to right, var(--note-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-content-item.sketch-type:hover { background: linear-gradient(to right, var(--sketch-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-content-item.mtg-type:hover { background: linear-gradient(to right, var(--mtg-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-content-item.sem-type:hover { background: linear-gradient(to right, var(--sem-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-content-item.event-type:hover { background: linear-gradient(to right, var(--event-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-content-item.ofa-type:hover { background: linear-gradient(to right, var(--ofa-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-content-item.paper-type:hover { background: linear-gradient(to right, var(--paper-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-content-item.lit-type:hover { background: linear-gradient(to right, var(--lit-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-content-item.data-type:hover { background: linear-gradient(to right, var(--data-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-content-item.theo-type:hover { background: linear-gradient(to right, var(--theo-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-content-item.contact-type:hover { background: linear-gradient(to right, var(--contact-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-content-item.setup-type:hover { background: linear-gradient(to right, var(--setup-bg-hover) 0%, var(--bg-hover-rgba) 40%); }

/* Custom color override for search content items */
.search-content-item.has-custom-color {
  border-left: 3px solid var(--template-color) !important;
  background: linear-gradient(to right, color-mix(in srgb, var(--template-color) 12%, transparent) 0%, transparent 30%) !important;
}
.search-content-item.has-custom-color:hover {
  background: linear-gradient(to right, color-mix(in srgb, var(--template-color) 20%, transparent) 0%, var(--bg-hover-rgba) 40%) !important;
}

.search-content-title {
  font-size: 13px;
  font-weight: 500;
  color: var(--text-primary);
  margin-bottom: 4px;
}

.search-content-snippet {
  font-size: 12px;
  color: var(--text-secondary);
  line-height: 1.4;
  overflow: hidden;
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
}

.search-content-path {
  font-size: 11px;
  color: var(--text-muted);
  margin-top: 4px;
}

.search-highlight {
  background-color: rgba(255, 200, 0, 0.3);
  color: #fff;
  padding: 0 1px;
  border-radius: 2px;
}

/* Search Details Tab */
.search-details-filters {
  display: flex;
  align-items: center;
  gap: 8px;
  flex: 1;
}

.search-details-select {
  padding: 5px 10px;
  font-size: 12px;
  background-color: var(--bg-tertiary);
  border: 1px solid var(--border-color);
  border-radius: 4px;
  color: var(--text-primary);
  outline: none;
  cursor: pointer;
}

.search-details-select:focus {
  border-color: var(--accent-color);
}

.search-details-results {
  flex: 1;
  overflow-y: auto;
  padding: 8px 0;
}

.search-details-item {
  padding: 10px 16px;
  cursor: pointer;
  border-bottom: 1px solid var(--bg-tertiary);
  transition: background-color 0.15s ease;
}

.search-details-item:hover {
  background-color: rgba(255, 255, 255, 0.05);
}

/* Search details item type colors */
.search-details-item.note-type { border-left: 3px solid var(--note-color); background: linear-gradient(to right, var(--note-bg) 0%, transparent 30%); }
.search-details-item.sketch-type { border-left: 3px solid var(--sketch-color); background: linear-gradient(to right, var(--sketch-bg) 0%, transparent 30%); }
.search-details-item.mtg-type { border-left: 3px solid var(--mtg-color); background: linear-gradient(to right, var(--mtg-bg) 0%, transparent 30%); }
.search-details-item.sem-type { border-left: 3px solid var(--sem-color); background: linear-gradient(to right, var(--sem-bg) 0%, transparent 30%); }
.search-details-item.event-type { border-left: 3px solid var(--event-color); background: linear-gradient(to right, var(--event-bg) 0%, transparent 30%); }
.search-details-item.ofa-type { border-left: 3px solid var(--ofa-color); background: linear-gradient(to right, var(--ofa-bg) 0%, transparent 30%); }
.search-details-item.paper-type { border-left: 3px solid var(--paper-color); background: linear-gradient(to right, var(--paper-bg) 0%, transparent 30%); }
.search-details-item.lit-type { border-left: 3px solid var(--lit-color); background: linear-gradient(to right, var(--lit-bg) 0%, transparent 30%); }
.search-details-item.data-type { border-left: 3px solid var(--data-color); background: linear-gradient(to right, var(--data-bg) 0%, transparent 30%); }
.search-details-item.theo-type { border-left: 3px solid var(--theo-color); background: linear-gradient(to right, var(--theo-bg) 0%, transparent 30%); }
.search-details-item.contact-type { border-left: 3px solid var(--contact-color); background: linear-gradient(to right, var(--contact-bg) 0%, transparent 30%); }
.search-details-item.setup-type { border-left: 3px solid var(--setup-color); background: linear-gradient(to right, var(--setup-bg) 0%, transparent 30%); }

/* Search details item hover type colors */
.search-details-item.note-type:hover { background: linear-gradient(to right, var(--note-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-details-item.sketch-type:hover { background: linear-gradient(to right, var(--sketch-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-details-item.mtg-type:hover { background: linear-gradient(to right, var(--mtg-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-details-item.sem-type:hover { background: linear-gradient(to right, var(--sem-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-details-item.event-type:hover { background: linear-gradient(to right, var(--event-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-details-item.ofa-type:hover { background: linear-gradient(to right, var(--ofa-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-details-item.paper-type:hover { background: linear-gradient(to right, var(--paper-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-details-item.lit-type:hover { background: linear-gradient(to right, var(--lit-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-details-item.data-type:hover { background: linear-gradient(to right, var(--data-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-details-item.theo-type:hover { background: linear-gradient(to right, var(--theo-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-details-item.contact-type:hover { background: linear-gradient(to right, var(--contact-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.search-details-item.setup-type:hover { background: linear-gradient(to right, var(--setup-bg-hover) 0%, var(--bg-hover-rgba) 40%); }

/* Custom color override for search details items */
.search-details-item.has-custom-color {
  border-left: 3px solid var(--template-color) !important;
  background: linear-gradient(to right, color-mix(in srgb, var(--template-color) 12%, transparent) 0%, transparent 30%) !important;
}
.search-details-item.has-custom-color:hover {
  background: linear-gradient(to right, color-mix(in srgb, var(--template-color) 20%, transparent) 0%, var(--bg-hover-rgba) 40%) !important;
}

.search-details-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  margin-bottom: 4px;
}

.search-details-title {
  font-size: 13px;
  font-weight: 500;
  color: var(--text-primary);
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.search-details-type {
  font-size: 11px;
  padding: 2px 6px;
  background: rgba(100, 150, 255, 0.2);
  border-radius: 3px;
  color: #8ab4f8;
  flex-shrink: 0;
}

.search-details-meta {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  margin-bottom: 4px;
}

.search-details-container {
  font-size: 11px;
  color: #888;
}

.search-details-dates {
  font-size: 10px;
  color: var(--text-muted);
}

.search-details-tags {
  display: flex;
  flex-wrap: wrap;
  gap: 4px;
  margin-top: 6px;
}

.search-details-tags .search-tag {
  cursor: pointer;
}

.search-details-tags .search-tag:hover {
  background-color: rgba(100, 150, 255, 0.3);
}

.search-details-comments {
  margin-top: 4px;
  font-size: 10px;
  color: var(--text-muted);
}

/* ============================================================ */
/* TipTap Editor */
/* ============================================================ */

.tiptap-editor {
  padding: 24px 32px;
  height: 100%;
  outline: none;
  color: var(--text-primary);
  font-size: 15px;
  line-height: 1.7;
  max-width: 800px;
  margin: 0 auto;
  width: 100%;
}

.tiptap-editor h1 {
  font-size: 20px;
  font-weight: 700;
  margin: 18px 0 10px;
  padding-left: 12px;
  border-left: 4px solid #7aa2f7;
  color: var(--text-primary);
}

.tiptap-editor h2 {
  font-size: 18px;
  font-weight: 600;
  margin: 16px 0 8px;
  padding-left: 10px;
  border-left: 3px solid #89b4fa;
  color: var(--text-primary);
}

.tiptap-editor h3 {
  font-size: 16px;
  font-weight: 600;
  margin: 14px 0 7px;
  padding-left: 8px;
  border-left: 2px solid #94e2d5;
  color: var(--text-primary);
}

.tiptap-editor p {
  margin: 0 0 8px;
}

.tiptap-editor ul,
.tiptap-editor ol {
  padding-left: 24px;
  margin: 8px 0;
}

.tiptap-editor li {
  margin: 4px 0;
}

/* Text formatting */
.tiptap-editor strong,
.tiptap-editor b {
  font-weight: 700;
}

.tiptap-editor em,
.tiptap-editor i,
.ProseMirror em,
.ProseMirror i,
.hover-tiptap-editor em,
.hover-tiptap-editor i {
  font-style: italic !important;
  /* Allow browser to synthesize italic for fonts without italic glyphs (CJK) */
  font-synthesis: style;
}

.tiptap-editor u {
  text-decoration: underline;
}

.tiptap-editor code {
  background-color: var(--bg-hover);
  padding: 2px 6px;
  border-radius: 3px;
  font-family: "Consolas", "Monaco", monospace;
  font-size: 13px;
}

.tiptap-editor pre {
  background-color: var(--bg-tertiary);
  padding: 16px;
  border-radius: 6px;
  margin: 12px 0;
  overflow-x: auto;
}

.tiptap-editor pre code {
  background: none;
  padding: 0;
  font-size: 13px;
  line-height: 1.5;
}

.tiptap-editor blockquote {
  border-left: 3px solid var(--accent-color);
  padding-left: 16px;
  margin: 12px 0;
  color: var(--text-secondary);
}

.tiptap-editor hr {
  border: none;
  border-top: 1px solid var(--border-color);
  margin: 24px 0;
  cursor: text;
  min-height: 1px;
}

.tiptap-editor .is-editor-empty:first-child::before {
  content: attr(data-placeholder);
  float: left;
  color: var(--text-muted);
  pointer-events: none;
  height: 0;
}

.tiptap.ProseMirror {
  height: 100%;
  overflow-y: auto;
}

/* Frontmatter Panel */
.frontmatter-panel {
  padding: 12px 32px;
  background-color: var(--bg-tertiary);
  border-bottom: 1px solid var(--border-color);
  font-family: "Consolas", "Monaco", monospace;
  font-size: 12px;
  max-width: 800px;
  margin: 0 auto;
  width: 100%;
  flex-shrink: 0;
}

.frontmatter-field {
  display: flex;
  gap: 8px;
  padding: 1px 0;
}

.frontmatter-key {
  color: #569cd6;
  flex-shrink: 0;
}

.frontmatter-value {
  color: #ce9178;
  word-break: break-all;
}

/* Wiki Links */
.wiki-link-inline {
  color: #a78bfa;
  cursor: pointer;
  text-decoration: none;
  font-weight: 500;
  padding: 2px 6px;
  border-radius: 4px;
  background-color: rgba(167, 139, 250, 0.1);
  border: 1px solid rgba(167, 139, 250, 0.25);
  transition: background-color 0.15s ease, border-color 0.15s ease, box-shadow 0.15s ease;
  display: inline-flex;
  align-items: center;
  gap: 4px;
  vertical-align: baseline;
  user-select: none;
  /* Hide the [[...]] brackets by setting font-size to 0 (for decoration-based links) */
  font-size: 0;
}

/* Wiki link atom nodes (rendered directly without brackets) */
.wiki-link-inline.wiki-link-node {
  font-size: 14px;
}

/* Hide ::after for atom nodes since content is rendered directly */
.wiki-link-inline.wiki-link-node::after {
  content: none;
}

/* Show only the filename via ::after pseudo-element (for decoration-based links) */
.wiki-link-inline::after {
  content: attr(data-wiki-link);
  font-size: 14px;
  font-weight: 500;
}

.wiki-link-inline:hover {
  background-color: rgba(167, 139, 250, 0.2);
  border-color: rgba(167, 139, 250, 0.4);
  color: #c4b5fd;
  box-shadow: 0 1px 4px rgba(167, 139, 250, 0.2);
}

.wiki-link-inline.unresolved {
  color: #9ca3af;
  text-decoration: underline;
  text-decoration-style: dashed;
  text-decoration-color: #6b7280;
  opacity: 0.8;
}

.wiki-link-inline.unresolved:hover {
  background-color: rgba(156, 163, 175, 0.1);
  color: #d1d5db;
}

.wiki-link-inline.attachment {
  color: #00d4aa;
  background-color: rgba(0, 212, 170, 0.08);
  border-color: rgba(0, 212, 170, 0.3);
}

.wiki-link-inline.attachment::after {
  font-family: 'Courier New', monospace;
}

.wiki-link-inline.attachment::before {
  content: '';
  display: inline-block;
  width: 14px;
  height: 14px;
  margin-right: 4px;
  margin-left: 0;
  vertical-align: middle;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%2300d4aa' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48'%3E%3C/path%3E%3C/svg%3E");
  background-size: contain;
  background-repeat: no-repeat;
}

.wiki-link-inline.attachment:hover {
  background-color: rgba(0, 212, 170, 0.2);
  border-color: rgba(0, 212, 170, 0.5);
  color: #00ffcc;
}

.wiki-link-inline.attachment.unresolved {
  color: #9ca3af;
}

/* ===== Attachment extension category styles ===== */

/* Image files (.png, .jpg, .gif, .webp, .svg, etc.) */
.wiki-link-inline.attachment.att-image {
  color: #34d399;
  background-color: rgba(52, 211, 153, 0.08);
  border-color: rgba(52, 211, 153, 0.3);
}
.wiki-link-inline.attachment.att-image::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%2334d399' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect x='3' y='3' width='18' height='18' rx='2' ry='2'%3E%3C/rect%3E%3Ccircle cx='8.5' cy='8.5' r='1.5'%3E%3C/circle%3E%3Cpolyline points='21 15 16 10 5 21'%3E%3C/polyline%3E%3C/svg%3E");
}
.wiki-link-inline.attachment.att-image:hover {
  background-color: rgba(52, 211, 153, 0.2);
  border-color: rgba(52, 211, 153, 0.5);
  color: #6ee7b7;
}

/* Document files (.pdf, .doc, .docx, .ppt, .hwp, etc.) */
.wiki-link-inline.attachment.att-document {
  color: #fb923c;
  background-color: rgba(251, 146, 60, 0.08);
  border-color: rgba(251, 146, 60, 0.3);
}
.wiki-link-inline.attachment.att-document::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%23fb923c' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z'%3E%3C/path%3E%3Cpolyline points='14 2 14 8 20 8'%3E%3C/polyline%3E%3Cline x1='16' y1='13' x2='8' y2='13'%3E%3C/line%3E%3Cline x1='16' y1='17' x2='8' y2='17'%3E%3C/line%3E%3C/svg%3E");
}
.wiki-link-inline.attachment.att-document:hover {
  background-color: rgba(251, 146, 60, 0.2);
  border-color: rgba(251, 146, 60, 0.5);
  color: #fdba74;
}

/* Data files (.xlsx, .csv, .json, .xml, .yaml, etc.) */
.wiki-link-inline.attachment.att-data {
  color: #fbbf24;
  background-color: rgba(251, 191, 36, 0.08);
  border-color: rgba(251, 191, 36, 0.3);
}
.wiki-link-inline.attachment.att-data::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%23fbbf24' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cellipse cx='12' cy='5' rx='9' ry='3'%3E%3C/ellipse%3E%3Cpath d='M21 12c0 1.66-4 3-9 3s-9-1.34-9-3'%3E%3C/path%3E%3Cpath d='M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5'%3E%3C/path%3E%3C/svg%3E");
}
.wiki-link-inline.attachment.att-data:hover {
  background-color: rgba(251, 191, 36, 0.2);
  border-color: rgba(251, 191, 36, 0.5);
  color: #fcd34d;
}

/* Code files (.py, .js, .ts, .rs, .go, etc.) */
.wiki-link-inline.attachment.att-code {
  color: #22d3ee;
  background-color: rgba(34, 211, 238, 0.08);
  border-color: rgba(34, 211, 238, 0.3);
}
.wiki-link-inline.attachment.att-code::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%2322d3ee' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='16 18 22 12 16 6'%3E%3C/polyline%3E%3Cpolyline points='8 6 2 12 8 18'%3E%3C/polyline%3E%3C/svg%3E");
}
.wiki-link-inline.attachment.att-code:hover {
  background-color: rgba(34, 211, 238, 0.2);
  border-color: rgba(34, 211, 238, 0.5);
  color: #67e8f9;
}

/* Contact files (.vcf) */
.wiki-link-inline.attachment.att-contact {
  color: #38bdf8;
  background-color: rgba(56, 189, 248, 0.08);
  border-color: rgba(56, 189, 248, 0.3);
}
.wiki-link-inline.attachment.att-contact::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%2338bdf8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2'%3E%3C/path%3E%3Ccircle cx='12' cy='7' r='4'%3E%3C/circle%3E%3C/svg%3E");
}
.wiki-link-inline.attachment.att-contact:hover {
  background-color: rgba(56, 189, 248, 0.2);
  border-color: rgba(56, 189, 248, 0.5);
  color: #7dd3fc;
}

/* Media files (.mp3, .mp4, .wav, .avi, etc.) */
.wiki-link-inline.attachment.att-media {
  color: #c084fc;
  background-color: rgba(192, 132, 252, 0.08);
  border-color: rgba(192, 132, 252, 0.3);
}
.wiki-link-inline.attachment.att-media::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%23c084fc' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M9 18V5l12-2v13'%3E%3C/path%3E%3Ccircle cx='6' cy='18' r='3'%3E%3C/circle%3E%3Ccircle cx='18' cy='16' r='3'%3E%3C/circle%3E%3C/svg%3E");
}
.wiki-link-inline.attachment.att-media:hover {
  background-color: rgba(192, 132, 252, 0.2);
  border-color: rgba(192, 132, 252, 0.5);
  color: #d8b4fe;
}

/* Archive files (.zip, .7z, .rar, .tar, etc.) */
.wiki-link-inline.attachment.att-archive {
  color: #9ca3af;
  background-color: rgba(156, 163, 175, 0.08);
  border-color: rgba(156, 163, 175, 0.3);
}
.wiki-link-inline.attachment.att-archive::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%239ca3af' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M21 8v13H3V8'%3E%3C/path%3E%3Cpath d='M1 3h22v5H1z'%3E%3C/path%3E%3Cpath d='M10 12h4'%3E%3C/path%3E%3C/svg%3E");
}
.wiki-link-inline.attachment.att-archive:hover {
  background-color: rgba(156, 163, 175, 0.2);
  border-color: rgba(156, 163, 175, 0.5);
  color: #d1d5db;
}

/* Markdown attachment files (.md in _att folder) */
.wiki-link-inline.attachment.att-markdown {
  color: #2dd4bf;
  background-color: rgba(45, 212, 191, 0.08);
  border-color: rgba(45, 212, 191, 0.3);
}
.wiki-link-inline.attachment.att-markdown::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%232dd4bf' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z'%3E%3C/path%3E%3Cpolyline points='14 2 14 8 20 8'%3E%3C/polyline%3E%3C/svg%3E");
}
.wiki-link-inline.attachment.att-markdown:hover {
  background-color: rgba(45, 212, 191, 0.2);
  border-color: rgba(45, 212, 191, 0.5);
  color: #5eead4;
}

/* Decoration-based resolved class overrides node's unresolved class */
/* This allows dynamic updates when fileTree changes */
/* Color is inherited from note-type-* classes, not set here */
.wiki-link-inline.wiki-link-decoration.resolved,
.wiki-link-inline.wiki-link-decoration.resolved.unresolved {
  text-decoration: none;
  opacity: 1;
}

.wiki-link-inline.attachment.wiki-link-decoration.resolved,
.wiki-link-inline.attachment.wiki-link-decoration.resolved.unresolved {
  text-decoration: none;
  opacity: 1;
}

/* Note type specific colors with icons */
.wiki-link-inline.note-type-note {
  color: var(--note-color);
  }

.wiki-link-inline.note-type-note::before {
  content: '';
  display: inline-block;
  width: 14px;
  height: 14px;
  margin-right: 4px;
  margin-left: 0;
  vertical-align: middle;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%23a78bfa' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z'%3E%3C/path%3E%3Cpolyline points='14 2 14 8 20 8'%3E%3C/polyline%3E%3Cline x1='16' y1='13' x2='8' y2='13'%3E%3C/line%3E%3Cline x1='16' y1='17' x2='8' y2='17'%3E%3C/line%3E%3Cpolyline points='10 9 9 9 8 9'%3E%3C/polyline%3E%3C/svg%3E");
  background-size: contain;
  background-repeat: no-repeat;
}

.wiki-link-inline.note-type-mtg {
  color: var(--mtg-color);
  }

.wiki-link-inline.note-type-mtg::before {
  content: '';
  display: inline-block;
  width: 14px;
  height: 14px;
  margin-right: 4px;
  margin-left: 0;
  vertical-align: middle;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%2360a5fa' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2'%3E%3C/path%3E%3Ccircle cx='9' cy='7' r='4'%3E%3C/circle%3E%3Cpath d='M22 21v-2a4 4 0 0 0-3-3.87'%3E%3C/path%3E%3Cpath d='M16 3.13a4 4 0 0 1 0 7.75'%3E%3C/path%3E%3C/svg%3E");
  background-size: contain;
  background-repeat: no-repeat;
}

.wiki-link-inline.note-type-paper {
  color: var(--paper-color);
  }

.wiki-link-inline.note-type-paper::before {
  content: '';
  display: inline-block;
  width: 14px;
  height: 14px;
  margin-right: 4px;
  margin-left: 0;
  vertical-align: middle;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%235eead4' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7'%3E%3C/path%3E%3Cpath d='M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z'%3E%3C/path%3E%3C/svg%3E");
  background-size: contain;
  background-repeat: no-repeat;
}

.wiki-link-inline.note-type-event {
  color: var(--event-color);
  }

.wiki-link-inline.note-type-event::before {
  content: '';
  display: inline-block;
  width: 14px;
  height: 14px;
  margin-right: 4px;
  margin-left: 0;
  vertical-align: middle;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%23f87171' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect x='3' y='4' width='18' height='18' rx='2' ry='2'%3E%3C/rect%3E%3Cline x1='16' y1='2' x2='16' y2='6'%3E%3C/line%3E%3Cline x1='8' y1='2' x2='8' y2='6'%3E%3C/line%3E%3Cline x1='3' y1='10' x2='21' y2='10'%3E%3C/line%3E%3C/svg%3E");
  background-size: contain;
  background-repeat: no-repeat;
}

.wiki-link-inline.note-type-sketch {
  color: var(--sketch-color);
  }

.wiki-link-inline.note-type-sketch::before {
  content: '';
  display: inline-block;
  width: 14px;
  height: 14px;
  margin-right: 4px;
  margin-left: 0;
  vertical-align: middle;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%23f472b6' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12 19l7-7 3 3-7 7-3-3z'%3E%3C/path%3E%3Cpath d='M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z'%3E%3C/path%3E%3Cpath d='M2 2l7.586 7.586'%3E%3C/path%3E%3Ccircle cx='11' cy='11' r='2'%3E%3C/circle%3E%3C/svg%3E");
  background-size: contain;
  background-repeat: no-repeat;
}

.wiki-link-inline.note-type-data {
  color: var(--data-color);
  }

.wiki-link-inline.note-type-data::before {
  content: '';
  display: inline-block;
  width: 14px;
  height: 14px;
  margin-right: 4px;
  margin-left: 0;
  vertical-align: middle;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%23fbbf24' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cellipse cx='12' cy='5' rx='9' ry='3'%3E%3C/ellipse%3E%3Cpath d='M21 12c0 1.66-4 3-9 3s-9-1.34-9-3'%3E%3C/path%3E%3Cpath d='M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5'%3E%3C/path%3E%3C/svg%3E");
  background-size: contain;
  background-repeat: no-repeat;
}

.wiki-link-inline.note-type-theo {
  color: var(--theo-color);
  }

.wiki-link-inline.note-type-theo::before {
  content: '';
  display: inline-block;
  width: 14px;
  height: 14px;
  margin-right: 4px;
  margin-left: 0;
  vertical-align: middle;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%23818cf8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='5'%3E%3C/circle%3E%3Cline x1='12' y1='1' x2='12' y2='3'%3E%3C/line%3E%3Cline x1='12' y1='21' x2='12' y2='23'%3E%3C/line%3E%3Cline x1='4.22' y1='4.22' x2='5.64' y2='5.64'%3E%3C/line%3E%3Cline x1='18.36' y1='18.36' x2='19.78' y2='19.78'%3E%3C/line%3E%3Cline x1='1' y1='12' x2='3' y2='12'%3E%3C/line%3E%3Cline x1='21' y1='12' x2='23' y2='12'%3E%3C/line%3E%3Cline x1='4.22' y1='19.78' x2='5.64' y2='18.36'%3E%3C/line%3E%3Cline x1='18.36' y1='5.64' x2='19.78' y2='4.22'%3E%3C/line%3E%3C/svg%3E");
  background-size: contain;
  background-repeat: no-repeat;
}

.wiki-link-inline.note-type-contact,
.wiki-link-inline.wiki-link-decoration.note-type-contact,
.wiki-link-inline.wiki-link-decoration.resolved.note-type-contact,
.wiki-link-inline.wiki-link-node.note-type-contact {
  color: var(--contact-color) !important;
}

.wiki-link-inline.note-type-contact:hover,
.wiki-link-inline.wiki-link-decoration.note-type-contact:hover,
.wiki-link-inline.wiki-link-decoration.resolved.note-type-contact:hover {
  color: #67e8f9 !important;
  background-color: rgba(34, 211, 238, 0.15) !important;
}

.wiki-link-inline.note-type-contact::before {
  content: '';
  display: inline-block;
  width: 14px;
  height: 14px;
  margin-right: 4px;
  margin-left: 0;
  vertical-align: middle;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%2322d3ee' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2'%3E%3C/path%3E%3Ccircle cx='12' cy='7' r='4'%3E%3C/circle%3E%3C/svg%3E");
  background-size: contain;
  background-repeat: no-repeat;
}

.wiki-link-inline.note-type-setup {
  color: var(--setup-color);
  }

.wiki-link-inline.note-type-setup::before {
  content: '';
  display: inline-block;
  width: 14px;
  height: 14px;
  margin-right: 4px;
  margin-left: 0;
  vertical-align: middle;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%239ca3af' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='3'%3E%3C/circle%3E%3Cpath d='M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z'%3E%3C/path%3E%3C/svg%3E");
  background-size: contain;
  background-repeat: no-repeat;
}

.wiki-link-inline.note-type-ofa {
  color: var(--ofa-color);
  }

.wiki-link-inline.note-type-ofa::before {
  content: '';
  display: inline-block;
  width: 14px;
  height: 14px;
  margin-right: 4px;
  margin-left: 0;
  vertical-align: middle;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%2334d399' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z'%3E%3C/path%3E%3C/svg%3E");
  background-size: contain;
  background-repeat: no-repeat;
}

.wiki-link-inline.note-type-lit {
  color: var(--lit-color);
  }

.wiki-link-inline.note-type-lit::before {
  content: '';
  display: inline-block;
  width: 14px;
  height: 14px;
  margin-right: 4px;
  margin-left: 0;
  vertical-align: middle;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%23a3e635' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M4 19.5A2.5 2.5 0 0 1 6.5 17H20'%3E%3C/path%3E%3Cpath d='M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z'%3E%3C/path%3E%3C/svg%3E");
  background-size: contain;
  background-repeat: no-repeat;
}

.wiki-link-inline.note-type-sem {
  color: var(--sem-color);
  }

.wiki-link-inline.note-type-sem::before {
  content: '';
  display: inline-block;
  width: 14px;
  height: 14px;
  margin-right: 4px;
  margin-left: 0;
  vertical-align: middle;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%23fb923c' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M22 10v6M2 10l10-5 10 5-10 5z'%3E%3C/path%3E%3Cpath d='M6 12v5c3 3 9 3 12 0v-5'%3E%3C/path%3E%3C/svg%3E");
  background-size: contain;
  background-repeat: no-repeat;
}

/* ============================================================ */
/* Wiki Link Icons - Light Mode (Darker stroke colors) */
/* ============================================================ */
html[data-theme="light"] .wiki-link-inline.note-type-note::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%237c3aed' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z'%3E%3C/path%3E%3Cpolyline points='14 2 14 8 20 8'%3E%3C/polyline%3E%3Cline x1='16' y1='13' x2='8' y2='13'%3E%3C/line%3E%3Cline x1='16' y1='17' x2='8' y2='17'%3E%3C/line%3E%3Cpolyline points='10 9 9 9 8 9'%3E%3C/polyline%3E%3C/svg%3E");
}

html[data-theme="light"] .wiki-link-inline.note-type-mtg::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%232563eb' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2'%3E%3C/path%3E%3Ccircle cx='9' cy='7' r='4'%3E%3C/circle%3E%3Cpath d='M22 21v-2a4 4 0 0 0-3-3.87'%3E%3C/path%3E%3Cpath d='M16 3.13a4 4 0 0 1 0 7.75'%3E%3C/path%3E%3C/svg%3E");
}

html[data-theme="light"] .wiki-link-inline.note-type-paper::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%230d9488' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7'%3E%3C/path%3E%3Cpath d='M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z'%3E%3C/path%3E%3C/svg%3E");
}

html[data-theme="light"] .wiki-link-inline.note-type-event::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%23dc2626' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect x='3' y='4' width='18' height='18' rx='2' ry='2'%3E%3C/rect%3E%3Cline x1='16' y1='2' x2='16' y2='6'%3E%3C/line%3E%3Cline x1='8' y1='2' x2='8' y2='6'%3E%3C/line%3E%3Cline x1='3' y1='10' x2='21' y2='10'%3E%3C/line%3E%3C/svg%3E");
}

html[data-theme="light"] .wiki-link-inline.note-type-sketch::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%23db2777' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12 19l7-7 3 3-7 7-3-3z'%3E%3C/path%3E%3Cpath d='M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z'%3E%3C/path%3E%3Cpath d='M2 2l7.586 7.586'%3E%3C/path%3E%3Ccircle cx='11' cy='11' r='2'%3E%3C/circle%3E%3C/svg%3E");
}

html[data-theme="light"] .wiki-link-inline.note-type-data::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%23d97706' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cellipse cx='12' cy='5' rx='9' ry='3'%3E%3C/ellipse%3E%3Cpath d='M21 12c0 1.66-4 3-9 3s-9-1.34-9-3'%3E%3C/path%3E%3Cpath d='M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5'%3E%3C/path%3E%3C/svg%3E");
}

html[data-theme="light"] .wiki-link-inline.note-type-theo::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%234f46e5' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12 2L2 7l10 5 10-5-10-5z'%3E%3C/path%3E%3Cpath d='M2 17l10 5 10-5'%3E%3C/path%3E%3Cpath d='M2 12l10 5 10-5'%3E%3C/path%3E%3C/svg%3E");
}

html[data-theme="light"] .wiki-link-inline.note-type-contact::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%230891b2' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2'%3E%3C/path%3E%3Ccircle cx='12' cy='7' r='4'%3E%3C/circle%3E%3C/svg%3E");
}

html[data-theme="light"] .wiki-link-inline.note-type-setup::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%236b7280' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='3'%3E%3C/circle%3E%3Cpath d='M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z'%3E%3C/path%3E%3C/svg%3E");
}

html[data-theme="light"] .wiki-link-inline.note-type-ofa::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%23059669' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z'%3E%3C/path%3E%3C/svg%3E");
}

html[data-theme="light"] .wiki-link-inline.note-type-lit::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%2365a30d' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M4 19.5A2.5 2.5 0 0 1 6.5 17H20'%3E%3C/path%3E%3Cpath d='M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z'%3E%3C/path%3E%3C/svg%3E");
}

html[data-theme="light"] .wiki-link-inline.note-type-sem::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%23ea580c' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M22 10v6M2 10l10-5 10 5-10 5z'%3E%3C/path%3E%3Cpath d='M6 12v5c3 3 9 3 12 0v-5'%3E%3C/path%3E%3C/svg%3E");
}

html[data-theme="light"] .wiki-link-inline.attachment::before {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%23059669' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48'%3E%3C/path%3E%3C/svg%3E");
}

/* Light mode - wiki link base styles (text color from note-type via CSS variables) */
html[data-theme="light"] .wiki-link-inline {
  /* color inherited from note-type-* classes via var(--xxx-color) */
  background-color: rgba(100, 100, 100, 0.05);
  border-color: rgba(100, 100, 100, 0.15);
}

html[data-theme="light"] .wiki-link-inline:hover {
  background-color: rgba(100, 100, 100, 0.1);
  border-color: rgba(100, 100, 100, 0.25);
}

html[data-theme="light"] .wiki-link-inline.unresolved {
  color: #6b7280;
  text-decoration-color: #9ca3af;
}

html[data-theme="light"] .wiki-link-inline.unresolved:hover {
  background-color: rgba(107, 114, 128, 0.1);
  color: #4b5563;
}

html[data-theme="light"] .wiki-link-inline.attachment {
  color: #059669;
  background-color: rgba(5, 150, 105, 0.08);
  border-color: rgba(5, 150, 105, 0.25);
}

html[data-theme="light"] .wiki-link-inline.attachment:hover {
  background-color: rgba(5, 150, 105, 0.15);
  border-color: rgba(5, 150, 105, 0.4);
  color: #047857;
}

/* resolved class - color inherited from note-type-* classes */

html[data-theme="light"] .wiki-link-inline.note-type-contact:hover,
html[data-theme="light"] .wiki-link-inline.wiki-link-decoration.note-type-contact:hover,
html[data-theme="light"] .wiki-link-inline.wiki-link-decoration.resolved.note-type-contact:hover {
  color: #0e7490 !important;
  background-color: rgba(8, 145, 178, 0.15) !important;
}

/* System theme - follow OS preference for wiki links */
@media (prefers-color-scheme: light) {
  html[data-theme="system"] .wiki-link-inline.note-type-note::before {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%237c3aed' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z'%3E%3C/path%3E%3Cpolyline points='14 2 14 8 20 8'%3E%3C/polyline%3E%3Cline x1='16' y1='13' x2='8' y2='13'%3E%3C/line%3E%3Cline x1='16' y1='17' x2='8' y2='17'%3E%3C/line%3E%3Cpolyline points='10 9 9 9 8 9'%3E%3C/polyline%3E%3C/svg%3E");
  }

  html[data-theme="system"] .wiki-link-inline.note-type-mtg::before {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%232563eb' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2'%3E%3C/path%3E%3Ccircle cx='9' cy='7' r='4'%3E%3C/circle%3E%3Cpath d='M22 21v-2a4 4 0 0 0-3-3.87'%3E%3C/path%3E%3Cpath d='M16 3.13a4 4 0 0 1 0 7.75'%3E%3C/path%3E%3C/svg%3E");
  }

  html[data-theme="system"] .wiki-link-inline.note-type-contact::before {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%230891b2' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2'%3E%3C/path%3E%3Ccircle cx='12' cy='7' r='4'%3E%3C/circle%3E%3C/svg%3E");
  }

  html[data-theme="system"] .wiki-link-inline {
    /* color inherited from note-type-* classes via var(--xxx-color) */
    background-color: rgba(100, 100, 100, 0.05);
    border-color: rgba(100, 100, 100, 0.15);
  }

  html[data-theme="system"] .wiki-link-inline:hover {
    background-color: rgba(100, 100, 100, 0.1);
    border-color: rgba(100, 100, 100, 0.25);
  }

  html[data-theme="system"] .wiki-link-inline.attachment {
    color: #059669;
    background-color: rgba(5, 150, 105, 0.08);
    border-color: rgba(5, 150, 105, 0.25);
  }
}

/* Wiki Image Embed (![[image.jpg]]) */
.wiki-image-embed-wrapper {
  margin: 8px 0;
  display: inline-block;
  max-width: 100%;
}

.wiki-image-embed-container {
  position: relative;
  display: inline-block;
}

.wiki-image-embed {
  max-width: 100%;
  max-height: 400px;
  display: block;
  border-radius: 4px;
  cursor: pointer;
  transition: opacity 0.2s;
}

.wiki-image-embed:hover {
  opacity: 0.9;
}

.wiki-image-embed-delete {
  position: absolute;
  top: 8px;
  right: 8px;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  border: none;
  background-color: rgba(0, 0, 0, 0.6);
  color: #fff;
  font-size: 16px;
  line-height: 1;
  cursor: pointer;
  opacity: 0;
  transition: opacity 0.2s, background-color 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
}

.wiki-image-embed-container:hover .wiki-image-embed-delete {
  opacity: 1;
}

.wiki-image-embed-delete:hover {
  background-color: #dc2626;
}

.wiki-image-embed-text {
  display: none !important;
}

html[data-theme="light"] .wiki-image-embed-delete {
  background-color: rgba(0, 0, 0, 0.5);
}

/* ============================================================ */
/* Hover Editor (Floating Panel - Hardware Accelerated) */
/* ============================================================ */

/*
 * GPU ANIMATION - NO TRANSFORM (to avoid ghost at top-left bug)
 * IMPORTANT: Do NOT use transform in animations!
 * The inline style uses transform for positioning (translate3d(x, y, 0))
 * If animation uses transform, it overrides position causing "ghost at top-left" bug
 *
 * Using opacity + filter:blur for smooth focus effect animations
 */
@keyframes hover-window-open {
  0% {
    opacity: 0;
    filter: blur(8px);
  }
  100% {
    opacity: 1;
    filter: blur(0);
  }
}

@keyframes hover-window-close {
  0% {
    opacity: 1;
    filter: blur(0);
  }
  100% {
    opacity: 0;
    filter: blur(8px);
  }
}

@keyframes hover-window-minimize {
  0% {
    opacity: 1;
    filter: blur(0);
  }
  100% {
    opacity: 0;
    filter: blur(6px);
  }
}

@keyframes hover-window-restore {
  0% {
    opacity: 0;
    filter: blur(6px);
  }
  100% {
    opacity: 1;
    filter: blur(0);
  }
}

.hover-editor {
  position: fixed;
  top: 0;
  left: 0;
  background-color: var(--bg-primary);
  border: 2px solid var(--border-light);
  border-radius: 8px;
  box-shadow: 0 8px 32px var(--shadow-color);
  display: flex;
  flex-direction: column;
  overflow: visible;
  /* GPU layer creation - cached on first render */
  will-change: transform, opacity, filter;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  transform: translate3d(0, 0, 0);
  /* Layout isolation for faster paint */
  contain: layout style;
}

/* Flash animation for focus feedback (no state update needed) */
.hover-editor.hover-flash {
  animation: hover-window-flash 0.3s ease-out;
}

@keyframes hover-window-flash {
  0% { box-shadow: 0 8px 32px var(--shadow-color), 0 0 0 3px var(--accent-color); }
  100% { box-shadow: 0 8px 32px var(--shadow-color); }
}

/* Opening animation - perceptible but snappy (0.18s) */
.hover-editor.is-opening {
  animation: hover-window-open 0.18s cubic-bezier(0.22, 1, 0.36, 1) forwards !important;
}

/* Closing animation - slightly faster (0.15s) */
.hover-editor.is-closing {
  animation: hover-window-close 0.15s ease-out forwards !important;
  pointer-events: none;
}

/* Minimizing animation - slide up effect */
.hover-editor.is-minimizing {
  animation: hover-window-minimize 0.15s ease-out forwards !important;
  pointer-events: none;
}

/* Restoring animation - slide down from minimized */
.hover-editor.is-restoring {
  animation: hover-window-restore 0.18s cubic-bezier(0.22, 1, 0.36, 1) forwards !important;
}

/* Maximize/unmaximize - instant size change for performance
 * OPTIMIZATION: Removed width/height transitions that cause reflow
 */
.hover-editor.is-maximizing,
.hover-editor.is-unmaximizing {
  contain: layout style;
}

/* Snap - instant feel, no transition */
.hover-editor.is-snapping {
  contain: layout style;
}

/* Prevent text selection during drag/resize operations */
.hover-editor.is-dragging,
.hover-editor.is-dragging *,
.hover-editor.is-resizing,
.hover-editor.is-resizing * {
  user-select: none !important;
  -webkit-user-select: none !important;
}

/* Prevent toolbar hover during drag/resize */
.hover-editor.is-dragging .editor-toolbar-wrapper,
.hover-editor.is-resizing .editor-toolbar-wrapper {
  pointer-events: none !important;
}

/* Performance optimization during drag/resize */
.hover-editor.is-dragging,
.hover-editor.is-resizing {
  box-shadow: none !important;
  transition: none !important;
  animation: none !important;
}

.hover-editor.is-dragging *,
.hover-editor.is-resizing * {
  transition: none !important;
}

.hover-editor.is-dragging .editor-toolbar,
.hover-editor.is-resizing .editor-toolbar {
  backdrop-filter: none !important;
}

/* Fast snap - handled above with contain: layout style */

/* Hover Editor Type Borders */
.hover-editor.note-type { border-color: var(--note-border); }
.hover-editor.sketch-type { border-color: var(--sketch-border); }
.hover-editor.mtg-type { border-color: var(--mtg-border); }
.hover-editor.sem-type { border-color: var(--sem-border); }
.hover-editor.event-type { border-color: var(--event-border); }
.hover-editor.ofa-type { border-color: var(--ofa-border); }
.hover-editor.paper-type { border-color: var(--paper-border); }
.hover-editor.lit-type { border-color: var(--lit-border); }
.hover-editor.data-type { border-color: var(--data-border); }
.hover-editor.theo-type { border-color: var(--theo-border); }
.hover-editor.contact-type { border-color: var(--contact-border); }
.hover-editor.setup-type { border-color: var(--setup-border); }

/* Custom color overrides via --template-color variable */
.hover-editor.has-custom-color {
  border-color: var(--template-color) !important;
}

.hover-editor-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 6px 12px;
  background-color: var(--bg-tertiary);
  border-bottom: 1px solid var(--border-color);
  border-top-left-radius: 6px;
  border-top-right-radius: 6px;
  cursor: move;
  flex-shrink: 0;
  user-select: none;
  position: relative;
  z-index: 20;
}

/* Hover Editor Header Type Colors */
.hover-editor.note-type .hover-editor-header { background-color: var(--note-header); border-bottom-color: var(--note-border); }
.hover-editor.sketch-type .hover-editor-header { background-color: var(--sketch-header); border-bottom-color: var(--sketch-border); }
.hover-editor.mtg-type .hover-editor-header { background-color: var(--mtg-header); border-bottom-color: var(--mtg-border); }
.hover-editor.sem-type .hover-editor-header { background-color: var(--sem-header); border-bottom-color: var(--sem-border); }
.hover-editor.event-type .hover-editor-header { background-color: var(--event-header); border-bottom-color: var(--event-border); }
.hover-editor.ofa-type .hover-editor-header { background-color: var(--ofa-header); border-bottom-color: var(--ofa-border); }
.hover-editor.paper-type .hover-editor-header { background-color: var(--paper-header); border-bottom-color: var(--paper-border); }
.hover-editor.lit-type .hover-editor-header { background-color: var(--lit-header); border-bottom-color: var(--lit-border); }
.hover-editor.data-type .hover-editor-header { background-color: var(--data-header); border-bottom-color: var(--data-border); }
.hover-editor.theo-type .hover-editor-header { background-color: var(--theo-header); border-bottom-color: var(--theo-border); }
.hover-editor.contact-type .hover-editor-header { background-color: var(--contact-header); border-bottom-color: var(--contact-border); }
.hover-editor.setup-type .hover-editor-header { background-color: var(--setup-header); border-bottom-color: var(--setup-border); }

/* Custom color header override */
.hover-editor.has-custom-color .hover-editor-header {
  background-color: color-mix(in srgb, var(--template-color) 20%, #2d2d2d) !important;
  border-bottom-color: var(--template-color) !important;
}

.hover-editor-title {
  font-size: 13px;
  color: var(--text-primary);
  font-weight: 500;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  flex: 1;
}

.hover-editor-header-actions {
  display: flex;
  align-items: center;
  gap: 4px;
  flex-shrink: 0;
}

.hover-editor-fm-toggle {
  background: none;
  border: none;
  color: var(--text-muted);
  font-size: 16px;
  cursor: pointer;
  padding: 0 4px;
  line-height: 1;
  border-radius: 3px;
}

.hover-editor-fm-toggle:hover {
  color: var(--text-secondary);
  background-color: var(--bg-hover);
}

.hover-editor-fm-toggle.active {
  color: var(--accent-color);
}

.hover-editor-close,
.hover-editor-minimize {
  background: none;
  border: none;
  color: var(--text-muted);
  font-size: 18px;
  cursor: pointer;
  padding: 0 4px;
  line-height: 1;
  /* GPU acceleration for instant response */
  will-change: transform, opacity;
  transform: translateZ(0);
  transition: color 0.1s ease;
}

.hover-editor-close:hover,
.hover-editor-minimize:hover {
  color: var(--text-primary);
}

/* Instant press feedback - no transition delay */
.hover-editor-close:active,
.hover-editor-minimize:active {
  transform: scale(0.85) translateZ(0);
  opacity: 0.7;
}

/* ============================================================ */
/* Minimized Windows Bar */
/* ============================================================ */

.minimized-windows-bar {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  height: 36px;
  background-color: var(--bg-primary);
  border-top: 1px solid var(--border-color);
  display: flex;
  align-items: center;
  padding: 0 8px;
  gap: 8px;
  z-index: 10000;
  overflow-x: auto;
}

.minimized-window-item {
  display: flex;
  align-items: center;
  background-color: var(--bg-tertiary);
  border-radius: 4px;
  padding: 0 4px 0 8px;
  height: 28px;
  max-width: 180px;
  min-width: 80px;
  gap: 4px;
}

.minimized-window-btn {
  display: flex;
  align-items: center;
  gap: 6px;
  background: none;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  font-size: 12px;
  padding: 0;
  overflow: hidden;
  flex: 1;
}

.minimized-window-btn:hover {
  color: var(--text-primary);
}

.minimized-window-icon {
  font-size: 14px;
  flex-shrink: 0;
}

.minimized-window-name {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.minimized-window-close {
  background: none;
  border: none;
  color: var(--text-muted);
  cursor: pointer;
  font-size: 14px;
  padding: 2px 4px;
  line-height: 1;
  flex-shrink: 0;
}

.minimized-window-close:hover {
  color: #e74856;
}

/* Minimized Window Template Type Colors */
.minimized-window-item.note-type { background: linear-gradient(to right, var(--note-bg) 0%, var(--bg-tertiary) 30%); }
.minimized-window-item.sketch-type { background: linear-gradient(to right, var(--sketch-bg) 0%, var(--bg-tertiary) 30%); }
.minimized-window-item.mtg-type { background: linear-gradient(to right, var(--mtg-bg) 0%, var(--bg-tertiary) 30%); }
.minimized-window-item.sem-type { background: linear-gradient(to right, var(--sem-bg) 0%, var(--bg-tertiary) 30%); }
.minimized-window-item.event-type { background: linear-gradient(to right, var(--event-bg) 0%, var(--bg-tertiary) 30%); }
.minimized-window-item.ofa-type { background: linear-gradient(to right, var(--ofa-bg) 0%, var(--bg-tertiary) 30%); }
.minimized-window-item.paper-type { background: linear-gradient(to right, var(--paper-bg) 0%, var(--bg-tertiary) 30%); }
.minimized-window-item.lit-type { background: linear-gradient(to right, var(--lit-bg) 0%, var(--bg-tertiary) 30%); }
.minimized-window-item.data-type { background: linear-gradient(to right, var(--data-bg) 0%, var(--bg-tertiary) 30%); }
.minimized-window-item.theo-type { background: linear-gradient(to right, var(--theo-bg) 0%, var(--bg-tertiary) 30%); }
.minimized-window-item.contact-type { background: linear-gradient(to right, var(--contact-bg) 0%, var(--bg-tertiary) 30%); }
.minimized-window-item.setup-type { background: linear-gradient(to right, var(--setup-bg) 0%, var(--bg-tertiary) 30%); }

/* Minimized Window Icon - reuse template selector icon styles */
.minimized-window-icon.template-selector-icon {
  width: 14px;
  height: 14px;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
}

/* ============================================================ */
/* Hover Windows Panel */
/* ============================================================ */

.hover-windows-panel {
  display: flex;
  flex-direction: column;
  height: 100%;
  background-color: var(--bg-primary);
  border-left: 1px solid var(--border-color);
  flex-shrink: 0;
}

.hover-windows-panel-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 8px 12px;
  background-color: var(--bg-secondary);
  border-bottom: 1px solid var(--border-color);
}

.hover-windows-panel-header-left {
  display: flex;
  align-items: center;
  gap: 8px;
}

.hover-windows-panel-title {
  font-size: 13px;
  font-weight: 600;
  color: var(--text-primary);
}

.hover-windows-panel-count {
  font-size: 11px;
  font-weight: 600;
  background: rgba(100, 150, 255, 0.2);
  color: #a0c4ff;
  padding: 2px 8px;
  border-radius: 10px;
}

.hover-windows-panel-close {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  background: none;
  border: none;
  border-radius: 4px;
  color: var(--text-muted);
  cursor: pointer;
  transition: all 0.15s ease;
}

.hover-windows-panel-close:hover {
  background-color: var(--bg-hover);
  color: var(--text-primary);
}

.hover-windows-panel-content {
  flex: 1;
  overflow-y: auto;
  padding: 8px 0;
}

.hover-windows-section {
  margin-bottom: 12px;
}

.hover-windows-section-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 4px 16px;
  margin-bottom: 4px;
}

.hover-windows-section-title {
  font-size: 11px;
  font-weight: 500;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.hover-windows-section-count {
  font-size: 10px;
  color: var(--text-muted);
}

.hover-windows-list {
  display: flex;
  flex-direction: column;
}

.hover-window-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 6px 12px 6px 16px;
  transition: background 0.12s ease, opacity 0.12s ease, border-color 0.12s ease;
  position: relative;
  border-left: 3px solid transparent;
  /* Entrance animation */
  animation: hoverItemSlideIn 0.2s cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

@keyframes hoverItemSlideIn {
  from {
    opacity: 0;
    transform: translateX(10px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

/* Minimized state - low opacity */
.hover-window-item.minimized {
  opacity: 0.5;
}

.hover-window-item.minimized:hover {
  background: rgba(255, 255, 255, 0.03);
  opacity: 0.7;
}

/* Active state - medium opacity, subtle highlight */
.hover-window-item.active {
  opacity: 0.85;
}

.hover-window-item.active:hover {
  background: rgba(255, 255, 255, 0.05);
}

/* Focused state - full opacity, highlighted border */
.hover-window-item.focused {
  opacity: 1;
  border-left-color: rgba(100, 150, 255, 0.8);
  background: rgba(100, 150, 255, 0.08);
}

.hover-window-item.focused:hover {
  background: rgba(100, 150, 255, 0.12);
}

.hover-window-item-btn {
  display: flex;
  align-items: center;
  gap: 8px;
  flex: 1;
  background: none;
  border: none;
  padding: 4px 0;
  cursor: pointer;
  text-align: left;
  min-width: 0;
  /* Click optimization */
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
  transition: transform 0.1s ease;
  will-change: transform;
}

.hover-window-item-btn:active {
  transform: scale(0.98);
}

.hover-window-item-icon {
  flex-shrink: 0;
  width: 16px;
  height: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.hover-window-item-icon.template-selector-icon {
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
}

.hover-window-item-icon.emoji-icon {
  font-size: 14px;
}

.hover-window-item-icon.lucide-icon {
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-secondary);
}

.hover-window-item-btn:hover .hover-window-item-icon.lucide-icon {
  color: var(--text-primary);
}

.hover-window-item-name {
  flex: 1;
  font-size: 12px;
  color: var(--text-secondary);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.hover-window-item-btn:hover .hover-window-item-name {
  color: var(--text-primary);
}

.hover-window-item-actions {
  display: flex;
  align-items: center;
  gap: 2px;
  opacity: 0;
  transition: opacity 0.15s ease;
}

.hover-window-item:hover .hover-window-item-actions {
  opacity: 1;
}

.hover-window-item-action {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 22px;
  height: 22px;
  background: none;
  border: none;
  border-radius: 4px;
  color: var(--text-muted);
  cursor: pointer;
  transition: all 0.1s ease;
  /* GPU acceleration */
  will-change: transform;
  transform: translateZ(0);
}

.hover-window-item-action:hover {
  background: var(--bg-hover);
  color: var(--text-primary);
}

/* Instant press feedback */
.hover-window-item-action:active {
  transform: scale(0.85) translateZ(0);
  opacity: 0.7;
}

.hover-window-item-action.hover-window-item-close:hover {
  background: rgba(232, 72, 85, 0.2);
  color: #e84855;
}

/* Hover Window Item Template Type Colors */
.hover-window-item.note-type { background: linear-gradient(to right, var(--note-bg) 0%, transparent 50%); }
.hover-window-item.sketch-type { background: linear-gradient(to right, var(--sketch-bg) 0%, transparent 50%); }
.hover-window-item.mtg-type { background: linear-gradient(to right, var(--mtg-bg) 0%, transparent 50%); }
.hover-window-item.sem-type { background: linear-gradient(to right, var(--sem-bg) 0%, transparent 50%); }
.hover-window-item.event-type { background: linear-gradient(to right, var(--event-bg) 0%, transparent 50%); }
.hover-window-item.ofa-type { background: linear-gradient(to right, var(--ofa-bg) 0%, transparent 50%); }
.hover-window-item.paper-type { background: linear-gradient(to right, var(--paper-bg) 0%, transparent 50%); }
.hover-window-item.lit-type { background: linear-gradient(to right, var(--lit-bg) 0%, transparent 50%); }
.hover-window-item.data-type { background: linear-gradient(to right, var(--data-bg) 0%, transparent 50%); }
.hover-window-item.theo-type { background: linear-gradient(to right, var(--theo-bg) 0%, transparent 50%); }
.hover-window-item.contact-type { background: linear-gradient(to right, var(--contact-bg) 0%, transparent 50%); }
.hover-window-item.setup-type { background: linear-gradient(to right, var(--setup-bg) 0%, transparent 50%); }

.hover-window-item.note-type:hover { background: linear-gradient(to right, var(--note-bg-hover) 0%, var(--bg-hover-rgba) 60%); }
.hover-window-item.sketch-type:hover { background: linear-gradient(to right, var(--sketch-bg-hover) 0%, var(--bg-hover-rgba) 60%); }
.hover-window-item.mtg-type:hover { background: linear-gradient(to right, var(--mtg-bg-hover) 0%, var(--bg-hover-rgba) 60%); }
.hover-window-item.sem-type:hover { background: linear-gradient(to right, var(--sem-bg-hover) 0%, var(--bg-hover-rgba) 60%); }
.hover-window-item.event-type:hover { background: linear-gradient(to right, var(--event-bg-hover) 0%, var(--bg-hover-rgba) 60%); }
.hover-window-item.ofa-type:hover { background: linear-gradient(to right, var(--ofa-bg-hover) 0%, var(--bg-hover-rgba) 60%); }
.hover-window-item.paper-type:hover { background: linear-gradient(to right, var(--paper-bg-hover) 0%, var(--bg-hover-rgba) 60%); }
.hover-window-item.lit-type:hover { background: linear-gradient(to right, var(--lit-bg-hover) 0%, var(--bg-hover-rgba) 60%); }
.hover-window-item.data-type:hover { background: linear-gradient(to right, var(--data-bg-hover) 0%, var(--bg-hover-rgba) 60%); }
.hover-window-item.theo-type:hover { background: linear-gradient(to right, var(--theo-bg-hover) 0%, var(--bg-hover-rgba) 60%); }
.hover-window-item.contact-type:hover { background: linear-gradient(to right, var(--contact-bg-hover) 0%, var(--bg-hover-rgba) 60%); }
.hover-window-item.setup-type:hover { background: linear-gradient(to right, var(--setup-bg-hover) 0%, var(--bg-hover-rgba) 60%); }

.hover-windows-empty {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 24px 16px;
  color: var(--text-muted);
  font-size: 12px;
}

.hover-editor-frontmatter {
  padding: 8px 12px;
  background-color: var(--bg-hover);
  border-bottom: 1px solid var(--border-color);
  font-family: "Consolas", "Monaco", monospace;
  font-size: 11px;
  max-height: 150px;
  overflow-y: auto;
  flex-shrink: 0;
}

.hover-editor-body {
  flex: 1;
  overflow-y: auto;
  border-bottom-left-radius: 6px;
  border-bottom-right-radius: 6px;
}

/* Skeleton Loading UI */
.hover-editor-skeleton {
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.skeleton-line {
  height: 16px;
  background: linear-gradient(90deg, #2a2a3a 25%, #3a3a4a 50%, #2a2a3a 75%);
  background-size: 200% 100%;
  animation: skeleton-shimmer 1.5s infinite;
  border-radius: 4px;
}

.skeleton-title {
  width: 60%;
  height: 24px;
  margin-bottom: 8px;
}

.skeleton-full {
  width: 100%;
}

.skeleton-medium {
  width: 75%;
}

.skeleton-short {
  width: 40%;
}

@keyframes skeleton-shimmer {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

html[data-theme="light"] .skeleton-line {
  background: linear-gradient(90deg, #e8e8e8 25%, #f5f5f5 50%, #e8e8e8 75%);
  background-size: 200% 100%;
}

/* Disable interactions during drag/resize for performance */
.hover-editor.is-dragging .hover-editor-body,
.hover-editor.is-resizing .hover-editor-body {
  pointer-events: none !important;
}

/* Note Type Background Colors */
.hover-editor-body.note-type { background-color: var(--note-bg); }
.hover-editor-body.mtg-type { background-color: var(--mtg-bg); }
.hover-editor-body.adm-type { background-color: var(--adm-bg); }
.hover-editor-body.sem-type { background-color: var(--sem-bg); }
.hover-editor-body.task-type { background-color: var(--task-bg); }
.hover-editor-body.contact-type { background-color: var(--contact-bg); }
.hover-editor-body.setup-type { background-color: var(--setup-bg); }
.hover-editor-body.data-type { background-color: var(--data-bg); }
.hover-editor-body.theo-type { background-color: var(--theo-bg); }
.hover-editor-body.paper-type { background-color: var(--paper-bg); }
.hover-editor-body.event-type { background-color: var(--event-bg); }
.hover-editor-body.ofa-type { background-color: var(--ofa-bg); }
.hover-editor-body.lit-type { background-color: var(--lit-bg); }

.hover-editor-body .tiptap-editor {
  padding: 12px 16px;
  max-width: none;
  min-height: 100%;
}

.hover-editor-resize {
  position: absolute;
  bottom: 0;
  right: 0;
  width: 16px;
  height: 16px;
  cursor: se-resize;
}

.hover-editor-resize::after {
  content: '';
  position: absolute;
  bottom: 4px;
  right: 4px;
  width: 8px;
  height: 8px;
  border-right: 2px solid #555;
  border-bottom: 2px solid #555;
}

.hover-editor-search-section {
  border-top: 1px solid var(--border-color);
  flex: 1;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.hover-editor-search-section .search-container {
  border: none;
  background: transparent;
}

/* ============================================================ */
/* Sync Status Indicator */
/* ============================================================ */

.sync-status-indicator {
  font-size: 8px;
  margin: 0 6px;
  flex-shrink: 0;
  line-height: 1;
  user-select: none;
}

.sync-status-synced { color: #4ade80; }
.sync-status-editing { color: #60a5fa; animation: pulse-dot 1.5s ease-in-out infinite; }
.sync-status-conflict { color: #eab308; animation: pulse-dot 0.8s ease-in-out infinite; }
.sync-status-editing-elsewhere { color: #f97316; }

@keyframes pulse-dot {
  0%, 100% { opacity: 0.4; }
  50% { opacity: 1; }
}

/* ============================================================ */
/* Conflict Resolution Bar */
/* ============================================================ */

.hover-editor-conflict-bar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 6px 12px;
  background: linear-gradient(90deg, rgba(234, 179, 8, 0.15), rgba(234, 179, 8, 0.08));
  border-bottom: 1px solid rgba(234, 179, 8, 0.3);
  flex-shrink: 0;
  gap: 8px;
  animation: conflict-bar-enter 0.2s ease-out;
}

@keyframes conflict-bar-enter {
  from { opacity: 0; transform: translateY(-100%); }
  to { opacity: 1; transform: translateY(0); }
}

.conflict-bar-message {
  font-size: 12px;
  color: #eab308;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.conflict-bar-actions {
  display: flex;
  gap: 6px;
  flex-shrink: 0;
}

.conflict-btn {
  font-size: 11px;
  padding: 3px 8px;
  border-radius: 4px;
  border: 1px solid transparent;
  cursor: pointer;
  white-space: nowrap;
}

.conflict-btn.accept-external {
  background: rgba(96, 165, 250, 0.15);
  color: #60a5fa;
  border-color: rgba(96, 165, 250, 0.3);
}

.conflict-btn.keep-mine {
  background: rgba(234, 179, 8, 0.15);
  color: #eab308;
  border-color: rgba(234, 179, 8, 0.3);
}

.conflict-btn.save-both {
  background: rgba(74, 222, 128, 0.15);
  color: #4ade80;
  border-color: rgba(74, 222, 128, 0.3);
}

.conflict-btn:hover {
  filter: brightness(1.2);
}

/* ============================================================ */
/* Hover Editor Conflict Copy Bar                               */
/* ============================================================ */

.hover-editor-conflict-copy-bar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 6px 12px;
  background: linear-gradient(90deg, rgba(168, 85, 247, 0.15), rgba(168, 85, 247, 0.08));
  border-bottom: 1px solid rgba(168, 85, 247, 0.3);
  flex-shrink: 0;
  gap: 8px;
  animation: conflict-bar-enter 0.2s ease-out;
}

.conflict-copy-bar-message {
  font-size: 12px;
  color: #a855f7;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.conflict-copy-bar-actions {
  display: flex;
  gap: 6px;
  flex-shrink: 0;
}

.conflict-copy-btn {
  font-size: 11px;
  padding: 3px 8px;
  border-radius: 4px;
  border: 1px solid transparent;
  cursor: pointer;
  white-space: nowrap;
}

.conflict-copy-btn.replace-original {
  background: rgba(234, 179, 8, 0.15);
  color: #eab308;
  border-color: rgba(234, 179, 8, 0.3);
}

.conflict-copy-btn.keep-original {
  background: rgba(96, 165, 250, 0.15);
  color: #60a5fa;
  border-color: rgba(96, 165, 250, 0.3);
}

.conflict-copy-btn.keep-both {
  background: rgba(74, 222, 128, 0.15);
  color: #4ade80;
  border-color: rgba(74, 222, 128, 0.3);
}

.conflict-copy-btn:hover {
  filter: brightness(1.2);
}

/* ============================================================ */
/* Hover Editor Sync Bar */
/* ============================================================ */

.hover-editor-sync-bar {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 4px 12px;
  background: rgba(232, 168, 56, 0.08);
  border-bottom: 1px solid rgba(232, 168, 56, 0.2);
  font-size: 11px;
  color: #e8a838;
  flex-shrink: 0;
}

.sync-bar-spinner {
  display: inline-block;
  animation: spin-slow 1.5s linear infinite;
}

@keyframes spin-slow {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* ============================================================ */
/* Backlinks Panel */
/* ============================================================ */

.backlinks-panel {
  border-top: 1px solid var(--border-color);
  flex-shrink: 0;
  max-height: 200px;
  overflow-y: auto;
}

.backlinks-header {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 6px 12px;
  cursor: pointer;
  user-select: none;
  font-size: 12px;
  color: var(--text-muted);
  background-color: var(--bg-secondary);
}

.backlinks-header:hover {
  background-color: var(--bg-hover);
}

.backlinks-toggle {
  font-size: 10px;
  width: 12px;
}

.backlinks-title {
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.backlinks-count {
  margin-left: auto;
  background-color: var(--bg-hover);
  padding: 0 6px;
  border-radius: 8px;
  font-size: 10px;
}

.backlinks-list {
  padding: 4px 0;
}

.backlinks-empty {
  padding: 8px 16px;
  font-size: 12px;
  color: var(--text-muted);
}

.backlink-item {
  display: flex;
  flex-direction: column;
  padding: 4px 16px;
  cursor: pointer;
  gap: 2px;
}

.backlink-item:hover {
  background-color: var(--bg-hover);
}

.backlink-file-name {
  font-size: 12px;
  color: #007acc;
  font-weight: 500;
}

.backlink-context {
  font-size: 11px;
  color: var(--text-muted);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.backlinks-section {
  padding: 4px 0;
}

.backlinks-section-title {
  font-size: 11px;
  color: var(--text-muted);
  padding: 2px 8px;
  font-weight: 500;
}

/* ============================================================ */
/* Relationship Panel */
/* ============================================================ */

.relationship-panel {
  border-top: 1px solid var(--border-color);
  margin-top: 8px;
}

.relationship-header {
  padding: 6px 12px;
  background-color: var(--bg-secondary);
}

.relationship-title {
  font-size: 11px;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.relationship-content {
  padding: 4px 0;
}

.relationship-section {
  padding: 4px 0;
}

.relationship-section-title {
  font-size: 11px;
  color: var(--text-muted);
  padding: 2px 12px;
}

.relationship-item {
  display: flex;
  flex-direction: column;
  padding: 4px 16px;
  cursor: pointer;
}

.relationship-item:hover {
  background-color: var(--bg-hover);
}

.relationship-link-name {
  font-size: 12px;
  color: #007acc;
}

.relationship-context {
  font-size: 11px;
  color: var(--text-muted);
  margin-top: 2px;
}

/* ============================================================ */
/* Settings Modal */
/* ============================================================ */

.settings-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 5000;
}

.settings-modal {
  background-color: var(--bg-secondary, #2d2d2d);
  border: 1px solid var(--border-color, #3c3c3c);
  border-radius: 8px;
  width: 900px;
  height: 700px;
  max-height: 85vh;
  display: flex;
  flex-direction: column;
  box-shadow: 0 8px 32px var(--shadow-color, rgba(0, 0, 0, 0.4));
}

.settings-modal-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px 20px;
  border-bottom: 1px solid var(--border-color, #3c3c3c);
}

.settings-modal-title {
  font-size: 16px;
  font-weight: 600;
  color: var(--text-primary, #e0e0e0);
}

.settings-modal-close {
  width: 28px;
  height: 28px;
  border: none;
  background: transparent;
  color: #999999;
  font-size: 20px;
  cursor: pointer;
  border-radius: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
}

.settings-modal-close:hover {
  background-color: var(--bg-hover, #3c3c3c);
  color: var(--text-primary, #ffffff);
}

.settings-modal-content {
  display: flex;
  flex: 1;
  overflow: hidden;
}

.settings-tabs {
  display: flex;
  flex-direction: column;
  width: 120px;
  background-color: var(--bg-primary, #252526);
  border-right: 1px solid var(--border-color, #3c3c3c);
  padding: 8px 0;
  flex-shrink: 0;
}

.settings-tab {
  padding: 8px 16px;
  font-size: 13px;
  color: var(--text-muted, #999999);
  background: transparent;
  border: none;
  text-align: left;
  cursor: pointer;
  border-left: 2px solid transparent;
}

.settings-tab:hover {
  color: var(--text-primary, #e0e0e0);
  background-color: var(--bg-hover, #2a2d2e);
}

.settings-tab.active {
  color: var(--text-primary, #ffffff);
  border-left-color: var(--accent-color, #007acc);
  background-color: var(--bg-hover, #2a2d2e);
}

.settings-tab-content {
  flex: 1;
  overflow-y: auto;
  padding: 16px 20px;
}

/* Settings modal scrollbar styling */
.settings-tab-content::-webkit-scrollbar {
  width: 8px;
}

.settings-tab-content::-webkit-scrollbar-track {
  background: var(--bg-tertiary, #1e1e1e);
  border-radius: 4px;
}

.settings-tab-content::-webkit-scrollbar-thumb {
  background: var(--border-color, #3c3c3c);
  border-radius: 4px;
}

.settings-tab-content::-webkit-scrollbar-thumb:hover {
  background: var(--text-muted, #666666);
}

.settings-section {
  margin-bottom: 20px;
}

.settings-section:last-child {
  margin-bottom: 0;
}

.settings-section-title {
  font-size: 12px;
  font-weight: 600;
  text-transform: uppercase;
  color: var(--text-muted, #888888);
  letter-spacing: 0.5px;
  margin-bottom: 10px;
}

.settings-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 8px 0;
}

/* Settings Template Row Type Colors */
.settings-row.note-type {
  border-left: 3px solid var(--note-color);
  padding-left: 8px;
  background: linear-gradient(to right, var(--note-bg) 0%, transparent 40%);
  border-radius: 4px;
}
.settings-row.sketch-type {
  border-left: 3px solid var(--sketch-color);
  padding-left: 8px;
  background: linear-gradient(to right, var(--sketch-bg) 0%, transparent 40%);
  border-radius: 4px;
}
.settings-row.mtg-type {
  border-left: 3px solid var(--mtg-color);
  padding-left: 8px;
  background: linear-gradient(to right, var(--mtg-bg) 0%, transparent 40%);
  border-radius: 4px;
}
.settings-row.sem-type {
  border-left: 3px solid var(--sem-color);
  padding-left: 8px;
  background: linear-gradient(to right, var(--sem-bg) 0%, transparent 40%);
  border-radius: 4px;
}
.settings-row.event-type {
  border-left: 3px solid var(--event-color);
  padding-left: 8px;
  background: linear-gradient(to right, var(--event-bg) 0%, transparent 40%);
  border-radius: 4px;
}
.settings-row.ofa-type {
  border-left: 3px solid var(--ofa-color);
  padding-left: 8px;
  background: linear-gradient(to right, var(--ofa-bg) 0%, transparent 40%);
  border-radius: 4px;
}
.settings-row.paper-type {
  border-left: 3px solid var(--paper-color);
  padding-left: 8px;
  background: linear-gradient(to right, var(--paper-bg) 0%, transparent 40%);
  border-radius: 4px;
}
.settings-row.lit-type {
  border-left: 3px solid var(--lit-color);
  padding-left: 8px;
  background: linear-gradient(to right, var(--lit-bg) 0%, transparent 40%);
  border-radius: 4px;
}
.settings-row.data-type {
  border-left: 3px solid var(--data-color);
  padding-left: 8px;
  background: linear-gradient(to right, var(--data-bg) 0%, transparent 40%);
  border-radius: 4px;
}
.settings-row.theo-type {
  border-left: 3px solid var(--theo-color);
  padding-left: 8px;
  background: linear-gradient(to right, var(--theo-bg) 0%, transparent 40%);
  border-radius: 4px;
}
.settings-row.contact-type {
  border-left: 3px solid var(--contact-color);
  padding-left: 8px;
  background: linear-gradient(to right, var(--contact-bg) 0%, transparent 40%);
  border-radius: 4px;
}
.settings-row.setup-type {
  border-left: 3px solid var(--setup-color);
  padding-left: 8px;
  background: linear-gradient(to right, var(--setup-bg) 0%, transparent 40%);
  border-radius: 4px;
}

.settings-row-info {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.settings-row-label {
  font-size: 13px;
  color: var(--text-primary, #e0e0e0);
}

.settings-row-value {
  font-size: 11px;
  color: var(--text-muted, #888888);
  word-break: break-all;
}

.settings-row-desc {
  font-size: 11px;
  color: var(--text-muted, #666666);
}

.settings-action-btn {
  padding: 4px 12px;
  font-size: 12px;
  background-color: var(--bg-tertiary, #3c3c3c);
  border: 1px solid var(--border-light, #5a5a5a);
  border-radius: 4px;
  color: var(--text-primary, #e0e0e0);
  cursor: pointer;
  flex-shrink: 0;
}

.settings-action-btn:hover {
  background-color: var(--bg-hover, #4a4a4a);
}

.settings-toggle-btn {
  padding: 4px 12px;
  font-size: 12px;
  background-color: var(--bg-tertiary, #3c3c3c);
  border: 1px solid var(--border-light, #5a5a5a);
  border-radius: 4px;
  color: var(--text-muted, #888888);
  cursor: pointer;
  flex-shrink: 0;
}

.settings-toggle-btn.active {
  background-color: var(--accent-color, #007acc);
  border-color: var(--accent-color, #007acc);
  color: #ffffff;
}

.settings-size-inputs {
  display: flex;
  align-items: center;
  gap: 6px;
}

.settings-size-input {
  width: 70px;
  padding: 4px 6px;
  font-size: 12px;
  background-color: var(--bg-tertiary, #3c3c3c);
  border: 1px solid var(--border-light, #5a5a5a);
  border-radius: 4px;
  color: var(--text-primary, #e0e0e0);
  text-align: center;
}

.settings-size-input:focus {
  outline: none;
  border-color: var(--accent-color, #007acc);
}

.settings-size-separator {
  color: var(--text-muted, #888);
  font-size: 12px;
}

.settings-select {
  padding: 4px 8px;
  font-size: 12px;
  background-color: var(--bg-tertiary, #3c3c3c);
  border: 1px solid var(--border-light, #5a5a5a);
  border-radius: 4px;
  color: var(--text-primary, #e0e0e0);
  cursor: pointer;
  outline: none;
}

.settings-select:focus {
  border-color: var(--accent-color, #007acc);
}

.settings-section-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 10px;
}

.settings-section-header .settings-section-title {
  margin-bottom: 0;
}

/* Template Styles */
.template-add-btn {
  width: 24px;
  height: 24px;
  border: 1px solid var(--border-light, #5a5a5a);
  background: var(--bg-tertiary, #3c3c3c);
  color: var(--text-primary, #e0e0e0);
  border-radius: 4px;
  cursor: pointer;
  font-size: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
}

.template-add-btn:hover {
  background-color: var(--bg-hover, #4a4a4a);
}

/* Custom Fonts List */
.custom-fonts-list {
  margin-top: 8px;
  padding: 8px;
  background-color: var(--bg-tertiary, #2d2d2d);
  border-radius: 6px;
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.custom-font-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 8px 12px;
  background-color: var(--bg-elevated, #333);
  border-radius: 4px;
  border: 1px solid var(--border-color, #444);
}

.custom-font-name {
  font-size: 13px;
  color: var(--text-primary, #e0e0e0);
  flex: 1;
}

.custom-font-family {
  font-size: 11px;
  color: var(--text-muted, #888);
  font-family: monospace;
}

.custom-font-remove {
  width: 20px;
  height: 20px;
  border: none;
  background: transparent;
  color: var(--text-muted, #888);
  font-size: 16px;
  cursor: pointer;
  border-radius: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.custom-font-remove:hover {
  background-color: #f87171;
  color: #fff;
}

/* Add Font Modal */
.settings-modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 6000;
}

.add-font-modal {
  background-color: var(--bg-secondary, #242424);
  border: 1px solid var(--border-color, #444);
  border-radius: 8px;
  padding: 20px;
  width: 400px;
  box-shadow: 0 8px 32px var(--shadow-color, rgba(0, 0, 0, 0.4));
}

.add-font-modal h3 {
  margin: 0 0 16px 0;
  font-size: 16px;
  color: var(--text-primary, #e0e0e0);
}

.add-font-form {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.add-font-form label {
  display: flex;
  flex-direction: column;
  gap: 4px;
  font-size: 12px;
  color: var(--text-secondary, #aaa);
}

.add-font-form input {
  padding: 8px 12px;
  font-size: 13px;
  background-color: var(--bg-tertiary, #2d2d2d);
  border: 1px solid var(--border-color, #444);
  border-radius: 4px;
  color: var(--text-primary, #e0e0e0);
  outline: none;
}

.add-font-form input:focus {
  border-color: var(--accent-color, #00d4aa);
}

.add-font-form input::placeholder {
  color: var(--text-muted, #888);
}

.add-font-note {
  font-size: 11px;
  color: var(--text-muted, #888);
  margin: 4px 0;
}

.add-font-help {
  background-color: var(--bg-tertiary, #2d2d2d);
  border: 1px solid var(--border-color, #444);
  border-radius: 6px;
  padding: 12px;
  margin-top: 4px;
}

.add-font-help-title {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-primary);
  margin: 0 0 8px 0;
}

.add-font-help-list {
  margin: 0 0 10px 0;
  padding-left: 18px;
  font-size: 11px;
  color: var(--text-secondary);
  line-height: 1.6;
}

.add-font-help-list li {
  margin-bottom: 4px;
}

.add-font-help-list strong {
  color: var(--text-primary);
}

.add-font-help-example {
  font-size: 11px;
  color: var(--text-secondary);
  margin: 0 0 6px 0;
}

.add-font-example-list {
  margin: 0;
  padding-left: 18px;
  font-size: 11px;
  color: var(--text-muted);
}

.add-font-example-list li {
  margin-bottom: 2px;
}

.add-font-example-list code {
  background-color: var(--bg-secondary, #252525);
  padding: 2px 6px;
  border-radius: 3px;
  font-family: "Consolas", "Monaco", monospace;
  color: var(--accent-color);
}

.add-font-actions {
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  margin-top: 8px;
}

.add-font-actions button {
  padding: 8px 16px;
  font-size: 13px;
  border-radius: 4px;
  cursor: pointer;
  border: 1px solid var(--border-color, #444);
  background-color: var(--bg-tertiary, #2d2d2d);
  color: var(--text-primary, #e0e0e0);
}

.add-font-actions button:hover {
  background-color: var(--bg-hover, #3a3a3a);
}

.add-font-actions button.primary {
  background-color: var(--accent-color, #00d4aa);
  border-color: var(--accent-color, #00d4aa);
  color: #000;
}

.add-font-actions button.primary:hover {
  background-color: var(--accent-hover, #00e5bb);
}

/* Template Grid Layout */
.template-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 12px;
  margin-top: 12px;
}

.settings-section-desc {
  font-size: 12px;
  color: var(--text-muted, #888);
  margin: 0;
}

/* Template Card */
.template-card {
  display: flex;
  flex-direction: column;
  background: var(--bg-tertiary, #252530);
  border: 1px solid var(--border-color, #3c3c3c);
  border-radius: 8px;
  padding: 12px;
  transition: all 0.2s ease;
  position: relative;
  overflow: hidden;
}

.template-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: var(--note-color);
  opacity: 0.8;
}

.template-card.note-type::before { background: var(--note-color); }
.template-card.sketch-type::before { background: var(--sketch-color); }
.template-card.mtg-type::before { background: var(--mtg-color); }
.template-card.sem-type::before { background: var(--sem-color); }
.template-card.event-type::before { background: var(--event-color); }
.template-card.ofa-type::before { background: var(--ofa-color); }
.template-card.paper-type::before { background: var(--paper-color); }
.template-card.lit-type::before { background: var(--lit-color); }
.template-card.data-type::before { background: var(--data-color); }
.template-card.theo-type::before { background: var(--theo-color); }
.template-card.contact-type::before { background: var(--contact-color); }
.template-card.setup-type::before { background: var(--setup-color); }
.template-card.has-custom-color::before { background: var(--template-color); }

.template-card:hover {
  border-color: var(--border-light, #4a4a4a);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

.template-card.template-disabled {
  opacity: 0.5;
}

.template-card.template-disabled::before {
  filter: grayscale(0.7);
}

.template-card-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 10px;
}

.template-card-checkbox {
  display: flex;
  align-items: center;
  cursor: pointer;
}

.template-card-checkbox input[type="checkbox"] {
  width: 16px;
  height: 16px;
  accent-color: var(--accent, #00ffd5);
  cursor: pointer;
}

.template-card-icon {
  width: 28px;
  height: 28px;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  background-size: 16px 16px;
  background-position: center;
  background-repeat: no-repeat;
}

.template-card-icon.icon-note { background-color: var(--note-color); }
.template-card-icon.icon-sketch { background-color: var(--sketch-color); }
.template-card-icon.icon-mtg { background-color: var(--mtg-color); }
.template-card-icon.icon-sem { background-color: var(--sem-color); }
.template-card-icon.icon-event { background-color: var(--event-color); }
.template-card-icon.icon-ofa { background-color: var(--ofa-color); }
.template-card-icon.icon-paper { background-color: var(--paper-color); }
.template-card-icon.icon-lit { background-color: var(--lit-color); }
.template-card-icon.icon-data { background-color: var(--data-color); }
.template-card-icon.icon-theo { background-color: var(--theo-color); }
.template-card-icon.icon-contact { background-color: var(--contact-color); }
.template-card-icon.icon-setup { background-color: var(--setup-color); }

.template-card-body {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.template-card-title-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
}

.template-card-name {
  font-size: 13px;
  font-weight: 600;
  color: var(--text-primary, #e0e0e0);
}

.template-card-prefix {
  font-size: 9px;
  font-weight: 700;
  color: var(--note-color);
  border: 1px solid var(--note-color);
  padding: 1px 5px;
  border-radius: 3px;
  opacity: 0.8;
}

.template-card.note-type .template-card-prefix { color: var(--note-color); border-color: var(--note-color); }
.template-card.sketch-type .template-card-prefix { color: var(--sketch-color); border-color: var(--sketch-color); }
.template-card.mtg-type .template-card-prefix { color: var(--mtg-color); border-color: var(--mtg-color); }
.template-card.sem-type .template-card-prefix { color: var(--sem-color); border-color: var(--sem-color); }
.template-card.event-type .template-card-prefix { color: var(--event-color); border-color: var(--event-color); }
.template-card.ofa-type .template-card-prefix { color: var(--ofa-color); border-color: var(--ofa-color); }
.template-card.paper-type .template-card-prefix { color: var(--paper-color); border-color: var(--paper-color); }
.template-card.lit-type .template-card-prefix { color: var(--lit-color); border-color: var(--lit-color); }
.template-card.data-type .template-card-prefix { color: var(--data-color); border-color: var(--data-color); }
.template-card.theo-type .template-card-prefix { color: var(--theo-color); border-color: var(--theo-color); }
.template-card.contact-type .template-card-prefix { color: var(--contact-color); border-color: var(--contact-color); }
.template-card.setup-type .template-card-prefix { color: var(--setup-color); border-color: var(--setup-color); }

.template-card-desc {
  font-size: 11px;
  color: var(--text-muted, #888);
  margin: 0;
  line-height: 1.4;
}

.template-card-footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-top: 10px;
  min-height: 24px;
}

.template-card-badge {
  font-size: 10px;
  color: var(--text-tertiary, #6b7280);
  background-color: var(--bg-hover, #2a2a2a);
  padding: 2px 8px;
  border-radius: 10px;
}

.template-card-actions {
  display: flex;
  gap: 4px;
  margin-left: auto;
}

.template-card-action-btn {
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--bg-hover, #2a2a2a);
  border: 1px solid var(--border-color, #3c3c3c);
  border-radius: 4px;
  color: var(--text-secondary, #aaa);
  cursor: pointer;
  transition: all 0.15s;
}

.template-card-action-btn:hover {
  background: var(--bg-secondary, #333);
  color: var(--text-primary, #e0e0e0);
}

.template-card-action-btn.delete:hover {
  background: rgba(244, 135, 113, 0.15);
  border-color: #f48771;
  color: #f48771;
}

/* New Add Template Button */
.template-add-btn-v2 {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 6px 12px;
  background: var(--accent, #00ffd5);
  border: none;
  border-radius: 6px;
  color: #1a1a2e;
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.15s;
}

.template-add-btn-v2:hover {
  background: var(--accent-hover, #00e5bb);
  transform: translateY(-1px);
}

.template-add-btn-v2 svg {
  flex-shrink: 0;
}

/* Legacy styles kept for compatibility */
.template-row-actions {
  display: flex;
  gap: 4px;
  flex-shrink: 0;
}

.template-row-checkbox {
  display: flex;
  align-items: center;
  padding-right: 8px;
  cursor: pointer;
}

.template-row-checkbox input[type="checkbox"] {
  width: 16px;
  height: 16px;
  accent-color: var(--accent, #00ffd5);
  cursor: pointer;
}

.template-built-in-label {
  font-size: 10px;
  color: var(--text-tertiary, #6b7280);
  background-color: var(--bg-tertiary, #252530);
  padding: 2px 6px;
  border-radius: 4px;
  margin-left: 8px;
}

.settings-row.template-disabled {
  opacity: 0.5;
}

.settings-row.template-disabled .settings-note-template-prefix {
  filter: grayscale(0.5);
}

.template-delete-btn {
  color: #f48771 !important;
}

.template-editor {
  display: flex;
  flex-direction: column;
  gap: 16px;
  max-height: calc(100vh - 200px);
  overflow-y: auto;
  padding-right: 4px;
}

.template-editor::-webkit-scrollbar {
  width: 6px;
}

.template-editor::-webkit-scrollbar-track {
  background: transparent;
}

.template-editor::-webkit-scrollbar-thumb {
  background: var(--border-light, #3c3c3c);
  border-radius: 3px;
}

.template-editor-header {
  display: flex;
  align-items: center;
  gap: 12px;
  padding-bottom: 16px;
  border-bottom: 1px solid var(--border-color, #3c3c3c);
  margin-bottom: 4px;
  position: sticky;
  top: 0;
  background: var(--bg-secondary, #252530);
  z-index: 1;
}

.template-editor-back-btn {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 14px;
  background-color: var(--bg-tertiary);
  border: 1px solid var(--border-color, #3c3c3c);
  border-radius: 6px;
  color: var(--text-secondary);
  font-size: 13px;
  cursor: pointer;
  transition: all 0.15s;
}

.template-editor-back-btn:hover {
  background-color: var(--bg-hover);
  color: var(--text-primary);
  border-color: var(--border-light);
}

.template-editor-title {
  font-size: 18px;
  font-weight: 600;
  color: var(--text-primary);
  margin: 0;
}

/* Template Editor Sections */
.template-editor-section {
  background: var(--bg-tertiary, #1e1e28);
  border: 1px solid var(--border-color, #3c3c3c);
  border-radius: 8px;
  padding: 16px;
}

.template-editor-section-title {
  font-size: 13px;
  font-weight: 600;
  color: var(--text-primary);
  margin: 0 0 12px 0;
  display: flex;
  align-items: center;
  gap: 8px;
}

.template-editor-section-title svg {
  color: var(--accent, #00ffd5);
}

.template-editor-field {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.template-editor-field + .template-editor-field {
  margin-top: 12px;
}

.template-editor-label {
  font-size: 11px;
  font-weight: 600;
  color: var(--text-muted, #888);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.template-editor-input {
  padding: 10px 12px;
  font-size: 13px;
  background-color: var(--bg-primary, #1a1a2e);
  border: 1px solid var(--border-color, #3c3c3c);
  border-radius: 6px;
  color: var(--text-primary);
  outline: none;
  transition: border-color 0.15s, box-shadow 0.15s;
}

.template-editor-input:focus {
  border-color: var(--accent, #00ffd5);
  box-shadow: 0 0 0 3px rgba(0, 255, 213, 0.1);
}

.template-editor-input::placeholder {
  color: var(--text-tertiary, #555);
}

.template-editor-input-small {
  width: 120px;
}

.template-editor-row {
  display: flex;
  gap: 12px;
}

.template-editor-row .template-editor-field {
  flex: 1;
}

.template-editor-row .template-editor-field:first-child {
  flex: 2;
}

.template-editor-textarea {
  padding: 10px 12px;
  font-size: 13px;
  font-family: "Consolas", "Monaco", monospace;
  background-color: var(--bg-primary, #1a1a2e);
  border: 1px solid var(--border-color, #3c3c3c);
  border-radius: 6px;
  color: var(--text-primary);
  outline: none;
  resize: vertical;
  min-height: 80px;
  transition: border-color 0.15s, box-shadow 0.15s;
}

.template-editor-textarea:focus {
  border-color: var(--accent, #00ffd5);
  box-shadow: 0 0 0 3px rgba(0, 255, 213, 0.1);
}

.template-editor-actions {
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  padding-top: 12px;
  border-top: 1px solid var(--border-color, #3c3c3c);
  margin-top: 8px;
  position: sticky;
  bottom: 0;
  background: var(--bg-secondary, #252530);
  padding-bottom: 4px;
}

.template-editor-cancel-btn {
  padding: 10px 20px;
  font-size: 13px;
  background-color: var(--bg-tertiary);
  border: 1px solid var(--border-color, #3c3c3c);
  border-radius: 6px;
  color: var(--text-secondary);
  cursor: pointer;
  font-weight: 500;
  transition: all 0.15s;
}

.template-editor-cancel-btn:hover {
  background-color: var(--bg-hover);
  color: var(--text-primary);
}

.template-editor-save-btn {
  padding: 10px 24px;
  font-size: 13px;
  background: linear-gradient(135deg, var(--accent, #00ffd5) 0%, #00c4a7 100%);
  border: none;
  border-radius: 6px;
  color: #1a1a2e;
  cursor: pointer;
  font-weight: 600;
  transition: all 0.15s;
}

.template-editor-save-btn:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(0, 255, 213, 0.3);
}

/* Color Theme Picker */
.color-theme-picker {
  display: grid;
  grid-template-columns: repeat(6, 1fr);
  gap: 8px;
  padding: 10px;
  background-color: var(--bg-primary, #1a1a2e);
  border: 1px solid var(--border-color, #3c3c3c);
  border-radius: 8px;
}

.color-theme-swatch {
  position: relative;
  width: 100%;
  aspect-ratio: 1;
  border: 2px solid transparent;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.15s;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
}

.color-theme-swatch:hover {
  transform: scale(1.15);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
}

.color-theme-swatch.selected {
  border-color: #ffffff;
  box-shadow: 0 0 0 3px var(--accent, #00ffd5), 0 4px 12px rgba(0, 0, 0, 0.3);
  transform: scale(1.1);
}

.template-editor-hint {
  font-size: 11px;
  color: var(--text-muted, #666);
  font-style: italic;
  margin-top: 4px;
  display: flex;
  align-items: center;
  gap: 4px;
}

.template-editor-hint::before {
  content: '';
  width: 12px;
  height: 12px;
  background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2'%3E%3Ccircle cx='12' cy='12' r='10'%3E%3C/circle%3E%3Cpath d='M12 16v-4'%3E%3C/path%3E%3Cpath d='M12 8h.01'%3E%3C/path%3E%3C/svg%3E") no-repeat center;
  opacity: 0.7;
}

.template-editor-select {
  width: 100%;
  padding: 6px 10px;
  font-size: 12px;
  background-color: var(--bg-tertiary);
  border: 1px solid var(--border-light);
  border-radius: 4px;
  color: var(--text-primary);
  outline: none;
  cursor: pointer;
}

.template-editor-select:focus {
  border-color: #007acc;
}

/* Icon Selector Grid */
.icon-selector-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 8px;
  padding: 10px;
  background-color: var(--bg-primary, #1a1a2e);
  border: 1px solid var(--border-color, #3c3c3c);
  border-radius: 8px;
}

.icon-selector-option {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
  padding: 10px 8px;
  background-color: transparent;
  border: 2px solid transparent;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.15s;
}

.icon-selector-option:hover {
  background-color: var(--bg-hover, #2a2a2a);
}

.icon-selector-option.selected {
  border-color: var(--accent, #00ffd5);
  background-color: rgba(0, 255, 213, 0.08);
}

.icon-selector-preview {
  width: 28px;
  height: 28px;
  flex-shrink: 0;
  border-radius: 6px;
}

.icon-selector-label {
  font-size: 10px;
  color: var(--text-secondary, #aaa);
  text-align: center;
  white-space: nowrap;
}

.icon-selector-option.selected .icon-selector-label {
  color: var(--text-primary, #e0e0e0);
}

.template-editor-checkbox {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 12px;
  color: var(--text-primary);
  cursor: pointer;
}

.template-editor-checkbox input[type="checkbox"] {
  width: 16px;
  height: 16px;
  cursor: pointer;
}

.color-custom-picker {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-top: 8px;
}

.color-custom-input-row {
  display: flex;
  align-items: center;
  gap: 8px;
}

.color-picker-input {
  width: 40px;
  height: 32px;
  padding: 0;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  background: transparent;
}

.color-picker-input::-webkit-color-swatch-wrapper {
  padding: 2px;
}

.color-picker-input::-webkit-color-swatch {
  border: 1px solid #5a5a5a;
  border-radius: 4px;
}

.tag-categories-grid {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-top: 4px;
  padding: 10px;
  background: var(--bg-primary, #1a1a2e);
  border: 1px solid var(--border-color, #3c3c3c);
  border-radius: 8px;
}

.tag-category-row {
  display: flex;
  align-items: center;
  gap: 8px;
}

.tag-category-label {
  width: 55px;
  font-size: 11px;
  font-weight: 600;
  color: var(--accent, #00ffd5);
  flex-shrink: 0;
  font-family: 'Consolas', 'Monaco', monospace;
}

.tag-category-row .template-editor-input {
  flex: 1;
}

/* Header Editor */
.header-editor-container {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 12px;
  background-color: var(--bg-primary, #1a1a2e);
  border: 1px solid var(--border-color, #3c3c3c);
  border-radius: 8px;
}

.header-editor-row {
  display: flex;
  align-items: center;
  gap: 10px;
}

.header-editor-number {
  width: 26px;
  height: 26px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 11px;
  font-weight: 700;
  color: var(--text-muted, #888);
  background-color: var(--bg-tertiary, #252530);
  border-radius: 50%;
  flex-shrink: 0;
}

.header-editor-row .template-editor-input {
  flex: 1;
}

.header-editor-remove-btn {
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  font-size: 18px;
  color: var(--text-tertiary, #666);
  background-color: transparent;
  border: 1px solid transparent;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.15s;
  flex-shrink: 0;
}

.header-editor-remove-btn:hover:not(:disabled) {
  background-color: rgba(244, 135, 113, 0.15);
  border-color: rgba(244, 135, 113, 0.3);
  color: #f48771;
}

.header-editor-remove-btn:disabled {
  opacity: 0.3;
  cursor: not-allowed;
}

.header-editor-add-btn {
  padding: 8px 14px;
  font-size: 12px;
  font-weight: 500;
  color: var(--accent, #00ffd5);
  background-color: rgba(0, 255, 213, 0.08);
  border: 1px solid rgba(0, 255, 213, 0.2);
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.15s;
  align-self: flex-start;
  margin-top: 4px;
}

.header-editor-add-btn:hover {
  background-color: rgba(0, 255, 213, 0.15);
  border-color: rgba(0, 255, 213, 0.4);
}

/* Tag Color Settings */
.tag-color-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-top: 8px;
}

.tag-color-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 12px;
  background-color: var(--bg-hover);
  border: 1px solid var(--border-light);
  border-radius: 4px;
}

.tag-color-preview {
  display: inline-block;
  font-size: 12px;
  font-weight: 600;
  /* Color set via inline style from getTagTextColor() */
  padding: 4px 10px;
  border-radius: 4px;
  min-width: 80px;
  text-align: center;
}

.tag-color-picker-input {
  width: 40px;
  height: 28px;
  border: 1px solid #5a5a5a;
  border-radius: 4px;
  cursor: pointer;
  background-color: transparent;
}

.tag-color-remove-btn {
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  margin-left: auto;
  font-size: 20px;
  color: #f48771;
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-light);
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.2s;
}

.tag-color-remove-btn:hover {
  background-color: var(--bg-tertiary);
  border-color: #f48771;
}

/* Tag color pickers row */
.tag-color-pickers {
  display: flex;
  gap: 4px;
  align-items: center;
}

.tag-border-picker-input {
  width: 28px;
  height: 28px;
  border: 2px dashed #5a5a5a;
  border-radius: 4px;
  cursor: pointer;
  background-color: transparent;
}

/* Faceted Tag Sections */
.facet-section {
  margin-bottom: 16px;
  border: 1px solid var(--border-light);
  border-radius: 8px;
  overflow: hidden;
}

.facet-section-header {
  display: flex;
  flex-direction: column;
  padding: 12px 16px;
  background-color: var(--bg-hover);
  cursor: pointer;
  user-select: none;
  transition: background-color 0.2s;
}

.facet-section-header:hover {
  background-color: var(--bg-secondary);
}

.facet-section-title-row {
  display: flex;
  align-items: center;
  gap: 8px;
}

.facet-collapse-icon {
  font-size: 10px;
  color: var(--text-secondary);
  transition: transform 0.2s;
}

.facet-collapse-icon.collapsed {
  transform: rotate(-90deg);
}

.facet-section-title {
  margin: 0;
  font-size: 14px;
  font-weight: 600;
  color: var(--text-primary);
}

.facet-tag-count {
  font-size: 12px;
  color: var(--text-secondary);
  background-color: var(--bg-tertiary);
  padding: 2px 8px;
  border-radius: 10px;
}

.facet-section-desc {
  font-size: 12px;
  color: var(--text-secondary);
  margin-top: 4px;
  margin-left: 18px;
}

.facet-section-content {
  padding: 12px 16px;
  border-top: 1px solid var(--border-light);
}

.facet-add-row {
  margin-bottom: 12px;
}

.facet-add-btn {
  padding: 6px 12px;
  font-size: 12px;
  color: var(--accent-primary);
  background-color: transparent;
  border: 1px dashed var(--accent-primary);
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.2s;
}

.facet-add-btn:hover {
  background-color: rgba(122, 162, 247, 0.1);
}

.facet-empty {
  font-size: 12px;
  color: var(--text-secondary);
  font-style: italic;
  padding: 8px 0;
}

/* Add Tag Modal - Facet Select */
.add-tag-facet-row {
  margin-bottom: 16px;
}

.add-tag-facet-row label {
  display: flex;
  flex-direction: column;
  gap: 6px;
  font-size: 12px;
  color: var(--text-secondary);
}

.add-tag-facet-select {
  padding: 8px 12px;
  font-size: 13px;
  color: var(--text-primary);
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-light);
  border-radius: 4px;
}

/* Window Size Selector */
.window-size-selector {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 12px;
  margin-top: 12px;
  padding: 8px 0;
}

.window-size-option {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  padding: 12px;
  background-color: var(--bg-hover);
  border: 2px solid var(--border-light);
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.window-size-option:hover {
  border-color: var(--accent-primary);
  background-color: var(--bg-secondary);
}

.window-size-option.active {
  border-color: var(--accent-primary);
  background-color: rgba(122, 162, 247, 0.1);
}

/* Screen simulation container - Dark mode (default) */
.window-size-preview-container {
  --screen-bg-start: #2a2a3a;
  --screen-bg-end: #1e1e2e;
  --screen-border: #3a3a4a;
  --desktop-icon-color: rgba(255, 255, 255, 0.15);
  --taskbar-bg: rgba(60, 60, 80, 0.8);
  --taskbar-border: rgba(100, 100, 120, 0.3);
  --window-bg-start: #4a4a6a;
  --window-bg-end: #3a3a5a;
  --window-titlebar-start: #5a5a7a;
  --window-titlebar-end: #4a4a6a;
  --window-content-line: rgba(255, 255, 255, 0.1);
  --window-content-line-2: rgba(255, 255, 255, 0.08);
  --window-content-line-3: rgba(255, 255, 255, 0.06);

  width: 100px;
  height: 62px;
  background: linear-gradient(135deg, var(--screen-bg-start) 0%, var(--screen-bg-end) 100%);
  border: 2px solid var(--screen-border);
  border-radius: 6px;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.3);
}

/* Light mode overrides for screen preview */
html[data-theme="light"] .window-size-preview-container {
  --screen-bg-start: #e8e8f0;
  --screen-bg-end: #d8d8e5;
  --screen-border: #c0c0d0;
  --desktop-icon-color: rgba(0, 0, 0, 0.12);
  --taskbar-bg: rgba(180, 180, 200, 0.9);
  --taskbar-border: rgba(160, 160, 180, 0.5);
  --window-bg-start: #ffffff;
  --window-bg-end: #f5f5fa;
  --window-titlebar-start: #f0f0f5;
  --window-titlebar-end: #e5e5ed;
  --window-content-line: rgba(0, 0, 0, 0.08);
  --window-content-line-2: rgba(0, 0, 0, 0.06);
  --window-content-line-3: rgba(0, 0, 0, 0.04);
  box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
}

/* Desktop icons simulation */
.window-size-preview-container::before {
  content: '';
  position: absolute;
  top: 4px;
  left: 4px;
  width: 4px;
  height: 4px;
  background-color: var(--desktop-icon-color);
  border-radius: 1px;
  box-shadow:
    0 8px 0 var(--desktop-icon-color),
    0 16px 0 var(--desktop-icon-color);
}

/* Taskbar simulation */
.window-size-preview-container::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 4px;
  background-color: var(--taskbar-bg);
  border-top: 1px solid var(--taskbar-border);
}

/* Popup window preview */
.window-size-preview {
  background: linear-gradient(180deg, var(--window-bg-start) 0%, var(--window-bg-end) 100%);
  border-radius: 3px;
  border: 1px solid rgba(122, 162, 247, 0.5);
  box-shadow:
    0 2px 8px rgba(0, 0, 0, 0.4),
    inset 0 1px 0 rgba(255, 255, 255, 0.1);
  position: relative;
  z-index: 1;
}

html[data-theme="light"] .window-size-preview {
  box-shadow:
    0 2px 8px rgba(0, 0, 0, 0.15),
    inset 0 1px 0 rgba(255, 255, 255, 0.8);
}

/* Window title bar */
.window-size-preview::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 5px;
  background: linear-gradient(180deg, var(--window-titlebar-start) 0%, var(--window-titlebar-end) 100%);
  border-radius: 3px 3px 0 0;
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
}

html[data-theme="light"] .window-size-preview::before {
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

/* Window content lines */
.window-size-preview::after {
  content: '';
  position: absolute;
  top: 10px;
  left: 4px;
  right: 4px;
  height: 2px;
  background-color: var(--window-content-line);
  box-shadow:
    0 5px 0 var(--window-content-line-2),
    0 10px 0 var(--window-content-line-3);
}

.window-size-option.active .window-size-preview {
  border-color: var(--accent-primary);
  box-shadow:
    0 2px 12px rgba(122, 162, 247, 0.4),
    inset 0 1px 0 rgba(255, 255, 255, 0.15);
}

html[data-theme="light"] .window-size-option.active .window-size-preview {
  box-shadow:
    0 2px 12px rgba(122, 162, 247, 0.3),
    inset 0 1px 0 rgba(255, 255, 255, 0.9);
}

.window-size-option.active .window-size-preview::before {
  background: linear-gradient(180deg, #7aa2f7 0%, #5a82d7 100%);
}

.window-size-label {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-primary);
}

.window-size-dimensions {
  font-size: 10px;
  color: var(--text-secondary);
}

/* Add Tag Modal */
.add-tag-modal {
  background-color: var(--bg-primary);
  border: 1px solid var(--border-light);
  border-radius: 12px;
  padding: 24px;
  width: 350px;
  max-width: 90vw;
}

.add-tag-modal h3 {
  margin: 0 0 16px 0;
  font-size: 16px;
  font-weight: 600;
  color: var(--text-primary);
}

.add-tag-form {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.add-tag-name-row {
  display: flex;
  flex-direction: column;
}

.add-tag-name-row label {
  display: flex;
  flex-direction: column;
  gap: 6px;
  font-size: 12px;
  color: var(--text-secondary);
}

.add-tag-name-row input[type="text"] {
  padding: 10px 14px;
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-light);
  border-radius: 8px;
  color: var(--text-primary);
  font-size: 14px;
}

.add-tag-name-row input[type="text"]:focus {
  outline: none;
  border-color: var(--accent-primary);
}

.add-tag-color-section {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.add-tag-color-title {
  font-size: 12px;
  color: var(--text-secondary);
}

.add-tag-color-presets {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  align-items: center;
}

.add-tag-color-preset {
  width: 28px;
  height: 28px;
  border-radius: 6px;
  border: 2px solid transparent;
  cursor: pointer;
  transition: all 0.15s ease;
  padding: 0;
}

.add-tag-color-preset:hover {
  transform: scale(1.1);
}

.add-tag-color-preset.active {
  border-color: var(--text-primary);
  box-shadow: 0 0 0 2px var(--bg-primary), 0 0 0 4px var(--accent-primary);
}

/* Unified Color Scheme Grid in Settings */
.add-tag-scheme-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 8px;
  max-width: 280px;
}

.add-tag-scheme-btn {
  width: 36px;
  height: 36px;
  border: 3px solid !important;
  border-radius: 6px;
  font-size: 14px;
}

.add-tag-scheme-btn.active {
  box-shadow: 0 0 0 3px var(--accent-primary);
}

.add-tag-scheme-btn.preset-none {
  border: 2px dashed var(--border-light) !important;
}

.add-tag-color-custom {
  position: relative;
  width: 28px;
  height: 28px;
}

.add-tag-color-input {
  width: 28px;
  height: 28px;
  border: 2px dashed var(--border-light);
  border-radius: 6px;
  cursor: pointer;
  background-color: transparent;
  padding: 0;
}

.add-tag-color-input::-webkit-color-swatch-wrapper {
  padding: 2px;
}

.add-tag-color-input::-webkit-color-swatch {
  border: none;
  border-radius: 3px;
}

.add-tag-preview {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  padding: 16px;
  background-color: var(--bg-secondary);
  border-radius: 10px;
}

.add-tag-preview-label {
  font-size: 11px;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.add-tag-preview .tag-color-preview {
  font-size: 16px;
  padding: 6px 14px;
}

.add-tag-actions {
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  margin-top: 8px;
}

.add-tag-actions button {
  padding: 8px 16px;
  border-radius: 6px;
  font-size: 13px;
  cursor: pointer;
  transition: all 0.2s;
}

.add-tag-actions button:first-child {
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-light);
  color: var(--text-secondary);
}

.add-tag-actions button:first-child:hover {
  background-color: var(--bg-tertiary);
}

.add-tag-actions button.primary {
  background-color: var(--accent-primary);
  border: 1px solid var(--accent-primary);
  color: white;
}

.add-tag-actions button.primary:hover {
  background-color: #6b93e4;
}

.add-tag-actions button.primary:disabled {
  background-color: var(--bg-tertiary);
  border-color: var(--border-light);
  color: var(--text-secondary);
  cursor: not-allowed;
}

/* Cleanup Unused Tags Button */
.settings-cleanup-btn {
  padding: 8px 16px;
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-light);
  border-radius: 6px;
  color: var(--text-secondary);
  font-size: 13px;
  cursor: pointer;
  transition: all 0.2s;
  margin-top: 8px;
}

.settings-cleanup-btn:hover:not(:disabled) {
  background-color: var(--bg-tertiary);
  color: var(--text-primary);
}

.settings-cleanup-btn:disabled {
  cursor: not-allowed;
  opacity: 0.6;
}

/* Unused Tags Modal */
.unused-tags-modal {
  background-color: var(--bg-primary);
  border: 1px solid var(--border-light);
  border-radius: 12px;
  padding: 24px;
  width: 400px;
  max-width: 90vw;
  max-height: 80vh;
  display: flex;
  flex-direction: column;
}

.unused-tags-modal h3 {
  margin: 0 0 16px 0;
  font-size: 16px;
  font-weight: 600;
  color: var(--text-primary);
}

.unused-tags-empty {
  color: var(--text-secondary);
  font-size: 14px;
  text-align: center;
  padding: 20px;
}

.unused-tags-info {
  color: var(--text-secondary);
  font-size: 13px;
  margin-bottom: 12px;
}

.unused-tags-list {
  display: flex;
  flex-direction: column;
  gap: 6px;
  max-height: 300px;
  overflow-y: auto;
  padding: 4px 0;
}

.unused-tag-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 8px 12px;
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-light);
  border-radius: 6px;
}

.unused-tag-name {
  font-size: 13px;
  color: var(--text-primary);
  font-family: 'Fira Code', 'Consolas', monospace;
}

.unused-tag-remove {
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: none;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  border-radius: 4px;
  font-size: 16px;
  transition: all 0.15s;
}

.unused-tag-remove:hover {
  background-color: rgba(255, 100, 100, 0.15);
  color: #ff6b6b;
}

.unused-tags-actions {
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  margin-top: 16px;
  padding-top: 12px;
  border-top: 1px solid var(--border-light);
}

.unused-tags-actions button {
  padding: 8px 16px;
  border-radius: 6px;
  font-size: 13px;
  cursor: pointer;
  transition: all 0.2s;
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-light);
  color: var(--text-secondary);
}

.unused-tags-actions button:hover {
  background-color: var(--bg-tertiary);
}

.unused-tags-actions button.danger {
  background-color: #ff6b6b;
  border-color: #ff6b6b;
  color: white;
}

.unused-tags-actions button.danger:hover {
  background-color: #e55a5a;
}

/* Note Template prefix in settings */
.settings-note-template-prefix {
  display: inline-block;
  font-size: 10px;
  font-weight: 700;
  color: #7aa2f7;
  background-color: rgba(122, 162, 247, 0.1);
  padding: 1px 5px;
  border-radius: 3px;
  margin-right: 8px;
  min-width: 44px;
  text-align: center;
}

/* Container settings */
.settings-container-row {
  flex-wrap: wrap;
}

.settings-container-actions {
  display: flex;
  gap: 6px;
  flex-shrink: 0;
}

/* ============================================================ */
/* File Tree Context Menu */
/* ============================================================ */

.file-tree-context-menu {
  position: fixed;
  z-index: 2000;
  background-color: var(--bg-tertiary);
  border: 1px solid var(--border-light);
  border-radius: 4px;
  box-shadow: 0 4px 12px var(--shadow-color);
  padding: 4px 0;
  min-width: 100px;
  max-height: min(500px, calc(100vh - 80px));
  overflow-y: auto;
}

.file-tree-context-menu::-webkit-scrollbar {
  width: 6px;
}

.file-tree-context-menu::-webkit-scrollbar-track {
  background: transparent;
}

.file-tree-context-menu::-webkit-scrollbar-thumb {
  background: var(--border-color, #3c3c3c);
  border-radius: 3px;
}

.file-tree-context-menu::-webkit-scrollbar-thumb:hover {
  background: var(--text-muted, #666);
}

.context-menu-item {
  display: block;
  width: 100%;
  padding: 6px 16px;
  font-size: 12px;
  color: var(--text-secondary);
  background: none;
  border: none;
  text-align: left;
  cursor: pointer;
}

.context-menu-item:hover {
  background-color: var(--bg-hover);
}

.context-menu-item.delete {
  color: #f44;
}

.context-menu-item.delete:hover {
  background-color: #4a2020;
}

/* ============================================================ */
/* Wiki Link Context Menu */
/* ============================================================ */

.context-menu {
  background-color: var(--bg-tertiary);
  border: 1px solid var(--border-light);
  border-radius: 4px;
  box-shadow: 0 4px 12px var(--shadow-color);
  padding: 4px 0;
  min-width: 140px;
  max-height: min(500px, calc(100vh - 80px));
  overflow: visible;
}

.context-menu::-webkit-scrollbar {
  width: 6px;
}

.context-menu::-webkit-scrollbar-track {
  background: transparent;
}

.context-menu::-webkit-scrollbar-thumb {
  background: var(--border-color, #3c3c3c);
  border-radius: 3px;
}

.context-menu::-webkit-scrollbar-thumb:hover {
  background: var(--text-muted, #666);
}

.context-menu-separator {
  height: 1px;
  background-color: var(--border-color);
  margin: 4px 0;
}

.context-menu-submenu-trigger {
  display: flex;
  align-items: center;
  justify-content: space-between;
  position: relative;
  cursor: pointer;
  padding: 6px 16px;
  font-size: 12px;
  color: var(--text-secondary);
}

.context-menu-submenu-trigger:hover {
  background-color: var(--bg-hover);
}

.context-menu-arrow {
  font-size: 10px;
  color: var(--text-muted);
  margin-left: 8px;
}

.context-menu-submenu {
  position: absolute;
  left: 100%;
  top: -4px;
  background-color: var(--bg-tertiary);
  border: 1px solid var(--border-light);
  border-radius: 4px;
  box-shadow: 0 4px 12px var(--shadow-color);
  padding: 4px 0;
  min-width: 160px;
  max-height: 300px;
  overflow-y: auto;
  z-index: 10001;
}

.context-menu-type-prefix {
  display: inline-block;
  font-size: 9px;
  font-weight: 700;
  color: #7aa2f7;
  background-color: rgba(122, 162, 247, 0.1);
  padding: 1px 4px;
  border-radius: 2px;
  margin-right: 6px;
  min-width: 36px;
  text-align: center;
}

.context-menu-check {
  display: inline-block;
  width: 16px;
  font-size: 11px;
  color: #7aa2f7;
  flex-shrink: 0;
}

.context-menu-type-desc {
  margin-left: auto;
  font-size: 10px;
  color: var(--text-muted);
  padding-left: 12px;
}

.context-menu-item.checked {
  background-color: rgba(122, 162, 247, 0.1);
}

/* ============================================================ */
/* Move Note Modal */
/* ============================================================ */

.move-note-backdrop {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 8000;
}

.move-note-modal {
  background-color: var(--bg-tertiary);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  width: 400px;
  max-height: 500px;
  display: flex;
  flex-direction: column;
  box-shadow: 0 8px 32px var(--shadow-color);
}

.move-note-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 16px;
  border-bottom: 1px solid var(--border-color);
}

.move-note-title {
  font-size: 14px;
  font-weight: 600;
  color: var(--text-primary);
}

.move-note-close {
  background: none;
  border: none;
  color: var(--text-muted);
  font-size: 16px;
  cursor: pointer;
  padding: 0 4px;
}

.move-note-close:hover {
  color: var(--text-primary);
}

.move-note-body {
  flex: 1;
  overflow-y: auto;
  padding: 8px 0;
  max-height: 340px;
}

.move-note-tree {
  padding: 0 8px;
}

.move-tree-item {
  user-select: none;
}

.move-tree-row {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 4px 8px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 13px;
  color: var(--text-secondary);
}

.move-tree-row:hover {
  background-color: var(--bg-hover);
}

.move-tree-row.selected {
  background-color: var(--calendar-selected-bg);
  color: var(--text-primary);
}

.move-tree-row.current {
  opacity: 0.6;
}

.move-tree-toggle {
  width: 16px;
  font-size: 14px;
  cursor: pointer;
  color: var(--text-secondary);
  flex-shrink: 0;
  font-weight: bold;
}

.move-tree-toggle-spacer {
  width: 16px;
  flex-shrink: 0;
}

.move-tree-name {
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  color: var(--text-primary);
}

.move-tree-current {
  font-size: 11px;
  color: var(--text-muted);
  margin-left: 8px;
}

.move-note-footer {
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  padding: 12px 16px;
  border-top: 1px solid var(--border-color);
}

.move-note-btn {
  padding: 6px 16px;
  font-size: 12px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-weight: 500;
}

.move-note-btn.cancel {
  background-color: var(--bg-tertiary);
  color: var(--text-secondary);
}

.move-note-btn.cancel:hover {
  background-color: var(--bg-hover);
}

.move-note-btn.confirm {
  background-color: #007acc;
  color: #fff;
}

.move-note-btn.confirm:hover {
  background-color: #0098ff;
}

.move-note-btn.confirm:disabled {
  background-color: var(--bg-tertiary);
  color: var(--text-muted);
  cursor: not-allowed;
}

/* ============================================================ */
/* PDF Viewer */
/* ============================================================ */

.pdf-viewer-body {
  padding: 0;
}

.pdf-viewer-body embed {
  border: none;
  display: block;
}

/* ============================================================ */
/* Web Viewer */
/* ============================================================ */

.web-viewer-body {
  padding: 0;
  overflow: hidden;
}

.web-viewer-body iframe {
  width: 100%;
  height: 100%;
  border: none;
  display: block;
}

/* ============================================================ */
/* Image Viewer */
/* ============================================================ */

.image-viewer-body {
  padding: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: auto;
  background: var(--bg-primary);
}

.image-viewer-body img {
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
}

/* ============================================================ */
/* Attachment Item in Search */
/* ============================================================ */

.attachment-item .search-content-title {
  color: #cc8899;
}

/* ============================================================ */
/* Template Selector */
/* ============================================================ */

.template-selector {
  position: fixed;
  background-color: var(--bg-tertiary);
  border: 1px solid var(--border-light);
  border-radius: 6px;
  box-shadow: 0 4px 16px var(--shadow-color);
  padding: 4px 0;
  min-width: 180px;
  max-height: 400px;
  overflow-y: auto;
  z-index: 9000;
}

.template-selector-header {
  padding: 6px 12px 4px;
  font-size: 11px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  border-bottom: 1px solid var(--border-color);
  margin-bottom: 4px;
}

.template-selector-item {
  display: flex;
  align-items: center;
  gap: 8px;
  width: 100%;
  padding: 6px 12px;
  font-size: 12px;
  color: var(--text-secondary);
  background: none;
  border: none;
  text-align: left;
  cursor: pointer;
}

.template-selector-item:hover {
  background-color: var(--bg-hover);
}

/* Template Type Colors */
.template-selector-item.note-type { border-left: 3px solid var(--note-color); background: linear-gradient(to right, var(--note-bg) 0%, transparent 30%); }
.template-selector-item.sketch-type { border-left: 3px solid var(--sketch-color); background: linear-gradient(to right, var(--sketch-bg) 0%, transparent 30%); }
.template-selector-item.mtg-type { border-left: 3px solid var(--mtg-color); background: linear-gradient(to right, var(--mtg-bg) 0%, transparent 30%); }
.template-selector-item.sem-type { border-left: 3px solid var(--sem-color); background: linear-gradient(to right, var(--sem-bg) 0%, transparent 30%); }
.template-selector-item.event-type { border-left: 3px solid var(--event-color); background: linear-gradient(to right, var(--event-bg) 0%, transparent 30%); }
.template-selector-item.ofa-type { border-left: 3px solid var(--ofa-color); background: linear-gradient(to right, var(--ofa-bg) 0%, transparent 30%); }
.template-selector-item.paper-type { border-left: 3px solid var(--paper-color); background: linear-gradient(to right, var(--paper-bg) 0%, transparent 30%); }
.template-selector-item.lit-type { border-left: 3px solid var(--lit-color); background: linear-gradient(to right, var(--lit-bg) 0%, transparent 30%); }
.template-selector-item.data-type { border-left: 3px solid var(--data-color); background: linear-gradient(to right, var(--data-bg) 0%, transparent 30%); }
.template-selector-item.theo-type { border-left: 3px solid var(--theo-color); background: linear-gradient(to right, var(--theo-bg) 0%, transparent 30%); }
.template-selector-item.contact-type { border-left: 3px solid var(--contact-color); background: linear-gradient(to right, var(--contact-bg) 0%, transparent 30%); }
.template-selector-item.setup-type { border-left: 3px solid var(--setup-color); background: linear-gradient(to right, var(--setup-bg) 0%, transparent 30%); }

.template-selector-item.note-type:hover { background: linear-gradient(to right, var(--note-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.template-selector-item.sketch-type:hover { background: linear-gradient(to right, var(--sketch-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.template-selector-item.mtg-type:hover { background: linear-gradient(to right, var(--mtg-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.template-selector-item.sem-type:hover { background: linear-gradient(to right, var(--sem-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.template-selector-item.event-type:hover { background: linear-gradient(to right, var(--event-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.template-selector-item.ofa-type:hover { background: linear-gradient(to right, var(--ofa-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.template-selector-item.paper-type:hover { background: linear-gradient(to right, var(--paper-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.template-selector-item.lit-type:hover { background: linear-gradient(to right, var(--lit-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.template-selector-item.data-type:hover { background: linear-gradient(to right, var(--data-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.template-selector-item.theo-type:hover { background: linear-gradient(to right, var(--theo-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.template-selector-item.contact-type:hover { background: linear-gradient(to right, var(--contact-bg-hover) 0%, var(--bg-hover-rgba) 40%); }
.template-selector-item.setup-type:hover { background: linear-gradient(to right, var(--setup-bg-hover) 0%, var(--bg-hover-rgba) 40%); }

/* Custom color override for template selector items */
.template-selector-item.has-custom-color {
  border-left: 3px solid var(--template-color) !important;
  background: linear-gradient(to right, color-mix(in srgb, var(--template-color) 15%, transparent) 0%, transparent 30%) !important;
}
.template-selector-item.has-custom-color:hover {
  background: linear-gradient(to right, color-mix(in srgb, var(--template-color) 25%, transparent) 0%, rgba(60, 60, 60, 1) 40%) !important;
}

.template-selector-icon {
  display: inline-block;
  width: 16px;
  height: 16px;
  flex-shrink: 0;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
}

/* Template Selector Icons by Type */
.template-selector-icon.icon-note {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23a78bfa' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z'%3E%3C/path%3E%3Cpolyline points='14 2 14 8 20 8'%3E%3C/polyline%3E%3Cline x1='16' y1='13' x2='8' y2='13'%3E%3C/line%3E%3Cline x1='16' y1='17' x2='8' y2='17'%3E%3C/line%3E%3Cpolyline points='10 9 9 9 8 9'%3E%3C/polyline%3E%3C/svg%3E");
}

.template-selector-icon.icon-sketch {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23f472b6' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12 19l7-7 3 3-7 7-3-3z'%3E%3C/path%3E%3Cpath d='M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z'%3E%3C/path%3E%3Cpath d='M2 2l7.586 7.586'%3E%3C/path%3E%3Ccircle cx='11' cy='11' r='2'%3E%3C/circle%3E%3C/svg%3E");
}

.template-selector-icon.icon-mtg {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2360a5fa' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2'%3E%3C/path%3E%3Ccircle cx='9' cy='7' r='4'%3E%3C/circle%3E%3Cpath d='M22 21v-2a4 4 0 0 0-3-3.87'%3E%3C/path%3E%3Cpath d='M16 3.13a4 4 0 0 1 0 7.75'%3E%3C/path%3E%3C/svg%3E");
}

.template-selector-icon.icon-sem {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23fb923c' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M22 10v6M2 10l10-5 10 5-10 5z'%3E%3C/path%3E%3Cpath d='M6 12v5c3 3 9 3 12 0v-5'%3E%3C/path%3E%3C/svg%3E");
}

.template-selector-icon.icon-event {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23f87171' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect x='3' y='4' width='18' height='18' rx='2' ry='2'%3E%3C/rect%3E%3Cline x1='16' y1='2' x2='16' y2='6'%3E%3C/line%3E%3Cline x1='8' y1='2' x2='8' y2='6'%3E%3C/line%3E%3Cline x1='3' y1='10' x2='21' y2='10'%3E%3C/line%3E%3C/svg%3E");
}

.template-selector-icon.icon-ofa {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2334d399' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z'%3E%3C/path%3E%3C/svg%3E");
}

.template-selector-icon.icon-paper {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%235eead4' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z'%3E%3C/path%3E%3Cpolyline points='14 2 14 8 20 8'%3E%3C/polyline%3E%3Cline x1='16' y1='13' x2='8' y2='13'%3E%3C/line%3E%3Cline x1='16' y1='17' x2='8' y2='17'%3E%3C/line%3E%3Cline x1='12' y1='9' x2='8' y2='9'%3E%3C/line%3E%3C/svg%3E");
}

.template-selector-icon.icon-lit {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23a3e635' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M4 19.5A2.5 2.5 0 0 1 6.5 17H20'%3E%3C/path%3E%3Cpath d='M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z'%3E%3C/path%3E%3C/svg%3E");
}

.template-selector-icon.icon-data {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23fbbf24' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cellipse cx='12' cy='5' rx='9' ry='3'%3E%3C/ellipse%3E%3Cpath d='M21 12c0 1.66-4 3-9 3s-9-1.34-9-3'%3E%3C/path%3E%3Cpath d='M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5'%3E%3C/path%3E%3C/svg%3E");
}

.template-selector-icon.icon-theo {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23818cf8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='5'%3E%3C/circle%3E%3Cline x1='12' y1='1' x2='12' y2='3'%3E%3C/line%3E%3Cline x1='12' y1='21' x2='12' y2='23'%3E%3C/line%3E%3Cline x1='4.22' y1='4.22' x2='5.64' y2='5.64'%3E%3C/line%3E%3Cline x1='18.36' y1='18.36' x2='19.78' y2='19.78'%3E%3C/line%3E%3Cline x1='1' y1='12' x2='3' y2='12'%3E%3C/line%3E%3Cline x1='21' y1='12' x2='23' y2='12'%3E%3C/line%3E%3Cline x1='4.22' y1='19.78' x2='5.64' y2='18.36'%3E%3C/line%3E%3Cline x1='18.36' y1='5.64' x2='19.78' y2='4.22'%3E%3C/line%3E%3C/svg%3E");
}

.template-selector-icon.icon-contact {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2322d3ee' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2'%3E%3C/path%3E%3Ccircle cx='12' cy='7' r='4'%3E%3C/circle%3E%3C/svg%3E");
}

.template-selector-icon.icon-setup {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%239ca3af' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='3'%3E%3C/circle%3E%3Cpath d='M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z'%3E%3C/path%3E%3C/svg%3E");
}

.template-selector-name {
  color: var(--text-primary);
}

/* ============================================================ */
/* Template Selector V2 (Enhanced with descriptions) */
/* ============================================================ */

.template-selector-v2 {
  position: fixed;
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 10px;
  box-shadow: 0 8px 32px var(--shadow-color);
  min-width: 320px;
  max-width: 380px;
  max-height: 520px;
  display: flex;
  flex-direction: column;
  z-index: 9000;
  overflow: hidden;
}

.template-selector-header-v2 {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 16px;
  font-size: 13px;
  font-weight: 600;
  color: var(--text-primary);
  border-bottom: 1px solid var(--border-color);
  background: linear-gradient(to bottom, var(--bg-tertiary), var(--bg-secondary));
}

.template-selector-hint {
  font-size: 10px;
  font-weight: 500;
  color: var(--text-muted);
  background: var(--bg-primary);
  padding: 2px 6px;
  border-radius: 4px;
  letter-spacing: 0.5px;
}

.template-selector-search {
  padding: 8px 12px;
  border-bottom: 1px solid var(--border-color);
}

.template-selector-search-input {
  width: 100%;
  padding: 8px 12px;
  font-size: 12px;
  color: var(--text-primary);
  background: var(--bg-primary);
  border: 1px solid var(--border-color);
  border-radius: 6px;
  outline: none;
  box-sizing: border-box;
  transition: border-color 0.15s;
}

.template-selector-search-input:focus {
  border-color: var(--accent-color);
}

.template-selector-search-input::placeholder {
  color: var(--text-muted);
}

.template-selector-list {
  flex: 1;
  overflow-y: auto;
  padding: 8px;
}

.template-selector-section-label {
  padding: 6px 8px 4px;
  font-size: 10px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.8px;
}

.template-selector-item-v2 {
  display: flex;
  align-items: flex-start;
  gap: 10px;
  width: 100%;
  padding: 10px 12px;
  font-size: 12px;
  color: var(--text-secondary);
  background: transparent;
  border: none;
  border-left: 3px solid transparent;
  border-radius: 6px;
  text-align: left;
  cursor: pointer;
  transition: all 0.15s;
  margin-bottom: 2px;
}

.template-selector-item-v2:hover {
  background-color: var(--bg-hover);
}

/* Template Type Colors V2 */
.template-selector-item-v2.note-type { border-left-color: var(--note-color); background: linear-gradient(to right, var(--note-bg) 0%, transparent 50%); }
.template-selector-item-v2.sketch-type { border-left-color: var(--sketch-color); background: linear-gradient(to right, var(--sketch-bg) 0%, transparent 50%); }
.template-selector-item-v2.mtg-type { border-left-color: var(--mtg-color); background: linear-gradient(to right, var(--mtg-bg) 0%, transparent 50%); }
.template-selector-item-v2.sem-type { border-left-color: var(--sem-color); background: linear-gradient(to right, var(--sem-bg) 0%, transparent 50%); }
.template-selector-item-v2.event-type { border-left-color: var(--event-color); background: linear-gradient(to right, var(--event-bg) 0%, transparent 50%); }
.template-selector-item-v2.ofa-type { border-left-color: var(--ofa-color); background: linear-gradient(to right, var(--ofa-bg) 0%, transparent 50%); }
.template-selector-item-v2.paper-type { border-left-color: var(--paper-color); background: linear-gradient(to right, var(--paper-bg) 0%, transparent 50%); }
.template-selector-item-v2.lit-type { border-left-color: var(--lit-color); background: linear-gradient(to right, var(--lit-bg) 0%, transparent 50%); }
.template-selector-item-v2.data-type { border-left-color: var(--data-color); background: linear-gradient(to right, var(--data-bg) 0%, transparent 50%); }
.template-selector-item-v2.theo-type { border-left-color: var(--theo-color); background: linear-gradient(to right, var(--theo-bg) 0%, transparent 50%); }
.template-selector-item-v2.contact-type { border-left-color: var(--contact-color); background: linear-gradient(to right, var(--contact-bg) 0%, transparent 50%); }
.template-selector-item-v2.setup-type { border-left-color: var(--setup-color); background: linear-gradient(to right, var(--setup-bg) 0%, transparent 50%); }

.template-selector-item-v2.note-type:hover { background: linear-gradient(to right, var(--note-bg-hover) 0%, var(--bg-hover) 60%); }
.template-selector-item-v2.sketch-type:hover { background: linear-gradient(to right, var(--sketch-bg-hover) 0%, var(--bg-hover) 60%); }
.template-selector-item-v2.mtg-type:hover { background: linear-gradient(to right, var(--mtg-bg-hover) 0%, var(--bg-hover) 60%); }
.template-selector-item-v2.sem-type:hover { background: linear-gradient(to right, var(--sem-bg-hover) 0%, var(--bg-hover) 60%); }
.template-selector-item-v2.event-type:hover { background: linear-gradient(to right, var(--event-bg-hover) 0%, var(--bg-hover) 60%); }
.template-selector-item-v2.ofa-type:hover { background: linear-gradient(to right, var(--ofa-bg-hover) 0%, var(--bg-hover) 60%); }
.template-selector-item-v2.paper-type:hover { background: linear-gradient(to right, var(--paper-bg-hover) 0%, var(--bg-hover) 60%); }
.template-selector-item-v2.lit-type:hover { background: linear-gradient(to right, var(--lit-bg-hover) 0%, var(--bg-hover) 60%); }
.template-selector-item-v2.data-type:hover { background: linear-gradient(to right, var(--data-bg-hover) 0%, var(--bg-hover) 60%); }
.template-selector-item-v2.theo-type:hover { background: linear-gradient(to right, var(--theo-bg-hover) 0%, var(--bg-hover) 60%); }
.template-selector-item-v2.contact-type:hover { background: linear-gradient(to right, var(--contact-bg-hover) 0%, var(--bg-hover) 60%); }
.template-selector-item-v2.setup-type:hover { background: linear-gradient(to right, var(--setup-bg-hover) 0%, var(--bg-hover) 60%); }

.template-selector-item-v2.has-custom-color {
  border-left-color: var(--template-color) !important;
  background: linear-gradient(to right, color-mix(in srgb, var(--template-color) 15%, transparent) 0%, transparent 50%) !important;
}
.template-selector-item-v2.has-custom-color:hover {
  background: linear-gradient(to right, color-mix(in srgb, var(--template-color) 25%, transparent) 0%, var(--bg-hover) 60%) !important;
}

.template-selector-icon-v2 {
  display: inline-block;
  width: 20px;
  height: 20px;
  flex-shrink: 0;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  margin-top: 2px;
}

/* Icon images - use same as original template-selector-icon */
.template-selector-icon-v2.icon-note { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23a78bfa' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z'%3E%3C/path%3E%3Cpolyline points='14 2 14 8 20 8'%3E%3C/polyline%3E%3Cline x1='16' y1='13' x2='8' y2='13'%3E%3C/line%3E%3Cline x1='16' y1='17' x2='8' y2='17'%3E%3C/line%3E%3Cpolyline points='10 9 9 9 8 9'%3E%3C/polyline%3E%3C/svg%3E"); }
.template-selector-icon-v2.icon-sketch { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23f472b6' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12 19l7-7 3 3-7 7-3-3z'%3E%3C/path%3E%3Cpath d='M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z'%3E%3C/path%3E%3Cpath d='M2 2l7.586 7.586'%3E%3C/path%3E%3Ccircle cx='11' cy='11' r='2'%3E%3C/circle%3E%3C/svg%3E"); }
.template-selector-icon-v2.icon-mtg { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2360a5fa' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2'%3E%3C/path%3E%3Ccircle cx='9' cy='7' r='4'%3E%3C/circle%3E%3Cpath d='M22 21v-2a4 4 0 0 0-3-3.87'%3E%3C/path%3E%3Cpath d='M16 3.13a4 4 0 0 1 0 7.75'%3E%3C/path%3E%3C/svg%3E"); }
.template-selector-icon-v2.icon-sem { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23fb923c' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M22 10v6M2 10l10-5 10 5-10 5z'%3E%3C/path%3E%3Cpath d='M6 12v5c3 3 9 3 12 0v-5'%3E%3C/path%3E%3C/svg%3E"); }
.template-selector-icon-v2.icon-event { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23f87171' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect x='3' y='4' width='18' height='18' rx='2' ry='2'%3E%3C/rect%3E%3Cline x1='16' y1='2' x2='16' y2='6'%3E%3C/line%3E%3Cline x1='8' y1='2' x2='8' y2='6'%3E%3C/line%3E%3Cline x1='3' y1='10' x2='21' y2='10'%3E%3C/line%3E%3C/svg%3E"); }
.template-selector-icon-v2.icon-ofa { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2334d399' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z'%3E%3C/path%3E%3C/svg%3E"); }
.template-selector-icon-v2.icon-paper { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%235eead4' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z'%3E%3C/path%3E%3Cpolyline points='14 2 14 8 20 8'%3E%3C/polyline%3E%3Cline x1='16' y1='13' x2='8' y2='13'%3E%3C/line%3E%3Cline x1='16' y1='17' x2='8' y2='17'%3E%3C/line%3E%3Cline x1='12' y1='9' x2='8' y2='9'%3E%3C/line%3E%3C/svg%3E"); }
.template-selector-icon-v2.icon-lit { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23a3e635' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M4 19.5A2.5 2.5 0 0 1 6.5 17H20'%3E%3C/path%3E%3Cpath d='M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z'%3E%3C/path%3E%3C/svg%3E"); }
.template-selector-icon-v2.icon-data { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23fbbf24' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cellipse cx='12' cy='5' rx='9' ry='3'%3E%3C/ellipse%3E%3Cpath d='M21 12c0 1.66-4 3-9 3s-9-1.34-9-3'%3E%3C/path%3E%3Cpath d='M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5'%3E%3C/path%3E%3C/svg%3E"); }
.template-selector-icon-v2.icon-theo { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23818cf8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='5'%3E%3C/circle%3E%3Cline x1='12' y1='1' x2='12' y2='3'%3E%3C/line%3E%3Cline x1='12' y1='21' x2='12' y2='23'%3E%3C/line%3E%3Cline x1='4.22' y1='4.22' x2='5.64' y2='5.64'%3E%3C/line%3E%3Cline x1='18.36' y1='18.36' x2='19.78' y2='19.78'%3E%3C/line%3E%3Cline x1='1' y1='12' x2='3' y2='12'%3E%3C/line%3E%3Cline x1='21' y1='12' x2='23' y2='12'%3E%3C/line%3E%3Cline x1='4.22' y1='19.78' x2='5.64' y2='18.36'%3E%3C/line%3E%3Cline x1='18.36' y1='5.64' x2='19.78' y2='4.22'%3E%3C/line%3E%3C/svg%3E"); }
.template-selector-icon-v2.icon-contact { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2322d3ee' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2'%3E%3C/path%3E%3Ccircle cx='12' cy='7' r='4'%3E%3C/circle%3E%3C/svg%3E"); }
.template-selector-icon-v2.icon-setup { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%239ca3af' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='3'%3E%3C/circle%3E%3Cpath d='M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z'%3E%3C/path%3E%3C/svg%3E"); }

.template-selector-content {
  flex: 1;
  min-width: 0;
}

.template-selector-header-row {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 2px;
}

.template-selector-name-v2 {
  font-size: 13px;
  font-weight: 500;
  color: var(--text-primary);
}

.template-selector-prefix {
  font-size: 10px;
  font-weight: 500;
  color: var(--text-muted);
  background: var(--bg-primary);
  padding: 1px 5px;
  border-radius: 3px;
}

.template-selector-desc {
  font-size: 11px;
  color: var(--text-muted);
  line-height: 1.4;
}

.template-selector-empty {
  padding: 20px;
  text-align: center;
  color: var(--text-muted);
  font-size: 12px;
}

/* ============================================================ */
/* Rename Dialog */
/* ============================================================ */

.rename-dialog-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9500;
}

.rename-dialog {
  background-color: var(--bg-tertiary);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  width: 360px;
  padding: 16px;
  box-shadow: 0 8px 32px var(--shadow-color);
}

.rename-dialog-title {
  font-size: 14px;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 12px;
}

.rename-dialog-input {
  width: 100%;
  padding: 8px 10px;
  font-size: 13px;
  color: var(--text-primary);
  background-color: var(--bg-primary);
  border: 1px solid var(--border-light);
  border-radius: 4px;
  outline: none;
  box-sizing: border-box;
}

.rename-dialog-input:focus {
  border-color: #7aa2f7;
}

.rename-dialog-actions {
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  margin-top: 14px;
}

.rename-dialog-btn {
  padding: 6px 14px;
  font-size: 12px;
  border-radius: 4px;
  border: none;
  cursor: pointer;
}

.rename-dialog-btn.cancel {
  background-color: var(--bg-hover);
  color: var(--text-secondary);
}

.rename-dialog-btn.cancel:hover {
  background-color: var(--border-color);
}

.rename-dialog-btn.confirm {
  background-color: #7aa2f7;
  color: #1e1e1e;
  font-weight: 600;
}

.rename-dialog-btn.confirm:hover {
  background-color: #89b4fa;
}

/* ============================================================ */
/* Container Type Selector */
/* ============================================================ */

.container-type-selector {
  position: fixed;
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-light);
  border-radius: 6px;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.5);
  padding: 4px 0;
  min-width: 200px;
  z-index: 9000;
}

.container-type-selector-header {
  padding: 6px 12px 4px;
  font-size: 11px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  border-bottom: 1px solid var(--border-color);
  margin-bottom: 4px;
}

.container-type-selector-item {
  display: flex;
  align-items: center;
  gap: 10px;
  width: 100%;
  padding: 8px 12px;
  background: none;
  border: none;
  text-align: left;
  cursor: pointer;
  color: var(--text-primary);
}

.container-type-selector-item:hover {
  background-color: var(--bg-tertiary);
}

.container-type-icon {
  font-size: 16px;
  color: var(--text-secondary);
  width: 20px;
  text-align: center;
}

.container-type-info {
  display: flex;
  flex-direction: column;
  gap: 1px;
}

.container-type-name {
  font-size: 13px;
  font-weight: 500;
  color: var(--text-primary);
}

.container-type-desc {
  font-size: 11px;
  color: var(--text-muted);
}

/* Container type badge in sidebar */
.container-type-badge {
  font-size: 9px;
  font-weight: 700;
  color: #7aa2f7;
  background-color: rgba(122, 162, 247, 0.15);
  padding: 0 4px;
  border-radius: 3px;
  margin-left: auto;
}

.container-item.storage .container-icon {
  color: #7aa2f7;
}

/* ============================================================ */
/* Container Type Selector V2 (Enhanced Design) */
/* ============================================================ */

.container-type-selector-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9500;
}

.container-type-selector-v2 {
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 12px;
  box-shadow: 0 12px 48px var(--shadow-color);
  width: 420px;
  max-width: 90vw;
  overflow: hidden;
}

.container-type-selector-header-v2 {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px 20px;
  border-bottom: 1px solid var(--border-color);
  background: linear-gradient(to bottom, var(--bg-tertiary), var(--bg-secondary));
}

.container-type-selector-header-v2 > span:first-child {
  font-size: 15px;
  font-weight: 600;
  color: var(--text-primary);
}

.container-type-selector-hint {
  font-size: 10px;
  font-weight: 500;
  color: var(--text-muted);
  background: var(--bg-primary);
  padding: 3px 8px;
  border-radius: 4px;
  letter-spacing: 0.5px;
}

.container-type-selector-content {
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.container-type-selector-item-v2 {
  display: flex;
  align-items: flex-start;
  gap: 14px;
  padding: 16px;
  background: var(--bg-primary);
  border: 1px solid var(--border-color);
  border-radius: 10px;
  text-align: left;
  cursor: pointer;
  transition: all 0.2s;
}

.container-type-selector-item-v2:hover {
  background: var(--bg-tertiary);
  border-color: var(--border-light);
  transform: translateY(-1px);
}

.container-type-selector-item-v2.standard:hover {
  border-color: #7aa2f7;
  box-shadow: 0 4px 12px rgba(122, 162, 247, 0.15);
}

.container-type-selector-item-v2.storage:hover {
  border-color: #8b9a6b;
  box-shadow: 0 4px 12px rgba(139, 154, 107, 0.15);
}

.container-type-icon-wrapper {
  width: 48px;
  height: 48px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 10px;
  flex-shrink: 0;
}

.container-type-icon-wrapper.standard {
  background: linear-gradient(135deg, rgba(122, 162, 247, 0.2), rgba(122, 162, 247, 0.08));
  color: #7aa2f7;
}

.container-type-icon-wrapper.storage {
  background: linear-gradient(135deg, rgba(139, 154, 107, 0.2), rgba(139, 154, 107, 0.08));
  color: #8b9a6b;
}

.container-type-info-v2 {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 6px;
  padding-top: 2px;
}

.container-type-name-v2 {
  font-size: 14px;
  font-weight: 600;
  color: var(--text-primary);
}

.container-type-desc-v2 {
  font-size: 12px;
  color: var(--text-muted);
  line-height: 1.5;
}

.container-type-selector-footer {
  padding: 12px 16px 16px;
  display: flex;
  justify-content: flex-end;
  border-top: 1px solid var(--border-color);
  background: var(--bg-secondary);
}

.container-type-cancel-btn {
  padding: 8px 16px;
  font-size: 12px;
  color: var(--text-muted);
  background: transparent;
  border: 1px solid var(--border-color);
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.15s;
}

.container-type-cancel-btn:hover {
  color: var(--text-secondary);
  border-color: var(--border-light);
  background: var(--bg-hover);
}

/* ============================================================ */
/* Ribbon Bar */
/* ============================================================ */

.ribbon-bar {
  border-top: 1px solid var(--border-color);
  padding: 6px 8px;
  flex-shrink: 0;
}

.ribbon-buttons {
  display: flex;
  gap: 4px;
  flex-wrap: wrap;
}

.ribbon-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 4px;
  min-width: 48px;
  height: 28px;
  padding: 0 8px;
  border: 1px solid var(--border-color);
  border-radius: 4px;
  background-color: var(--bg-hover);
  color: var(--text-muted);
  cursor: pointer;
  transition: background-color 0.1s, color 0.1s;
}

.ribbon-btn:hover {
  background-color: var(--bg-tertiary);
  border-color: var(--border-light);
  color: var(--text-secondary);
}

.ribbon-btn.active {
  background-color: var(--bg-tertiary);
  border-color: #7aa2f7;
  color: #7aa2f7;
}

.ribbon-btn-prefix {
  font-size: 10px;
  font-weight: 700;
  color: #7aa2f7;
  letter-spacing: 0.3px;
}

.ribbon-btn-name {
  font-size: 10px;
  font-weight: 500;
  color: var(--text-secondary);
  max-width: 60px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.ribbon-btn:hover .ribbon-btn-name,
.ribbon-btn.active .ribbon-btn-name {
  color: var(--text-primary);
}

.ribbon-btn-icon {
  width: 14px;
  height: 14px;
  flex-shrink: 0;
}

.ribbon-btn-icon.template-selector-icon {
  border-radius: 3px;
}

.ribbon-input-row {
  margin-bottom: 6px;
}

.ribbon-input {
  width: 100%;
  padding: 5px 8px;
  font-size: 12px;
  color: var(--text-primary);
  background-color: var(--bg-primary);
  border: 1px solid var(--border-light);
  border-radius: 4px;
  outline: none;
  box-sizing: border-box;
}

.ribbon-input:focus {
  border-color: var(--accent-color);
}

/* ===== Editor Toolbar ===== */

.editor-toolbar-wrapper {
  position: relative;
  flex-shrink: 0;
  min-height: 16px;
}

.editor-toolbar-wrapper.visible {
  min-height: auto;
}

/* Click toggle button - shown when toolbar is hidden */
.editor-toolbar-toggle {
  width: 100%;
  height: 16px;
  background: transparent;
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-muted);
  opacity: 0.4;
}

.editor-toolbar-toggle:hover {
  opacity: 0.8;
  background: var(--bg-hover);
}

.editor-toolbar {
  display: flex;
  align-items: center;
  padding: 6px 12px;
  background: var(--bg-secondary);
  border-bottom: 1px solid var(--border-color);
  gap: 4px;
  flex-shrink: 0;
}

/* Close button in toolbar - same style as toggle */
.editor-toolbar-toggle-close {
  width: 24px;
  height: 24px;
  background: transparent;
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-muted);
  opacity: 0.5;
  margin-right: 8px;
  flex-shrink: 0;
}

.editor-toolbar-toggle-close:hover {
  opacity: 1;
  background: var(--bg-hover);
  border-radius: 4px;
}

.editor-toolbar-group {
  display: flex;
  align-items: center;
  gap: 1px;
  padding-right: 6px;
  margin-right: 4px;
  border-right: 1px solid var(--border-color);
  position: relative;
}

.editor-toolbar-group:last-child {
  border-right: none;
  padding-right: 0;
  margin-right: 0;
}

.editor-toolbar-btn {
  width: 26px;
  height: 24px;
  background: none;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  font-size: 12px;
  font-weight: 600;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 3px;
  padding: 0;
  flex-shrink: 0;
}

.editor-toolbar-btn:hover {
  background: var(--bg-hover);
  color: var(--text-primary);
}

.editor-toolbar-btn.active {
  background: #094771;
  color: #fff;
}

.editor-toolbar-btn.btn-small {
  font-size: 10px;
  width: 28px;
}

.editor-toolbar-dropdown-wrapper {
  position: relative;
}

.editor-toolbar-dropdown {
  position: absolute;
  top: 100%;
  left: 0;
  margin-top: 4px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border-light);
  border-radius: 4px;
  box-shadow: 0 4px 12px var(--shadow-color);
  z-index: 9999;
  min-width: 100px;
  padding: 4px 0;
  padding: 4px 0;
}

.editor-toolbar-dropdown-item {
  display: block;
  width: 100%;
  padding: 5px 12px;
  background: none;
  border: none;
  color: var(--text-primary);
  font-size: 12px;
  text-align: left;
  cursor: pointer;
}

.editor-toolbar-dropdown-item:hover {
  background: var(--accent-color);
  color: #ffffff;
}

/* ===== Code Viewer ===== */

.code-viewer-body {
  overflow: auto;
  background: var(--code-bg);
}

.code-viewer {
  display: flex;
  min-height: 100%;
  font-family: 'Consolas', 'Monaco', 'Fira Code', 'JetBrains Mono', monospace;
  font-size: 13px;
  line-height: 1.6;
}

.code-line-numbers {
  display: flex;
  flex-direction: column;
  padding: 14px 12px;
  text-align: right;
  color: var(--code-punctuation);
  background: var(--code-bg);
  user-select: none;
  border-right: 1px solid var(--code-border);
  min-width: 48px;
}

.code-line-numbers span {
  font-size: 12px;
  line-height: 1.6;
}

.code-content {
  flex: 1;
  margin: 0;
  padding: 14px 16px;
  overflow-x: auto;
  background: var(--code-bg);
  color: var(--code-text);
}

.code-content code {
  font-family: inherit;
  white-space: pre;
}

/* Code Viewer syntax highlighting */
.code-content .hljs-comment,
.code-content .hljs-quote { color: var(--code-comment); font-style: italic; }
.code-content .hljs-keyword,
.code-content .hljs-selector-tag { color: var(--code-keyword); }
.code-content .hljs-string,
.code-content .hljs-addition { color: var(--code-string); }
.code-content .hljs-number,
.code-content .hljs-literal { color: var(--code-number); }
.code-content .hljs-function,
.code-content .hljs-title { color: var(--code-function); }
.code-content .hljs-variable,
.code-content .hljs-deletion { color: var(--code-variable); }
.code-content .hljs-built_in,
.code-content .hljs-attr { color: var(--code-property); }
.code-content .hljs-symbol,
.code-content .hljs-bullet { color: var(--code-operator); }
.code-content .hljs-tag { color: var(--code-tag); }
.code-content .hljs-attribute { color: var(--code-attribute); }
.code-content .hljs-punctuation { color: var(--code-punctuation); }
.code-content .hljs-type,
.code-content .hljs-class { color: var(--code-type); }
.code-content .hljs-name { color: var(--code-tag); }
.code-content .hljs-section { color: var(--code-function); font-weight: bold; }
.code-content .hljs-meta { color: var(--code-comment); }

/* ===== TipTap Element Styles ===== */

/* Task List */
.tiptap-editor ul[data-type="taskList"] {
  list-style: none;
  padding-left: 0;
}

.tiptap-editor ul[data-type="taskList"] li {
  display: flex;
  align-items: flex-start;
  gap: 6px;
  padding: 2px 0;
}

.tiptap-editor ul[data-type="taskList"] li > label {
  flex-shrink: 0;
  display: flex;
  align-items: center;
  margin-top: 3px;
}

.tiptap-editor ul[data-type="taskList"] li > label input[type="checkbox"] {
  width: 14px;
  height: 14px;
  cursor: pointer;
  accent-color: #7aa2f7;
}

.tiptap-editor ul[data-type="taskList"] li > div {
  flex: 1;
}

.tiptap-editor ul[data-type="taskList"] li[data-checked="true"] > div {
  text-decoration: line-through;
  color: var(--text-muted);
}

/* Highlight */
.tiptap-editor mark {
  background-color: rgba(255, 224, 102, 0.3);
  color: inherit;
  border-radius: 2px;
  padding: 1px 2px;
}

/* Callout */
.tiptap-editor .callout {
  border-left: 4px solid var(--border-light);
  padding: 10px 14px;
  margin: 8px 0;
  border-radius: 4px;
  background: var(--bg-secondary);
}

.tiptap-editor .callout-info {
  border-left-color: #7aa2f7;
  background: rgba(122, 162, 247, 0.08);
}

.tiptap-editor .callout-warning {
  border-left-color: #e0af68;
  background: rgba(224, 175, 104, 0.08);
}

.tiptap-editor .callout-error {
  border-left-color: #f7768e;
  background: rgba(247, 118, 142, 0.08);
}

.tiptap-editor .callout-success {
  border-left-color: #9ece6a;
  background: rgba(158, 206, 106, 0.08);
}

.tiptap-editor .callout-note {
  border-left-color: #bb9af7;
  background: rgba(187, 154, 247, 0.08);
}

.tiptap-editor .callout-tip {
  border-left-color: #73daca;
  background: rgba(115, 218, 202, 0.08);
}

/* Table */
.tiptap-editor table {
  border-collapse: collapse;
  width: 100%;
  margin: 8px 0;
}

.tiptap-editor th,
.tiptap-editor td {
  border: 1px solid var(--border-color);
  padding: 6px 10px;
  text-align: left;
  min-width: 60px;
}

.tiptap-editor th {
  background: var(--bg-secondary);
  font-weight: 600;
  color: var(--text-primary);
}

.tiptap-editor td {
  background: transparent;
}

.tiptap-editor .selectedCell {
  background: rgba(122, 162, 247, 0.15);
}

/* Subscript / Superscript */
.tiptap-editor sub {
  font-size: 0.75em;
  vertical-align: sub;
}

.tiptap-editor sup {
  font-size: 0.75em;
  vertical-align: super;
}

/* Underline - inherits from browser default */

/* Horizontal Rule */
.tiptap-editor hr {
  border: none;
  border-top: 1px solid var(--border-color);
  margin: 12px 0;
}

/* Code Block improvements */
.tiptap-editor pre {
  background: var(--code-bg, #1e1e2e);
  border: 1px solid var(--code-border, #313244);
  border-radius: 8px;
  padding: 14px 18px;
  overflow-x: auto;
  margin: 10px 0;
}

.tiptap-editor pre code {
  font-family: 'Consolas', 'Monaco', 'Fira Code', 'JetBrains Mono', monospace;
  font-size: 13px;
  line-height: 1.6;
  color: var(--code-text, #cdd6f4);
  background: transparent;
}

/* Inline code */
.tiptap-editor code:not(pre code) {
  background: var(--code-inline-bg, rgba(122, 162, 247, 0.15));
  border-radius: 4px;
  padding: 2px 6px;
  font-size: 0.9em;
  color: var(--code-inline-text, #7aa2f7);
  font-family: 'Consolas', 'Monaco', 'Fira Code', monospace;
}

/* ===== Code Syntax Highlighting ===== */
/* Code syntax highlighting - works with highlight.js */
.tiptap-editor pre code .hljs-comment,
.tiptap-editor pre code .hljs-quote { color: var(--code-comment); font-style: italic; }
.tiptap-editor pre code .hljs-keyword,
.tiptap-editor pre code .hljs-selector-tag { color: var(--code-keyword); }
.tiptap-editor pre code .hljs-string,
.tiptap-editor pre code .hljs-addition { color: var(--code-string); }
.tiptap-editor pre code .hljs-number,
.tiptap-editor pre code .hljs-literal { color: var(--code-number); }
.tiptap-editor pre code .hljs-function,
.tiptap-editor pre code .hljs-title { color: var(--code-function); }
.tiptap-editor pre code .hljs-variable,
.tiptap-editor pre code .hljs-deletion { color: var(--code-variable); }
.tiptap-editor pre code .hljs-built_in,
.tiptap-editor pre code .hljs-attr { color: var(--code-property); }
.tiptap-editor pre code .hljs-symbol,
.tiptap-editor pre code .hljs-bullet { color: var(--code-operator); }
.tiptap-editor pre code .hljs-tag { color: var(--code-tag); }
.tiptap-editor pre code .hljs-attribute { color: var(--code-attribute); }
.tiptap-editor pre code .hljs-punctuation { color: var(--code-punctuation); }
.tiptap-editor pre code .hljs-type,
.tiptap-editor pre code .hljs-class { color: var(--code-type); }
.tiptap-editor pre code .hljs-name { color: var(--code-tag); }
.tiptap-editor pre code .hljs-section { color: var(--code-function); font-weight: bold; }
.tiptap-editor pre code .hljs-meta { color: var(--code-comment); }

/* Blockquote */
.tiptap-editor blockquote {
  border-left: 3px solid var(--border-light);
  padding-left: 14px;
  margin: 8px 0;
  color: var(--text-secondary);
}

/* ===== Editor Context Menu ===== */

.editor-context-menu {
  position: fixed;
  background: var(--bg-tertiary);
  border: 1px solid var(--border-light);
  border-radius: 6px;
  box-shadow: 0 6px 20px var(--shadow-color);
  padding: 4px 0;
  min-width: 180px;
  max-height: min(500px, calc(100vh - 80px));
  overflow-y: auto;
  z-index: 1000000 !important;
}

/* Editor context menu scrollbar */
.editor-context-menu::-webkit-scrollbar {
  width: 6px;
}

.editor-context-menu::-webkit-scrollbar-track {
  background: transparent;
}

.editor-context-menu::-webkit-scrollbar-thumb {
  background: var(--border-color, #3c3c3c);
  border-radius: 3px;
}

.editor-context-menu::-webkit-scrollbar-thumb:hover {
  background: var(--text-muted, #666666);
}

.editor-context-menu-item {
  display: flex;
  align-items: center;
  width: 100%;
  padding: 6px 12px;
  background: none;
  border: none;
  color: var(--text-primary);
  font-size: 12px;
  cursor: pointer;
  text-align: left;
  position: relative;
}

.editor-context-menu-item:hover {
  background: var(--bg-hover);
}

.editor-context-menu-item.active {
  color: #7aa2f7;
}

.editor-context-menu-item.active::before {
  content: '✓';
  position: absolute;
  left: 3px;
  font-size: 10px;
  color: #7aa2f7;
}

.editor-context-menu-item.delete {
  color: #f44;
}

.editor-context-menu-item.delete:hover {
  background: #4a2020;
}

.editor-context-menu-item.has-submenu {
  cursor: default;
  position: relative;
}

.editor-context-menu-item.has-submenu:hover {
  background: var(--bg-hover);
}

.editor-context-menu-item.ecm-memo-item {
  color: #7eb8da;
}

.editor-context-menu-item.ecm-memo-item:hover {
  background: #1e3a5f;
}

.ecm-label {
  flex: 1;
}

.ecm-shortcut {
  font-size: 11px;
  color: var(--text-muted);
  margin-left: 16px;
}

.ecm-arrow {
  font-size: 10px;
  color: var(--text-muted);
  margin-left: 8px;
}

.editor-context-menu-separator {
  height: 1px;
  background: var(--border-color);
  margin: 4px 8px;
}

.cell-color-preview {
  width: 16px;
  height: 16px;
  border-radius: 3px;
  border: 1px solid var(--border-light);
  margin-right: 8px;
  flex-shrink: 0;
}

/* Portal-based submenu (rendered to document.body) */
.editor-context-submenu-portal {
  position: fixed;
  background: var(--bg-tertiary);
  border: 1px solid var(--border-light);
  border-radius: 6px;
  box-shadow: 0 6px 20px var(--shadow-color);
  padding: 4px 0;
  min-width: 140px;
  z-index: 1000001;
}

/* Legacy submenu styles (for backward compatibility) */
.editor-context-submenu {
  position: absolute;
  left: calc(100% - 4px);
  top: -4px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border-light);
  border-radius: 6px;
  box-shadow: 0 6px 20px var(--shadow-color);
  padding: 4px 0;
  min-width: 140px;
  z-index: 1000001 !important;
}

/* 왼쪽으로 열리는 서브메뉴 */
.editor-context-submenu.submenu-left {
  left: auto;
  right: calc(100% - 4px);
}

/* ===== Comment System ===== */

.hover-editor-content-row {
  display: flex;
  flex-direction: row;
  flex: 1;
  overflow: hidden;
}

/* Only limit height for folder notes */
.hover-editor-content-row.is-folder-note {
  flex-shrink: 0;
  flex: none;
  max-height: 40%;
}

.hover-editor-content-row .hover-editor-body {
  flex: 1;
}

/* Comment highlight in editor */
.comment-highlight {
  background: rgba(187, 154, 247, 0.2);
  border-bottom: 2px solid #bb9af7;
  cursor: pointer;
}

/* ============================== Graph View ============================== */

.graph-view-container {
  width: 100%;
  height: 100%;
  position: relative;
  overflow: hidden;
  background: var(--bg-primary);
  flex: 1;
  min-height: 200px;
}

.graph-view-canvas {
  width: 100%;
  height: 100%;
}

.graph-view-canvas canvas {
  width: 100% !important;
  height: 100% !important;
}

.graph-loading,
.graph-empty {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  color: var(--text-muted);
  font-size: 13px;
}

/* Graph search bar */
.graph-search-bar {
  position: absolute;
  top: 8px;
  left: 8px;
  z-index: 10;
}

.graph-search-input {
  width: 180px;
  padding: 4px 8px;
  font-size: 12px;
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 4px;
  color: var(--text-primary);
  outline: none;
}

.graph-search-input:focus {
  border-color: var(--accent-color, #7c3aed);
}

/* Graph settings toggle */
.graph-settings-toggle {
  position: absolute;
  bottom: 32px;
  left: 8px;
  z-index: 10;
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 4px;
  color: var(--text-muted);
  cursor: pointer;
  padding: 0;
}

.graph-settings-toggle:hover {
  color: var(--text-primary);
  background: var(--bg-tertiary, var(--bg-secondary));
}

/* Graph settings panel */
.graph-settings-panel {
  position: absolute;
  bottom: 66px;
  left: 8px;
  width: 220px;
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  padding: 12px;
  z-index: 10;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.graph-settings-title {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 10px;
}

.graph-settings-section {
  margin-bottom: 10px;
  padding-bottom: 8px;
  border-bottom: 1px solid var(--border-color);
}

.graph-settings-section:last-of-type {
  border-bottom: none;
}

.graph-settings-subtitle {
  font-size: 11px;
  color: var(--text-muted);
  margin-bottom: 6px;
}

.graph-settings-label {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 12px;
  color: var(--text-primary);
  cursor: pointer;
  margin-bottom: 4px;
}

.graph-settings-label input[type="checkbox"] {
  margin: 0;
  cursor: pointer;
}

.graph-settings-color-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  font-size: 11px;
  color: var(--text-primary);
  margin-bottom: 4px;
}

.graph-settings-color-row input[type="color"] {
  width: 24px;
  height: 20px;
  border: 1px solid var(--border-color);
  border-radius: 3px;
  cursor: pointer;
  padding: 0;
  background: none;
}

.graph-settings-slider-row {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 11px;
  color: var(--text-primary);
  margin-bottom: 4px;
}

.graph-settings-slider-row span:first-child {
  min-width: 50px;
}

.graph-settings-slider-row input[type="range"] {
  flex: 1;
  height: 4px;
  cursor: pointer;
}

.graph-settings-slider-value {
  min-width: 30px;
  text-align: right;
  font-size: 10px;
  color: var(--text-muted);
}

.graph-settings-reset-btn {
  width: 100%;
  padding: 4px 8px;
  font-size: 11px;
  background: transparent;
  border: 1px solid var(--border-color);
  border-radius: 4px;
  color: var(--text-muted);
  cursor: pointer;
  margin-top: 4px;
}

.graph-settings-reset-btn:hover {
  color: var(--text-primary);
  border-color: var(--text-muted);
}

/* Graph legend bar */
.graph-legend-bar {
  position: absolute;
  bottom: 4px;
  right: 8px;
  display: flex;
  flex-wrap: wrap-reverse;
  justify-content: flex-end;
  gap: 4px 10px;
  font-size: 10px;
  color: var(--text-secondary);
  z-index: 5;
  pointer-events: none;
  max-width: 65%;
}

.graph-legend-item {
  display: flex;
  align-items: center;
  gap: 3px;
  white-space: nowrap;
}

.graph-legend-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  flex-shrink: 0;
}

.graph-legend-folder {
  border: 1.5px solid rgba(255, 255, 255, 0.5);
  box-sizing: border-box;
}

.graph-legend-diamond {
  border-radius: 0;
  transform: rotate(45deg);
  width: 7px;
  height: 7px;
}

/* Graph info bar */
.graph-info-bar {
  position: absolute;
  bottom: 4px;
  left: 8px;
  display: flex;
  gap: 12px;
  font-size: 11px;
  color: var(--text-muted);
  z-index: 5;
  pointer-events: none;
}

/* Comment Panel */
.comment-panel {
  width: 240px;
  border-left: 1px solid var(--border-color);
  background: var(--bg-primary);
  display: flex;
  flex-direction: column;
  overflow-y: auto;
  flex-shrink: 0;
}

.comment-panel-header {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 10px;
  border-bottom: 1px solid var(--border-color);
}

.comment-panel-title {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-primary);
}

.comment-panel-count {
  font-size: 10px;
  background: #bb9af7;
  color: #fff;
  border-radius: 8px;
  padding: 0 5px;
  font-weight: 700;
}

.comment-new {
  padding: 8px 10px;
  border-bottom: 1px solid var(--border-color);
  box-sizing: border-box;
}

.comment-new-anchor {
  font-size: 11px;
  color: var(--text-muted);
  font-style: italic;
  margin-bottom: 6px;
  word-break: break-all;
}

.comment-new-input {
  width: 100%;
  padding: 6px 8px;
  font-size: 12px;
  color: var(--text-primary);
  background: var(--bg-tertiary);
  border: 1px solid var(--border-light);
  border-radius: 4px;
  resize: vertical;
  min-height: 50px;
  outline: none;
  box-sizing: border-box;
  font-family: inherit;
}

.comment-new-input:focus {
  border-color: #bb9af7;
}

.comment-new-header {
  display: flex;
  align-items: center;
  margin-bottom: 6px;
}

.comment-new-mode-label {
  font-size: 11px;
  font-weight: 600;
  color: #bb9af7;
  letter-spacing: 0.3px;
}

.comment-new.task-mode .comment-new-mode-label {
  color: #7aa2f7;
}

.comment-new-actions {
  display: flex;
  gap: 6px;
  margin-top: 6px;
}

.comment-add-btn {
  padding: 4px 10px;
  font-size: 11px;
  background: #bb9af7;
  color: #fff;
  border: none;
  border-radius: 3px;
  cursor: pointer;
  font-weight: 600;
}

.comment-new.task-mode .comment-add-btn {
  background: #7aa2f7;
}

.comment-add-btn:disabled {
  opacity: 0.4;
  cursor: default;
}

.comment-cancel-btn {
  padding: 4px 10px;
  font-size: 11px;
  background: transparent;
  color: var(--text-muted);
  border: 1px solid var(--border-light);
  border-radius: 3px;
  cursor: pointer;
}

.comment-cancel-btn:hover {
  color: var(--text-primary);
  border-color: var(--text-muted);
}

.comment-list {
  flex: 1;
  overflow-y: auto;
}

.comment-empty {
  padding: 16px 10px;
  font-size: 11px;
  color: var(--text-muted);
  text-align: center;
}

.comment-item {
  padding: 8px 10px;
  border-bottom: 1px solid var(--bg-secondary);
}

.comment-item.active {
  background: rgba(187, 154, 247, 0.08);
  border-left: 3px solid #bb9af7;
}

.comment-item.resolved {
  opacity: 0.6;
}

.comment-item-anchor {
  font-size: 10px;
  color: var(--text-muted);
  font-style: italic;
  margin-bottom: 4px;
  word-break: break-all;
}

.comment-item-content {
  font-size: 12px;
  color: var(--text-primary);
  white-space: pre-wrap;
  word-break: break-word;
}

.comment-item-footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-top: 6px;
}

.comment-item-date {
  font-size: 10px;
  color: var(--text-muted);
}

.comment-item-actions {
  display: flex;
  gap: 4px;
}

.comment-action-btn {
  width: 20px;
  height: 20px;
  background: none;
  border: 1px solid var(--border-light);
  border-radius: 3px;
  color: var(--text-secondary);
  cursor: pointer;
  font-size: 11px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.comment-action-btn:hover {
  background: var(--bg-tertiary);
  color: var(--text-primary);
}

.comment-delete-btn:hover {
  background: #f7768e33;
  border-color: #f7768e;
  color: #f7768e;
}

.comment-resolved-section {
  border-top: 1px solid var(--border-color);
  padding: 4px 0;
}

.comment-resolved-toggle {
  width: 100%;
  padding: 6px 10px;
  background: none;
  border: none;
  color: var(--text-muted);
  font-size: 11px;
  text-align: left;
  cursor: pointer;
}

.comment-resolved-toggle:hover {
  color: var(--text-primary);
}

/* Comment Task Fields */
.comment-task-fields {
  margin-top: 8px;
  padding: 10px 8px 8px 8px;
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 4px;
  box-sizing: border-box;
  overflow: hidden;
}

.comment-task-field {
  display: flex;
  flex-direction: column;
  gap: 3px;
  margin-bottom: 10px;
  min-width: 0;
  overflow: hidden;
}

.comment-task-field:last-child {
  margin-bottom: 0;
}

.comment-task-field label {
  font-size: 10px;
  color: #999;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.3px;
}

.comment-task-field input {
  width: 100%;
  max-width: 100%;
  padding: 5px 7px;
  font-size: 11px;
  color: var(--text-primary);
  background: var(--bg-primary);
  border: 1px solid var(--border-light);
  border-radius: 3px;
  outline: none;
  box-sizing: border-box;
  transition: border-color 0.2s;
  min-width: 0;
}

.comment-task-field input:focus {
  border-color: #bb9af7;
  background: var(--bg-secondary);
}


/* Comment Task Display */
.comment-item.task {
  border-left: 3px solid #7dcfff;
}

.comment-item.resolved {
  opacity: 0.6;
}

.comment-item.resolved .comment-item-content,
.comment-item.resolved .comment-task-note {
  text-decoration: line-through;
  color: var(--text-muted);
}

.comment-task-content {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.comment-task-header {
  display: flex;
  align-items: flex-start;
  gap: 8px;
}

.comment-task-checkbox {
  width: 16px;
  height: 16px;
  margin-top: 2px;
  cursor: pointer;
  flex-shrink: 0;
  accent-color: #7dcfff;
}

.comment-task-title {
  flex: 1;
  font-size: 12px;
  font-weight: 600;
  color: var(--text-primary);
  line-height: 1.4;
  word-break: break-word;
}

.comment-task-title.completed {
  text-decoration: line-through;
  color: var(--text-muted);
}

.comment-task-meta {
  display: flex;
  flex-direction: column;
  gap: 4px;
  margin-left: 24px;
  font-size: 10px;
  color: var(--text-secondary);
  margin-top: 4px;
}

.comment-task-date {
  color: #9ece6a;
}

.comment-task-time {
  color: #7dcfff;
}

.comment-task-note {
  margin-left: 24px;
  font-size: 11px;
  color: var(--text-secondary);
  font-style: italic;
  line-height: 1.3;
}

/* Comment Edit Mode */
.comment-edit-mode {
  display: flex;
  flex-direction: column;
  gap: 8px;
  width: 100%;
}

.comment-edit-input {
  width: 100%;
  padding: 8px;
  background-color: var(--bg-primary);
  border: 1px solid var(--border-color);
  border-radius: 4px;
  color: var(--text-secondary);
  font-family: inherit;
  font-size: 12px;
  resize: vertical;
  min-height: 60px;
}

.comment-edit-input:focus {
  outline: none;
  border-color: #007acc;
}

.comment-edit-actions {
  display: flex;
  gap: 6px;
  justify-content: flex-end;
}

.comment-edit-save-btn,
.comment-edit-cancel-btn {
  padding: 6px 12px;
  border: none;
  border-radius: 4px;
  font-size: 11px;
  cursor: pointer;
  font-weight: 500;
}

.comment-edit-save-btn {
  background-color: #007acc;
  color: #ffffff;
}

.comment-edit-save-btn:hover {
  background-color: #005a9e;
}

.comment-edit-cancel-btn {
  background-color: var(--bg-tertiary);
  color: var(--text-secondary);
}

.comment-edit-cancel-btn:hover {
  background-color: var(--bg-hover);
}

.comment-task-complete span {
  user-select: none;
}

/* ===== Keyboard Shortcuts ===== */

.keyboard-shortcuts {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

/* Keyboard Layout */
.keyboard-layout {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  padding: 16px;
  background: var(--bg-tertiary, #1e1e28);
  border-radius: 12px;
  margin-bottom: 8px;
}

.keyboard-row {
  display: flex;
  gap: 4px;
}

.keyboard-key {
  width: 36px;
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  background: var(--bg-secondary, #252530);
  border: 1px solid var(--border-color, #3c3c3c);
  border-radius: 6px;
  font-size: 11px;
  font-weight: 500;
  color: var(--text-secondary, #888);
  transition: all 0.15s;
  cursor: default;
}

.keyboard-key:hover {
  background: var(--bg-hover, #2a2a2a);
  border-color: var(--border-light, #4c4c4c);
}

.keyboard-key.has-binding {
  background: rgba(0, 255, 213, 0.12);
  border-color: rgba(0, 255, 213, 0.3);
  color: var(--text-primary, #e0e0e0);
}

.keyboard-key.has-binding:hover {
  background: rgba(0, 255, 213, 0.2);
  border-color: rgba(0, 255, 213, 0.5);
}

.keyboard-key-label {
  font-family: inherit;
}

.keyboard-key-dot {
  position: absolute;
  bottom: 4px;
  right: 4px;
  width: 4px;
  height: 4px;
  background: var(--accent, #00ffd5);
  border-radius: 50%;
}

/* Category Filter */
.shortcuts-filter {
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
  padding: 4px;
  background: var(--bg-tertiary, #1e1e28);
  border-radius: 8px;
}

.shortcuts-filter-btn {
  padding: 8px 14px;
  background: transparent;
  border: none;
  border-radius: 6px;
  color: var(--text-secondary, #888);
  font-size: 12px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.15s;
}

.shortcuts-filter-btn:hover {
  background: var(--bg-hover, #2a2a2a);
  color: var(--text-primary, #e0e0e0);
}

.shortcuts-filter-btn.active {
  background: var(--accent, #00ffd5);
  color: #1a1a2e;
  font-weight: 600;
}

/* Shortcuts Table */
.shortcuts-table {
  display: flex;
  flex-direction: column;
  gap: 4px;
  max-height: 340px;
  overflow-y: auto;
  padding-right: 4px;
}

.shortcuts-table::-webkit-scrollbar {
  width: 6px;
}

.shortcuts-table::-webkit-scrollbar-track {
  background: transparent;
}

.shortcuts-table::-webkit-scrollbar-thumb {
  background: var(--border-color, #3c3c3c);
  border-radius: 3px;
}

.shortcuts-row {
  display: flex;
  align-items: center;
  padding: 10px 12px;
  border-radius: 8px;
  background: var(--bg-tertiary, #1e1e28);
  border: 1px solid transparent;
  transition: all 0.15s;
}

.shortcuts-row:hover {
  border-color: var(--border-light, #3c3c3c);
  background: var(--bg-secondary, #252530);
}

.shortcuts-row.customized {
  background: rgba(0, 255, 213, 0.06);
  border-color: rgba(0, 255, 213, 0.2);
}

.shortcuts-label {
  flex: 1;
  font-size: 13px;
  color: var(--text-primary, #e0e0e0);
  font-weight: 500;
}

.shortcuts-keys {
  display: flex;
  align-items: center;
  gap: 6px;
}

.shortcuts-key-btn {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 6px 12px;
  background: var(--bg-primary, #1a1a2e);
  border: 1px solid var(--border-color, #3c3c3c);
  border-radius: 6px;
  color: var(--text-secondary, #aaa);
  font-size: 12px;
  cursor: pointer;
  transition: all 0.15s;
  min-width: 80px;
  justify-content: center;
}

.shortcuts-key-btn:hover {
  border-color: var(--accent, #00ffd5);
  background: var(--bg-hover, #2a2a2a);
}

.shortcut-mod {
  font-size: 11px;
  color: var(--text-muted, #666);
  font-weight: 500;
}

.shortcut-key {
  font-weight: 700;
  color: var(--text-primary, #e0e0e0);
  font-size: 12px;
}

.shortcuts-edit-input {
  padding: 6px 12px;
  width: 180px;
  background: var(--bg-primary, #1a1a2e);
  border: 2px solid var(--accent, #00ffd5);
  border-radius: 6px;
  color: var(--text-primary, #e0e0e0);
  font-size: 12px;
  outline: none;
  text-align: center;
}

.shortcuts-edit-input::placeholder {
  color: var(--text-tertiary, #555);
  font-size: 11px;
}

.shortcuts-reset-btn {
  width: 28px;
  height: 28px;
  background: transparent;
  border: 1px solid var(--border-color, #3c3c3c);
  border-radius: 6px;
  color: var(--text-muted, #666);
  cursor: pointer;
  font-size: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.15s;
}

.shortcuts-reset-btn:hover {
  color: var(--accent, #00ffd5);
  border-color: var(--accent, #00ffd5);
  background: rgba(0, 255, 213, 0.08);
}

/* ===== Suggestion Triggers ===== */

.suggestion-triggers-section {
  margin-top: 24px;
  padding-top: 20px;
  border-top: 1px solid var(--border-color, #3c3c3c);
}

.suggestion-triggers-section .settings-section-desc {
  font-size: 13px;
  color: var(--text-muted, #888);
  margin-bottom: 16px;
  line-height: 1.5;
}

.suggestion-triggers-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.suggestion-trigger-item {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 12px 16px;
  background: var(--bg-primary, #1a1a2e);
  border: 1px solid var(--border-color, #3c3c3c);
  border-radius: 8px;
}

.trigger-code {
  font-family: 'JetBrains Mono', 'Fira Code', monospace;
  font-size: 14px;
  font-weight: 600;
  color: var(--accent, #00ffd5);
  background: rgba(0, 255, 213, 0.1);
  padding: 4px 12px;
  border-radius: 4px;
  min-width: 50px;
  text-align: center;
}

.trigger-desc {
  font-size: 13px;
  color: var(--text-secondary, #aaa);
  flex: 1;
}

html[data-theme="light"] .trigger-code {
  color: #0969da;
  background: rgba(9, 105, 218, 0.1);
}

html[data-theme="light"] .suggestion-trigger-item {
  background: #f6f8fa;
  border-color: #d0d7de;
}

/* ===== Vault Selector ===== */

.vault-selector-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: var(--bg-primary);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
}

.vault-selector-container {
  position: relative;
  width: 600px;
  max-width: 90%;
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  padding: 40px;
  display: flex;
  flex-direction: column;
  gap: 32px;
}

.vault-selector-close-btn {
  position: absolute;
  top: 12px;
  right: 12px;
  width: 32px;
  height: 32px;
  padding: 0;
  background: transparent;
  border: none;
  border-radius: 4px;
  color: var(--text-muted);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.15s ease;
}

.vault-selector-close-btn:hover {
  background: var(--bg-hover);
  color: var(--text-primary);
}

.vault-selector-header {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
  padding-bottom: 8px;
}

.vault-selector-logo {
  width: 72px;
  height: 72px;
  margin-bottom: 4px;
  filter: drop-shadow(0 2px 8px rgba(122, 162, 247, 0.15));
}

.vault-selector-title-row {
  display: flex;
  align-items: baseline;
  gap: 8px;
}

.vault-selector-title {
  font-size: 28px;
  font-weight: 700;
  color: var(--text-primary);
  margin: 0;
  letter-spacing: -0.5px;
}

.vault-selector-version {
  font-size: 11px;
  font-weight: 500;
  color: var(--text-muted);
  background: var(--bg-tertiary);
  padding: 2px 6px;
  border-radius: 4px;
  border: 1px solid var(--border-color);
}

.vault-selector-subtitle {
  font-size: 13px;
  color: var(--text-muted);
  margin: 0;
}

.vault-selector-body {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.vault-selector-btn {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 20px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border-color);
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.15s ease;
}

.vault-selector-btn:hover {
  background: var(--bg-hover);
  border-color: #7aa2f7;
}

.vault-selector-btn-primary {
  border-color: #7aa2f7;
}

.vault-selector-btn-primary:hover {
  background: var(--bg-hover);
  border-color: #89b4fa;
}

.vault-selector-btn-secondary {
  border-color: var(--border-light);
}

.vault-selector-btn-secondary:hover {
  background: var(--bg-hover);
  border-color: #7aa2f7;
}

.vault-selector-icon {
  flex-shrink: 0;
  color: #7aa2f7;
}

.vault-selector-btn-text {
  display: flex;
  flex-direction: column;
  gap: 4px;
  text-align: left;
}

.vault-selector-btn-title {
  font-size: 16px;
  font-weight: 600;
  color: var(--text-primary);
}

.vault-selector-btn-desc {
  font-size: 12px;
  color: var(--text-muted);
}

.vault-selector-footer {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  padding-top: 8px;
  border-top: 1px solid var(--border-color);
}

.vault-selector-hint {
  font-size: 12px;
  color: var(--text-muted);
  margin: 0;
}

.vault-selector-exit-btn {
  padding: 6px 20px;
  font-size: 12px;
  color: var(--text-muted);
  background: transparent;
  border: 1px solid var(--border-color);
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.15s ease;
}

.vault-selector-exit-btn:hover {
  color: var(--text-primary);
  border-color: var(--text-muted);
}

.vault-selector-recent {
  margin-bottom: 24px;
}

.vault-selector-recent-title {
  font-size: 14px;
  font-weight: 600;
  color: var(--text-muted);
  margin: 0 0 12px 0;
}

.vault-selector-recent-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
  max-height: 240px;
  overflow-y: auto;
  padding-right: 8px;
}

.vault-selector-recent-item-wrapper {
  display: flex;
  align-items: stretch;
  gap: 8px;
}

.vault-selector-recent-item {
  flex: 1;
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 16px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border-color);
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.15s ease;
  text-align: left;
}

.vault-selector-recent-item:hover {
  background: var(--bg-hover);
  border-color: #7aa2f7;
}

.vault-selector-recent-item.current {
  background: #264f78;
  border-color: #007acc;
  color: #ffffff;
  cursor: default;
  opacity: 0.9;
}

.vault-selector-recent-item.current:hover {
  background: #264f78;
  border-color: #007acc;
  color: #ffffff;
}

/* Override nested element colors when current */
.vault-selector-recent-item.current .vault-selector-recent-icon,
.vault-selector-recent-item.current .vault-selector-recent-name,
.vault-selector-recent-item.current .vault-selector-recent-path {
  color: #ffffff;
}

.vault-selector-current-badge {
  margin-left: 8px;
  padding: 2px 6px;
  font-size: 10px;
  font-weight: 600;
  background: rgba(255, 255, 255, 0.2);
  color: #ffffff;
  border-radius: 4px;
}

.vault-selector-delete-btn {
  flex-shrink: 0;
  width: 36px;
  padding: 8px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border-color);
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.15s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-muted);
}

.vault-selector-delete-btn:hover {
  background: #3c1f1f;
  border-color: #e06c75;
  color: #e06c75;
}

.vault-selector-recent-icon {
  flex-shrink: 0;
  color: #7aa2f7;
}

.vault-selector-recent-text {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 4px;
  min-width: 0;
}

.vault-selector-recent-name {
  font-size: 14px;
  font-weight: 600;
  color: var(--text-primary);
}

.vault-selector-recent-path {
  font-size: 11px;
  color: var(--text-muted);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* ============================================
   Contact Input Modal
   ============================================ */

.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
}

/* New Container Modal */
.new-container-modal {
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  width: 320px;
  max-width: 90vw;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.new-container-modal-header {
  font-size: 14px;
  font-weight: 600;
  color: var(--text-primary);
}

.new-container-modal-input {
  width: 100%;
  padding: 10px 12px;
  font-size: 13px;
  background-color: var(--bg-primary);
  border: 1px solid var(--border-color);
  border-radius: 4px;
  color: var(--text-primary);
  outline: none;
  box-sizing: border-box;
}

.new-container-modal-input:focus {
  border-color: #007acc;
}

.new-container-modal-input::placeholder {
  color: var(--text-muted);
}

.new-container-modal-actions {
  display: flex;
  gap: 8px;
  justify-content: flex-end;
}

.new-container-modal-btn {
  padding: 8px 16px;
  font-size: 13px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-weight: 500;
}

.new-container-modal-btn.cancel {
  background-color: var(--bg-tertiary);
  color: var(--text-secondary);
}

.new-container-modal-btn.cancel:hover {
  background-color: var(--bg-hover);
}

.new-container-modal-btn.create {
  background-color: #007acc;
  color: #ffffff;
}

.new-container-modal-btn.create:hover:not(:disabled) {
  background-color: #0098ff;
}

.new-container-modal-btn.create:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.contact-input-modal {
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  width: 480px;
  max-width: 90vw;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
  display: flex;
  flex-direction: column;
}

.contact-input-header {
  padding: 14px 18px;
  border-bottom: 1px solid var(--border-color);
  font-size: 15px;
  font-weight: 600;
  color: var(--text-primary);
  cursor: move;
  user-select: none;
  flex-shrink: 0;
}

.contact-input-body {
  padding: 18px;
  display: flex;
  flex-direction: column;
  gap: 14px;
  overflow: visible;
}

/* TagInputSection inside ContactInputModal - scrollable content */
.contact-input-body .tag-input-section-content {
  max-height: 150px;
  overflow-y: auto;
  overflow-x: hidden;
}

.contact-input-field {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.contact-input-label {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.contact-input-input {
  padding: 8px 12px;
  font-size: 14px;
  background-color: var(--bg-primary);
  border: 1px solid var(--border-color);
  border-radius: 4px;
  color: var(--text-primary);
  outline: none;
  transition: border-color 0.2s;
}

.contact-input-input:focus {
  border-color: #007acc;
}

.contact-input-input::placeholder {
  color: var(--text-muted);
}

.contact-input-actions {
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  padding: 12px 18px;
  border-top: 1px solid var(--border-color);
  flex-shrink: 0;
}

.contact-input-btn {
  padding: 8px 18px;
  font-size: 13px;
  font-weight: 500;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.2s;
}

.contact-input-cancel {
  background-color: transparent;
  color: var(--text-secondary);
  border: 1px solid var(--border-color);
}

.contact-input-cancel:hover {
  background-color: var(--bg-tertiary);
  color: var(--text-primary);
}

.contact-input-submit {
  background-color: #007acc;
  color: #ffffff;
}

.contact-input-submit:hover {
  background-color: #0098ff;
}

/* ============================================
   Canvas Editor
   ============================================ */

.canvas-editor {
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  background-color: var(--bg-primary);
  position: relative;
}

.canvas-toolbar {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  background-color: var(--bg-tertiary);
  border-bottom: 1px solid var(--border-color);
}

.canvas-toolbar-btn {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 6px 12px;
  font-size: 12px;
  background-color: var(--bg-hover);
  border: none;
  border-radius: 4px;
  color: var(--text-primary);
  cursor: pointer;
  transition: background-color 0.2s;
}

.canvas-toolbar-btn:hover {
  background-color: var(--border-color);
}

.canvas-toolbar-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.canvas-toolbar-btn.active {
  background-color: #007acc;
  color: #fff;
}

.canvas-toolbar-btn.active:hover {
  background-color: #005a9e;
}

.canvas-toolbar-hint {
  flex: 1;
  font-size: 11px;
  color: var(--text-muted);
  padding-left: 8px;
}

.canvas-viewport {
  flex: 1;
  position: relative;
  overflow: hidden;
  cursor: grab;
  user-select: none;
  -webkit-user-select: none;
}

.canvas-viewport:active {
  cursor: grabbing;
}

/* Cursor modes for different operations */
.canvas-viewport.is-panning {
  cursor: grabbing;
}

.canvas-viewport.is-selecting {
  cursor: crosshair;
}

.canvas-viewport.is-connecting {
  cursor: crosshair;
}

/* Prevent text selection during drag operations */
.canvas-viewport.is-dragging,
.canvas-viewport.is-dragging * {
  user-select: none !important;
  -webkit-user-select: none !important;
}

.canvas-svg {
  position: absolute;
  top: 0;
  left: 0;
  width: 10000px;
  height: 10000px;
  overflow: visible;
  z-index: 1;
  pointer-events: none;
}

.canvas-svg path {
  pointer-events: auto;
}

.canvas-edge {
  transition: stroke 0.2s;
}

.canvas-edge:hover {
  stroke: #007acc !important;
}

.canvas-edge.selected {
  stroke: #007acc !important;
}

.canvas-nodes {
  position: absolute;
  top: 0;
  left: 0;
  width: 10000px;
  height: 10000px;
  z-index: 10;
  pointer-events: none;
}

.canvas-node {
  position: absolute;
  border: 2px solid var(--border-light);
  border-radius: 8px;
  padding: 12px;
  cursor: move;
  box-shadow: 0 2px 8px var(--shadow-color);
  transition: border-color 0.2s, box-shadow 0.2s;
  pointer-events: auto;
  box-sizing: border-box;
  isolation: isolate;
}

/* Prevent text selection when dragging nodes */
.canvas-viewport.is-dragging .canvas-node,
.canvas-viewport.is-dragging .canvas-node-text {
  user-select: none !important;
  -webkit-user-select: none !important;
  pointer-events: none !important;
}

.canvas-node.file-node {
  border-radius: 0;
  display: flex;
  align-items: center;
  justify-content: center;
}

.canvas-node:hover {
  border-color: #00d4aa;
  box-shadow: 0 4px 12px rgba(0, 212, 170, 0.3);
}

.canvas-node.selected {
  border-color: #00d4aa;
  box-shadow: 0 0 0 2px rgba(0, 212, 170, 0.5);
}

.canvas-node.multi-selected {
  border-color: #00d4aa;
  box-shadow: 0 0 0 2px rgba(0, 212, 170, 0.5);
}

/* Multi-selected special shapes - no outline, use SVG stroke instead */
.canvas-node.shape-decision.multi-selected,
.canvas-node.shape-io.multi-selected,
.canvas-node.shape-database.multi-selected,
.canvas-node.shape-decision.selected,
.canvas-node.shape-io.selected,
.canvas-node.shape-database.selected {
  outline: none;
}

.canvas-node.hovered {
  border-color: #00d4aa;
}

.canvas-node.connecting {
  border-color: #00d4aa;
  box-shadow: 0 0 0 3px rgba(0, 212, 170, 0.6);
}

/* Shape-specific styles */
.canvas-node.shape-process {
  border-radius: 0;
  display: flex;
  align-items: center;
  justify-content: center;
}

.canvas-node.shape-process.selected,
.canvas-node.shape-process:hover {
  border-width: 3px;
}

.canvas-node.shape-terminal {
  border-radius: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.canvas-node.shape-terminal.selected,
.canvas-node.shape-terminal:hover {
  border-width: 3px;
}

.canvas-node.shape-decision {
  border: none;
  border-radius: 0;
  padding: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: visible;
  background: transparent;
  box-shadow: none !important;
  box-sizing: border-box;
  cursor: move !important;
  /* Disable rectangular hit area - let SVG shape handle events */
  pointer-events: none;
}

/* Re-enable pointer events for interactive children within decision shape */
.canvas-node.shape-decision .canvas-node-text,
.canvas-node.shape-decision .canvas-node-handle,
.canvas-node.shape-decision .canvas-node-resize,
.canvas-node.shape-decision .canvas-node-delete {
  pointer-events: auto !important;
}

/* Hit area overlay for special shapes - border only, above content */
.canvas-node-shape-hit-area {
  pointer-events: none;
  z-index: 100 !important;
}

.canvas-node-shape-hit-area polygon {
  pointer-events: stroke !important;
  cursor: move !important;
}

.canvas-node.shape-decision .canvas-node-text {
  text-align: center;
  width: 100%;
  height: 100%;
  padding: 25%;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  overflow: hidden;
  word-wrap: break-word;
  pointer-events: auto;
  z-index: 10;
}

.canvas-node.shape-io {
  border: none;
  border-radius: 0;
  padding: 12px 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: visible;
  background: transparent;
  box-shadow: none !important;
  box-sizing: border-box;
  /* Disable rectangular hit area - let SVG shape handle events */
  pointer-events: none;
}

/* Re-enable pointer events for interactive children within io shape */
.canvas-node.shape-io .canvas-node-text,
.canvas-node.shape-io .canvas-node-handle,
.canvas-node.shape-io .canvas-node-resize,
.canvas-node.shape-io .canvas-node-delete {
  pointer-events: auto;
}

.canvas-node.shape-io .canvas-node-text {
  text-align: center;
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  overflow: hidden;
  pointer-events: auto;
  z-index: 10;
}

.canvas-node.shape-subroutine {
  border-radius: 0;
  position: relative;
  padding: 12px 20px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.canvas-node.shape-subroutine::before,
.canvas-node.shape-subroutine::after {
  content: '';
  position: absolute;
  top: 0;
  bottom: 0;
  width: 2px;
  background-color: #666;
}

.canvas-node.shape-subroutine::before {
  left: 8px;
}

.canvas-node.shape-subroutine::after {
  right: 8px;
}

.canvas-node.shape-subroutine:hover::before,
.canvas-node.shape-subroutine:hover::after {
  background-color: #00d4aa;
}

.canvas-node.shape-subroutine.selected::before,
.canvas-node.shape-subroutine.selected::after {
  background-color: #00d4aa;
  width: 3px;
}

.canvas-node.shape-subroutine.selected {
  border-color: #00d4aa;
  border-width: 3px;
}

.canvas-node.shape-subroutine.connecting::before,
.canvas-node.shape-subroutine.connecting::after {
  background-color: #00d4aa;
  width: 3px;
}

.canvas-node.shape-subroutine.connecting {
  border-color: #00d4aa;
  border-width: 3px;
}

.canvas-node.shape-database {
  border: none;
  border-radius: 0;
  padding: 36px 16px 12px 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: visible;
  background: transparent;
  box-shadow: none !important;
  box-sizing: border-box;
}

.canvas-node.shape-database .canvas-node-text {
  text-align: center;
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  overflow: hidden;
  pointer-events: auto;
  z-index: 10;
}

.canvas-node-handle {
  position: absolute;
  width: 12px;
  height: 12px;
  background-color: #00d4aa;
  border: 2px solid #2d2d2d;
  border-radius: 50%;
  cursor: pointer;
  z-index: 35;
  transition: transform 0.15s, background-color 0.15s;
  box-shadow: 0 2px 6px rgba(0, 212, 170, 0.5);
  pointer-events: auto;
}

/* Larger invisible hit area for easier clicking */
.canvas-node-handle::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 28px;
  height: 28px;
  border-radius: 50%;
}

.canvas-node-handle:hover {
  background-color: #00ffcc;
  transform: scale(1.2);
  box-shadow: 0 3px 10px rgba(0, 255, 204, 0.7);
}

.canvas-node-handle-top {
  top: -6px;
  left: 50%;
  transform: translateX(-50%);
}

.canvas-node-handle-top:hover {
  transform: translateX(-50%) scale(1.2);
}

.canvas-node-handle-right {
  right: -6px;
  top: 50%;
  transform: translateY(-50%);
}

.canvas-node-handle-right:hover {
  transform: translateY(-50%) scale(1.2);
}

.canvas-node-handle-bottom {
  bottom: -6px;
  left: 50%;
  transform: translateX(-50%);
}

.canvas-node-handle-bottom:hover {
  transform: translateX(-50%) scale(1.2);
}

.canvas-node-handle-left {
  left: -6px;
  top: 50%;
  transform: translateY(-50%);
}

.canvas-node-handle-left:hover {
  transform: translateY(-50%) scale(1.2);
}

/* Parallelogram (I/O) shape-specific handle positions */
.canvas-node.shape-io .canvas-node-handle-top {
  left: 57.5%; /* Parallelogram top center: (0.15 + 1) / 2 = 0.575 */
}

.canvas-node.shape-io .canvas-node-handle-bottom {
  left: 42.5%; /* Parallelogram bottom center: 0.85 / 2 = 0.425 */
}

.canvas-node.shape-io .canvas-node-handle-left {
  left: 1px; /* Parallelogram left center x offset */
  top: 50%;
}

.canvas-node.shape-io .canvas-node-handle-right {
  right: 1px; /* Parallelogram right center x offset */
  top: 50%;
}

/* Resize handles */
.canvas-node-resize {
  position: absolute;
  background-color: #fff;
  border: 2px solid #007acc;
  z-index: 32;
  pointer-events: auto;
  transition: background-color 0.2s, border-color 0.2s, transform 0.2s;
}

.canvas-node-resize-n,
.canvas-node-resize-s {
  width: 40px;
  height: 6px;
  left: 50%;
  transform: translateX(-50%);
  cursor: ns-resize;
}

.canvas-node-resize-e,
.canvas-node-resize-w {
  width: 6px;
  height: 40px;
  top: 50%;
  transform: translateY(-50%);
  cursor: ew-resize;
}

.canvas-node-resize-n {
  top: -3px;
}

.canvas-node-resize-s {
  bottom: -3px;
}

.canvas-node-resize-e {
  right: -3px;
}

.canvas-node-resize-w {
  left: -3px;
}

.canvas-node-resize-ne,
.canvas-node-resize-se,
.canvas-node-resize-sw,
.canvas-node-resize-nw {
  width: 14px;
  height: 14px;
  border-radius: 50%;
}

.canvas-node-resize-ne {
  top: -6px;
  right: -6px;
  cursor: nesw-resize;
}

.canvas-node-resize-se {
  bottom: -6px;
  right: -6px;
  cursor: nwse-resize;
}

.canvas-node-resize-sw {
  bottom: -6px;
  left: -6px;
  cursor: nesw-resize;
}

.canvas-node-resize-nw {
  top: -6px;
  left: -6px;
  cursor: nwse-resize;
}

.canvas-node-resize:hover {
  background-color: #007acc;
  border-color: #00d4aa;
  transform: scale(1.2);
}

/* Special shapes need visible handles and resize controls */
.canvas-node.shape-decision,
.canvas-node.shape-io,
.canvas-node.shape-database {
  /* Keep position: absolute from base class - do NOT change to relative */
}

.canvas-node.shape-decision .canvas-node-handle,
.canvas-node.shape-io .canvas-node-handle,
.canvas-node.shape-database .canvas-node-handle,
.canvas-node.shape-decision .canvas-node-resize,
.canvas-node.shape-io .canvas-node-resize,
.canvas-node.shape-database .canvas-node-resize {
  z-index: 100 !important;
  pointer-events: auto !important;
  position: absolute !important;
}

/* Delete button consistent position for all shapes - top right corner */
.canvas-node .canvas-node-delete {
  position: absolute !important;
  top: -14px !important;
  right: -14px !important;
  z-index: 200 !important;
  pointer-events: auto !important;
}

/* SVG border overlay */
.canvas-node-border-svg,
.canvas-node-shape-svg {
  z-index: -1 !important;
  pointer-events: none !important;
}

.canvas-node-text {
  width: 100%;
  height: 100%;
  background: transparent;
  border: none;
  color: var(--text-primary);
  font-size: 13px;
  font-family: inherit;
  outline: none;
  resize: none;
  padding: 0;
  pointer-events: auto;
  cursor: text;
}

.canvas-node-text::placeholder {
  color: var(--text-muted);
}

.canvas-node-delete {
  position: absolute;
  top: -14px;
  right: -14px;
  width: 28px;
  height: 28px;
  border-radius: 50%;
  background-color: #dc3545;
  border: 3px solid var(--bg-primary);
  color: #fff;
  font-size: 20px;
  font-family: Arial, sans-serif;
  font-weight: normal;
  line-height: 1;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  padding-bottom: 3px;
  transition: background-color 0.2s, transform 0.1s;
  pointer-events: auto;
  z-index: 200;
  box-shadow: 0 2px 6px var(--shadow-color);
}

.canvas-node-delete:hover {
  background-color: #c82333;
  transform: scale(1.1);
}

.canvas-node-delete:active {
  transform: scale(0.9);
}

.canvas-node-file {
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: space-between;
  gap: 4px;
  padding: 12px 8px 8px 8px;
  pointer-events: auto;
}

.canvas-node-file-preview {
  flex: 1;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  border-radius: 4px;
  position: relative;
}

.canvas-node-file-preview img {
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
}

.canvas-node-file-ext-badge {
  position: absolute;
  top: 4px;
  right: 4px;
  background-color: rgba(0, 122, 204, 0.9);
  color: #fff;
  font-size: 9px;
  font-weight: 600;
  padding: 2px 6px;
  border-radius: 3px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
}

.canvas-node-file-icon {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 4px;
  color: #007acc;
  opacity: 0.8;
}

.canvas-node-file-ext {
  font-size: 14px;
  font-weight: 700;
  color: #00d4aa;
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-top: -8px;
}

.canvas-node-file-name {
  font-size: 12px;
  font-weight: 600;
  color: #ffffff;
  text-align: center;
  word-break: break-word;
  line-height: 1.3;
  max-height: 3.9em;
  overflow: hidden;
  text-overflow: ellipsis;
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  padding: 6px 8px;
  background-color: var(--shadow-color);
  border-radius: 4px;
  width: 100%;
  box-sizing: border-box;
  flex-shrink: 0;
}

.canvas-viewport.drag-over {
  background-color: rgba(0, 122, 204, 0.1);
  outline: 2px dashed #007acc;
  outline-offset: -4px;
}

.canvas-properties-panel {
  position: absolute;
  top: 60px;
  right: 16px;
  width: 220px;
  background-color: var(--bg-tertiary);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  padding: 12px;
  box-shadow: 0 4px 12px var(--shadow-color);
  z-index: 10100;
}

.canvas-properties-header {
  font-size: 13px;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 12px;
  padding-bottom: 8px;
  border-bottom: 1px solid var(--border-color);
}

.canvas-properties-section {
  margin-bottom: 16px;
}

.canvas-properties-section:last-child {
  margin-bottom: 0;
}

.canvas-properties-label {
  font-size: 11px;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 8px;
}

.canvas-properties-colors {
  display: grid;
  grid-template-columns: repeat(6, 1fr);
  gap: 6px;
}

.canvas-properties-color {
  width: 28px;
  height: 28px;
  border: 2px solid transparent;
  border-radius: 4px;
  cursor: pointer;
  transition: border-color 0.2s, transform 0.2s;
}

.canvas-properties-color:hover {
  transform: scale(1.1);
}

.canvas-properties-color.active {
  border-color: #007acc;
  box-shadow: 0 0 0 2px rgba(0, 122, 204, 0.3);
}

.canvas-properties-shapes {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.canvas-properties-shape {
  padding: 8px 12px;
  font-size: 12px;
  background-color: var(--bg-hover);
  border: 2px solid transparent;
  border-radius: 4px;
  color: var(--text-primary);
  cursor: pointer;
  text-align: left;
  transition: background-color 0.2s, border-color 0.2s;
}

.canvas-properties-shape:hover {
  background-color: var(--border-color);
}

.canvas-properties-shape.active {
  background-color: #007acc;
  border-color: #007acc;
  color: #fff;
}

.canvas-properties-delete-btn {
  width: 100%;
  padding: 6px 10px;
  background-color: #4d1e1e;
  border: 1px solid #e74856;
  border-radius: 4px;
  color: #e74856;
  font-size: 11px;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, color 0.2s;
}

.canvas-properties-delete-btn:hover {
  background-color: #e74856;
  color: #fff;
}

/* ============================================================ */
/* Link Card */
/* ============================================================ */

.link-card {
  margin: 16px 0;
  border: 1px solid var(--border-color);
  border-radius: 8px;
  overflow: hidden;
  background-color: var(--bg-secondary);
  cursor: pointer;
  transition: background-color 0.2s, border-color 0.2s;
  position: relative;
}

.link-card:hover {
  background-color: var(--bg-tertiary);
  border-color: var(--border-light);
}

.link-card.loading,
.link-card.error {
  cursor: default;
}

.link-card.error {
  border-color: #dc3545;
}

.link-card-content {
  display: flex;
  position: relative;
}

.link-card-image {
  flex-shrink: 0;
  width: 200px;
  height: 140px;
  overflow: hidden;
  background-color: var(--bg-primary);
}

.link-card-image img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.link-card-body {
  flex: 1;
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  min-width: 0;
}

.link-card-header {
  display: flex;
  align-items: center;
  gap: 8px;
}

.link-card-favicon {
  width: 16px;
  height: 16px;
  flex-shrink: 0;
}

.link-card-title {
  font-weight: 600;
  font-size: 15px;
  color: var(--text-primary);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.link-card-description {
  font-size: 13px;
  color: #999;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
  line-height: 1.4;
}

.link-card-url {
  font-size: 12px;
  color: #666;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  margin-top: auto;
}

.link-card-loading {
  padding: 16px;
  text-align: center;
  color: #999;
  font-size: 13px;
}

.link-card-error {
  color: #dc3545;
  font-size: 13px;
  margin-bottom: 8px;
}

.link-card-delete {
  position: absolute;
  top: 8px;
  right: 8px;
  width: 24px;
  height: 24px;
  border: none;
  border-radius: 50%;
  background-color: rgba(0, 0, 0, 0.6);
  color: #fff;
  font-size: 18px;
  line-height: 1;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  transition: opacity 0.2s, background-color 0.2s;
  z-index: 1;
}

.link-card:hover .link-card-delete {
  opacity: 1;
}

.link-card-delete:hover {
  background-color: #dc3545;
}

/* WikiLink Suggestion List */
.wiki-link-suggestion-list {
  background-color: #2d2d2d;
  border: 1px solid #3c3c3c;
  border-radius: 8px;
  padding: 4px;
  max-height: 300px;
  overflow-y: auto;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
}

.wiki-link-suggestion-item {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  padding: 8px 12px;
  border-radius: 4px;
  background: none;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  text-align: left;
  width: 100%;
  transition: background-color 0.2s;
}

.wiki-link-suggestion-item:hover {
  background-color: var(--bg-tertiary);
}

.wiki-link-suggestion-item.selected {
  background-color: #007acc;
  color: #fff;
}

.wiki-link-suggestion-item-name {
  font-size: 14px;
  font-weight: 500;
  margin-bottom: 2px;
}

.wiki-link-suggestion-item-path {
  font-size: 12px;
  opacity: 0.7;
}

.wiki-link-suggestion-empty {
  padding: 12px;
  text-align: center;
  color: #888;
  font-size: 14px;
}

/* Tippy tooltip styles for suggestion */
.tippy-box[data-theme~='wiki-link-suggestion'] {
  background-color: transparent;
  padding: 0;
}

.tippy-box[data-theme~='wiki-link-suggestion'] .tippy-content {
  padding: 0;
}

/* Attachment (//) Suggestion Tippy Theme */
.tippy-box[data-theme~='attachment-suggestion'] {
  background-color: transparent !important;
  padding: 0 !important;
  border: none !important;
  box-shadow: none !important;
}

.tippy-box[data-theme~='attachment-suggestion'] .tippy-content {
  padding: 0 !important;
}

.tippy-box[data-theme~='attachment-suggestion'] .tippy-arrow {
  display: none !important;
}

/* Attachment (//) Suggestion List */
.attachment-suggestion-list {
  background-color: #1e1e2e;
  border: 1px solid #3a3a4a;
  border-radius: 10px;
  padding: 6px;
  max-height: 320px;
  overflow-y: auto;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
  color: #e0e0e0;
  min-width: 200px;
}

html[data-theme="light"] .attachment-suggestion-list {
  background-color: #ffffff;
  border: 1px solid #ddd;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
  color: #1a1a1a;
}

.attachment-suggestion-header {
  display: flex;
  align-items: center;
  font-size: 11px;
  font-weight: 600;
  color: #888;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  padding: 6px 10px 8px;
  border-bottom: 1px solid #3a3a4a;
  margin-bottom: 4px;
}

html[data-theme="light"] .attachment-suggestion-header {
  color: #555;
  border-bottom-color: #ddd;
}

.attachment-suggestion-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 10px;
  border-radius: 6px;
  background: none;
  border: none;
  color: #e0e0e0;
  cursor: pointer;
  text-align: left;
  width: 100%;
  transition: background-color 0.15s;
  font-family: inherit;
  font-size: 14px;
}

html[data-theme="light"] .attachment-suggestion-item {
  color: #1a1a1a;
}

.attachment-suggestion-item:hover {
  background-color: rgba(255, 255, 255, 0.08);
}

html[data-theme="light"] .attachment-suggestion-item:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.attachment-suggestion-item.selected {
  background-color: #7aa2f7 !important;
  color: #fff;
}

.attachment-suggestion-item-icon {
  width: 24px;
  height: 24px;
  border-radius: 4px;
  background-color: rgba(255, 255, 255, 0.1);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  color: #7aa2f7;
}

html[data-theme="light"] .attachment-suggestion-item-icon {
  background-color: rgba(0, 0, 0, 0.05);
  color: #2563eb;
}

.attachment-suggestion-item.selected .attachment-suggestion-item-icon {
  background-color: rgba(255, 255, 255, 0.2);
  color: #fff;
}

.attachment-suggestion-item-info {
  display: flex;
  flex-direction: column;
  gap: 2px;
  min-width: 0;
  flex: 1;
  color: inherit;
}

.attachment-suggestion-item-name {
  font-size: 13px;
  font-weight: 500;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  color: #e0e0e0;
}

html[data-theme="light"] .attachment-suggestion-item-name {
  color: #1a1a1a;
}

.attachment-suggestion-item.selected .attachment-suggestion-item-name {
  color: #fff !important;
}

.attachment-suggestion-empty {
  padding: 16px;
  text-align: center;
  color: #888;
  font-size: 13px;
}

html[data-theme="light"] .attachment-suggestion-empty {
  color: #666;
}

/* Image Embed (@@ trigger) Suggestion */
.tippy-box[data-theme~='image-embed-suggestion'] {
  background-color: transparent;
  border: none;
  box-shadow: none;
}

.tippy-box[data-theme~='image-embed-suggestion'] .tippy-content {
  padding: 0;
}

.tippy-box[data-theme~='image-embed-suggestion'] .tippy-arrow {
  display: none !important;
}

.image-embed-suggestion-list {
  background-color: #1e1e2e;
  border: 1px solid #3a3a4a;
  border-radius: 10px;
  padding: 6px;
  max-height: 280px;
  overflow-y: auto;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
  color: #e0e0e0;
}

html[data-theme="light"] .image-embed-suggestion-list {
  background-color: #ffffff;
  border: 1px solid #ddd;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
  color: #1a1a1a;
}

.image-embed-suggestion-header {
  font-size: 11px;
  font-weight: 600;
  color: #888;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  padding: 6px 10px 8px;
  border-bottom: 1px solid #3a3a4a;
  margin-bottom: 4px;
}

html[data-theme="light"] .image-embed-suggestion-header {
  color: #555;
  border-bottom-color: #ddd;
}

.image-embed-suggestion-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 10px;
  border-radius: 6px;
  background: none;
  border: none;
  color: #e0e0e0;
  cursor: pointer;
  text-align: left;
  width: 100%;
  transition: background-color 0.15s;
  font-family: inherit;
  font-size: 14px;
}

html[data-theme="light"] .image-embed-suggestion-item {
  color: #1a1a1a;
}

.image-embed-suggestion-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}

html[data-theme="light"] .image-embed-suggestion-item:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.image-embed-suggestion-item.selected {
  background-color: #7aa2f7;
  color: #fff !important;
}

.image-embed-suggestion-item-thumbnail {
  width: 48px;
  height: 48px;
  border-radius: 6px;
  background: rgba(255, 255, 255, 0.05);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  flex-shrink: 0;
  overflow: hidden;
}

.image-embed-suggestion-item-thumbnail img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.image-embed-suggestion-item-thumbnail .hidden {
  display: none;
}

html[data-theme="light"] .image-embed-suggestion-item-thumbnail {
  background: rgba(0, 0, 0, 0.05);
}

.image-embed-suggestion-item.selected .image-embed-suggestion-item-thumbnail {
  background: rgba(255, 255, 255, 0.2);
}

/* Legacy icon style - keeping for fallback */
.image-embed-suggestion-item-icon {
  width: 32px;
  height: 32px;
  border-radius: 6px;
  background: linear-gradient(135deg, #a78bfa 0%, #f472b6 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  flex-shrink: 0;
}

.image-embed-suggestion-item.selected .image-embed-suggestion-item-icon {
  background: rgba(255, 255, 255, 0.2);
}

.image-embed-suggestion-item-info {
  display: flex;
  flex-direction: column;
  gap: 2px;
  min-width: 0;
  flex: 1;
  color: inherit;
}

.image-embed-suggestion-item-name {
  font-size: 14px;
  font-weight: 500;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  color: #e0e0e0;
}

html[data-theme="light"] .image-embed-suggestion-item-name {
  color: #1a1a1a;
}

.image-embed-suggestion-item.selected .image-embed-suggestion-item-name {
  color: #fff !important;
}

.image-embed-suggestion-empty {
  padding: 16px;
  text-align: center;
  color: #888;
  font-size: 13px;
}

html[data-theme="light"] .image-embed-suggestion-empty {
  color: #666;
}

/* ============================================================ */
/* Metadata Editor */
/* ============================================================ */

.metadata-editor {
  display: flex;
  flex-direction: column;
  height: 100%;
  background-color: var(--bg-primary);
  color: var(--text-secondary);
}

.metadata-editor-empty,
.metadata-editor-loading {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  color: var(--text-muted);
  font-size: 14px;
}

.metadata-editor-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 16px;
  border-bottom: 1px solid var(--border-color);
  background-color: var(--bg-secondary);
}

.mode-toggle {
  display: flex;
  gap: 4px;
  background-color: var(--bg-tertiary);
  border-radius: 4px;
  padding: 2px;
}

.mode-toggle-btn {
  padding: 6px 16px;
  background: none;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  border-radius: 3px;
  font-size: 13px;
  transition: background-color 0.2s;
}

.mode-toggle-btn:hover {
  background-color: var(--bg-hover);
}

.mode-toggle-btn.active {
  background-color: #007acc;
  color: #fff;
}

.metadata-auto-save-status {
  display: flex;
  align-items: center;
  min-width: 100px;
  justify-content: flex-end;
}

.metadata-saving {
  font-size: 12px;
  color: var(--text-muted);
  font-style: italic;
  animation: pulse 1.5s ease-in-out infinite;
}

@keyframes pulse {
  0%, 100% {
    opacity: 0.6;
  }
  50% {
    opacity: 1;
  }
}

.metadata-editor-content {
  flex: 1;
  overflow-y: auto;
  padding: 16px;
}

/* ============================================================ */
/* Metadata Form */
/* ============================================================ */

.metadata-form {
  max-width: 800px;
  margin: 0 auto;
}

.form-section {
  margin-bottom: 32px;
  padding: 16px;
  background-color: var(--bg-secondary);
  border-radius: 6px;
  border: 1px solid var(--border-color);
}

.form-section-title {
  font-size: 16px;
  font-weight: 600;
  color: #007acc;
  margin: 0 0 16px 0;
  padding-bottom: 8px;
  border-bottom: 1px solid var(--border-color);
}

.form-field {
  margin-bottom: 16px;
}

.form-field label {
  display: block;
  font-size: 13px;
  color: var(--text-secondary);
  margin-bottom: 6px;
  font-weight: 500;
}

.form-field input,
.form-field select,
.form-field textarea {
  width: 100%;
  padding: 8px 12px;
  background-color: var(--bg-tertiary);
  border: 1px solid var(--border-color);
  border-radius: 4px;
  color: var(--text-primary);
  font-size: 13px;
  font-family: inherit;
}

.form-field input:focus,
.form-field select:focus,
.form-field textarea:focus {
  outline: none;
  border-color: #007acc;
}

.form-field input:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.form-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
}

.maturity-slider {
  display: flex;
  align-items: center;
  gap: 12px;
}

.maturity-slider input[type="range"] {
  flex: 1;
  height: 6px;
  background: var(--bg-hover);
  outline: none;
  border-radius: 3px;
}

.maturity-slider input[type="range"]::-webkit-slider-thumb {
  appearance: none;
  width: 18px;
  height: 18px;
  background: #007acc;
  cursor: pointer;
  border-radius: 50%;
}

.maturity-slider input[type="range"]::-moz-range-thumb {
  width: 18px;
  height: 18px;
  background: #007acc;
  cursor: pointer;
  border-radius: 50%;
  border: none;
}

.maturity-value {
  font-size: 14px;
  font-weight: 600;
  color: #007acc;
  min-width: 20px;
  text-align: center;
}

.maturity-labels {
  display: flex;
  justify-content: space-between;
  font-size: 11px;
  color: #888;
  margin-top: 4px;
}

/* ============================================================ */
/* YAML Editor */
/* ============================================================ */

.yaml-editor {
  display: flex;
  flex-direction: column;
  height: 100%;
}

.yaml-editor-error {
  padding: 12px 16px;
  background-color: #5a1e1e;
  border: 1px solid #8b3434;
  border-radius: 4px;
  color: #f48771;
  font-size: 13px;
  margin-bottom: 16px;
}

.yaml-editor-textarea {
  flex: 1;
  padding: 16px;
  background-color: var(--bg-primary);
  border: 1px solid var(--border-color);
  border-radius: 4px;
  color: var(--text-primary);
  font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
  font-size: 13px;
  line-height: 1.6;
  resize: none;
  white-space: pre;
  overflow-wrap: normal;
  overflow-x: auto;
}

.yaml-editor-textarea:focus {
  outline: none;
  border-color: #007acc;
}

.yaml-editor-hint {
  margin-top: 16px;
  padding: 12px;
  background-color: var(--bg-tertiary);
  border-radius: 4px;
  font-size: 12px;
  color: var(--text-secondary);
  line-height: 1.5;
}

.yaml-editor-hint strong {
  color: #007acc;
}

/* ============================================================ */
/* Validation Panel */
/* ============================================================ */

.validation-panel {
  padding: 12px 16px;
  background-color: #5a1e1e;
  border: 1px solid #8b3434;
  border-radius: 4px;
  margin-bottom: 16px;
}

.validation-panel-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 12px;
  color: #f48771;
  font-size: 14px;
}

.validation-icon {
  font-size: 18px;
}

.validation-errors {
  list-style: none;
  padding: 0;
  margin: 0 0 12px 0;
}

.validation-error {
  display: flex;
  flex-direction: column;
  padding: 8px 12px;
  background-color: #3c1e1e;
  border-radius: 3px;
  margin-bottom: 8px;
  font-size: 13px;
}

.error-path {
  font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
  color: #ff6b6b;
  font-size: 12px;
  margin-bottom: 4px;
  font-weight: 600;
}

.error-message {
  color: #f48771;
  line-height: 1.4;
}

.validation-panel-hint {
  font-size: 12px;
  color: #d4a676;
  font-style: italic;
}

/* ============================================================ */
/* Faceted Tag Editor */
/* ============================================================ */

.faceted-tag-editor {
  padding: 0;
}

.faceted-tag-editor-loading {
  padding: 16px;
  text-align: center;
  color: var(--text-muted);
  font-size: 13px;
}

.faceted-tag-editor-title {
  font-size: 16px;
  font-weight: 600;
  color: #007acc;
  margin: 0 0 16px 0;
  padding-bottom: 8px;
  border-bottom: 1px solid var(--border-color);
}

.facet-group {
  margin-bottom: 20px;
  position: relative;
}

.facet-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}

.facet-label {
  font-size: 13px;
  font-weight: 600;
  color: var(--text-secondary);
  margin-right: 8px;
}

.facet-description {
  font-size: 11px;
  color: var(--text-muted);
  font-weight: normal;
}

.facet-add-btn {
  padding: 4px 12px;
  background-color: var(--bg-tertiary);
  border: 1px solid var(--border-light);
  border-radius: 3px;
  color: var(--text-secondary);
  cursor: pointer;
  font-size: 12px;
  transition: all 0.2s;
}

.facet-add-btn:hover {
  background-color: #007acc;
  border-color: #007acc;
  color: #fff;
}

.facet-tags {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  padding: 8px;
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 4px;
  min-height: 38px;
}

.tag-chip {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 4px 10px;
  background-color: #007acc;
  color: #fff;
  border-radius: 12px;
  font-size: 12px;
  font-family: "Malgun Gothic", "맑은 고딕", "Apple SD Gothic Neo", "Noto Sans KR", sans-serif;
  transition: background-color 0.2s;
}

.tag-chip:hover {
  background-color: #005a9e;
}

.tag-label {
  font-weight: 500;
}

.tag-remove-btn {
  background: none;
  border: none;
  color: inherit;
  cursor: pointer;
  font-size: 18px;
  line-height: 1;
  padding: 0;
  opacity: 0.7;
  transition: opacity 0.2s;
}

.tag-remove-btn:hover {
  opacity: 1;
}

/* ============================================================ */
/* Hierarchical Tag Selector */
/* ============================================================ */

.hierarchical-tag-selector {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  margin-top: 4px;
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 4px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
  z-index: 100;
  max-height: 400px;
  display: flex;
  flex-direction: column;
}

.tag-search {
  padding: 8px;
  border-bottom: 1px solid var(--border-color);
}

.tag-search input {
  width: 100%;
  padding: 8px 12px;
  background-color: var(--bg-primary);
  border: 1px solid var(--border-color);
  border-radius: 4px;
  color: var(--text-secondary);
  font-size: 13px;
}

.tag-search input:focus {
  outline: none;
  border-color: #007acc;
}

.tag-search-results,
.tag-list {
  flex: 1;
  overflow-y: auto;
  max-height: 300px;
}

.tag-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 12px;
  background: none;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  text-align: left;
  width: 100%;
  transition: background-color 0.2s;
  font-size: 13px;
}

.tag-item:hover {
  background-color: var(--bg-tertiary);
}

/* Keyboard navigation selected state */
.tag-item-selected {
  background-color: var(--accent-color) !important;
  color: var(--text-primary) !important;
}

.tag-item-selected .tag-item-breadcrumb {
  color: var(--text-secondary);
}

/* Disable hover effect when keyboard navigation is active */
.keyboard-nav-active .tag-item:hover:not(.tag-item-selected) {
  background-color: transparent;
}

.tag-item-label {
  flex: 1;
}

.tag-item-breadcrumb {
  font-size: 11px;
  color: var(--text-muted);
  margin-top: 2px;
}

.tag-item-arrow {
  color: var(--text-muted);
  margin-left: 8px;
}

.tag-item-wrapper {
  display: flex;
  align-items: center;
  width: 100%;
}

.tag-item-wrapper .tag-item {
  flex: 1;
}

.tag-item-delete {
  background: none;
  border: none;
  color: var(--text-muted);
  cursor: pointer;
  padding: 4px 8px;
  font-size: 14px;
  opacity: 0.5;
  transition: opacity 0.2s, color 0.2s;
}

.tag-item-delete:hover {
  opacity: 1;
  color: #ff6b6b;
}

.tag-empty {
  padding: 16px;
  text-align: center;
  color: var(--text-muted);
  font-size: 13px;
}

.tag-create-btn {
  margin-top: 12px;
  padding: 6px 12px;
  background-color: #007acc;
  color: #ffffff;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 13px;
  font-weight: 500;
  transition: background-color 0.2s;
}

.tag-create-btn:hover {
  background-color: #005a9e;
}

.tag-breadcrumb {
  display: flex;
  align-items: center;
  padding: 8px 12px;
  background-color: var(--bg-secondary);
  border-bottom: 1px solid var(--border-color);
  font-size: 12px;
  flex-wrap: wrap;
  gap: 4px;
}

.breadcrumb-item {
  background: none;
  border: none;
  color: #007acc;
  cursor: pointer;
  padding: 2px 6px;
  border-radius: 3px;
  transition: background-color 0.2s;
}

.breadcrumb-item:hover {
  background-color: var(--bg-tertiary);
}

.breadcrumb-separator-wrapper {
  display: flex;
  align-items: center;
  gap: 4px;
}

.breadcrumb-separator {
  color: var(--text-muted);
}

.tag-recent {
  padding: 12px;
  border-top: 1px solid var(--border-color);
}

.tag-recent-title {
  font-size: 11px;
  color: var(--text-muted);
  margin-bottom: 8px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.tag-recent-list {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
}

.tag-chip-small {
  padding: 4px 10px;
  background-color: var(--bg-tertiary);
  border: 1px solid var(--border-light);
  border-radius: 12px;
  color: var(--text-secondary);
  cursor: pointer;
  font-size: 11px;
  transition: all 0.2s;
}

.tag-chip-small:hover {
  background-color: #007acc;
  border-color: #007acc;
  color: #fff;
}

.tag-chip-small-wrapper {
  position: relative;
  display: inline-flex;
  align-items: center;
}

.tag-chip-small-wrapper .tag-chip-small {
  padding-right: 22px;
}

.tag-chip-remove {
  position: absolute;
  right: 4px;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  color: var(--text-muted);
  font-size: 14px;
  line-height: 1;
  cursor: pointer;
  padding: 0 2px;
  opacity: 0.6;
  transition: opacity 0.2s, color 0.2s;
}

.tag-chip-remove:hover {
  opacity: 1;
  color: #ff6b6b;
}

.tag-chip-small-wrapper:hover .tag-chip-remove {
  color: rgba(255, 255, 255, 0.7);
}

.tag-chip-small-wrapper:hover .tag-chip-remove:hover {
  color: #ff6b6b;
}

/* Orphan tags (deleted from ontology but still in recent list) */
.tag-chip-small-orphan {
  background-color: var(--bg-secondary) !important;
  border-color: var(--border-light) !important;
  color: var(--text-muted) !important;
  text-decoration: line-through;
  opacity: 0.7;
  cursor: not-allowed !important;
}

.tag-chip-small-orphan:hover {
  background-color: var(--bg-secondary) !important;
  border-color: var(--border-light) !important;
  color: var(--text-muted) !important;
}

.tag-chip-orphan .tag-chip-remove {
  color: var(--text-muted);
}

.tag-chip-orphan:hover .tag-chip-remove {
  color: var(--text-muted);
}

.tag-chip-orphan .tag-chip-remove:hover {
  color: #ff6b6b !important;
}

/* ============================================================ */
/* Relation Editor */
/* ============================================================ */

.relation-editor {
  padding: 0;
}

.relation-editor-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
}

.relation-editor-title {
  font-size: 16px;
  font-weight: 600;
  color: #007acc;
  margin: 0;
}

.relation-add-btn {
  padding: 6px 14px;
  background-color: var(--bg-tertiary);
  border: 1px solid var(--border-light);
  border-radius: 3px;
  color: var(--text-secondary);
  cursor: pointer;
  font-size: 12px;
  transition: all 0.2s;
}

.relation-add-btn:hover {
  background-color: #007acc;
  border-color: #007acc;
  color: #fff;
}

.relation-add-form {
  padding: 16px;
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 4px;
  margin-bottom: 16px;
}

.relation-form-row {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-bottom: 12px;
}

.relation-form-field {
  display: flex;
  flex-direction: column;
  min-width: 0;
  width: 100%;
}

.relation-form-field label {
  font-size: 12px;
  color: var(--text-secondary);
  margin-bottom: 6px;
  font-weight: 500;
}

.relation-form-field input,
.relation-form-field select {
  padding: 8px 12px;
  background-color: var(--bg-primary);
  border: 1px solid var(--border-color);
  border-radius: 4px;
  color: var(--text-secondary);
  font-size: 13px;
  width: 100%;
  box-sizing: border-box;
  min-width: 0;
}

.relation-form-field input:focus,
.relation-form-field select:focus {
  outline: none;
  border-color: #007acc;
}

.relation-form-submit {
  width: 100%;
  padding: 8px;
  background-color: #007acc;
  border: none;
  border-radius: 4px;
  color: #fff;
  cursor: pointer;
  font-size: 13px;
  transition: background-color 0.2s;
}

.relation-form-submit:hover {
  background-color: #005a9e;
}

.relation-empty {
  padding: 24px;
  text-align: center;
  color: var(--text-muted);
  font-size: 13px;
  background-color: var(--bg-secondary);
  border: 1px dashed var(--border-color);
  border-radius: 4px;
}

.relation-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.relation-item {
  padding: 12px;
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 4px;
  transition: border-color 0.2s;
}

.relation-item:hover {
  border-color: #007acc;
}

.relation-item-header {
  display: flex;
  align-items: center;
  gap: 8px;
}

.relation-type {
  padding: 4px 10px;
  background-color: #007acc;
  color: #fff;
  border-radius: 12px;
  font-size: 11px;
  font-weight: 600;
}

.relation-arrow {
  color: var(--text-muted);
  font-size: 16px;
}

.relation-target {
  flex: 1;
  font-size: 13px;
  color: var(--text-secondary);
  font-weight: 500;
}

.relation-remove-btn {
  background: none;
  border: none;
  color: var(--text-muted);
  cursor: pointer;
  font-size: 20px;
  line-height: 1;
  padding: 0 6px;
  transition: color 0.2s;
}

.relation-remove-btn:hover {
  color: #f87171;
}

.relation-strength-bar {
  margin-top: 8px;
  height: 4px;
  background-color: var(--bg-tertiary);
  border-radius: 2px;
  overflow: hidden;
}

.relation-strength-fill {
  height: 100%;
  background-color: #007acc;
  transition: width 0.3s;
}

.note-suggestions {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  background-color: var(--bg-primary);
  border: 1px solid #007acc;
  border-radius: 4px;
  max-height: 200px;
  overflow-y: auto;
  z-index: 1000;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
  margin-top: 4px;
}

.note-suggestion-item {
  padding: 8px 12px;
  color: var(--text-secondary);
  cursor: pointer;
  font-size: 13px;
  transition: background-color 0.15s;
}

.note-suggestion-item:hover {
  background-color: var(--bg-secondary);
  color: var(--text-primary);
}

/* ============================================================ */
/* Suggestion Panel */
/* ============================================================ */

.suggestion-panel {
  margin-top: 16px;
  padding: 12px 16px;
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 6px;
}

.suggestion-panel.collapsed .suggestion-list {
  display: none;
}

.suggestion-panel-header {
  display: flex;
  align-items: center;
  gap: 12px;
  cursor: pointer;
  user-select: none;
}

.suggestion-panel-header h3 {
  font-size: 14px;
  font-weight: 600;
  color: var(--accent-color);
  margin: 0;
  flex: 1;
}

.suggestion-count {
  padding: 2px 8px;
  background-color: #007acc;
  color: #fff;
  border-radius: 10px;
  font-size: 11px;
  font-weight: 600;
}

.suggestion-toggle {
  color: var(--text-muted);
  font-size: 12px;
}

.suggestion-loading {
  padding: 16px;
  text-align: center;
  color: var(--text-muted);
  font-size: 13px;
}

.suggestion-list {
  margin-top: 12px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.suggestion-item {
  padding: 12px;
  background-color: var(--bg-tertiary);
  border: 1px solid var(--border-color);
  border-radius: 4px;
  transition: border-color 0.2s;
}

.suggestion-item:hover {
  border-color: #007acc;
}

.suggestion-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 8px;
}

.suggestion-icon {
  font-size: 18px;
}

.suggestion-type {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-secondary);
  flex: 1;
}

.suggestion-confidence {
  padding: 2px 8px;
  background-color: var(--bg-tertiary);
  color: var(--text-secondary);
  border-radius: 10px;
  font-size: 11px;
  font-weight: 600;
}

.suggestion-description {
  font-size: 13px;
  color: var(--text-secondary);
  line-height: 1.5;
  margin-bottom: 12px;
}

.suggestion-actions {
  display: flex;
  gap: 8px;
  justify-content: flex-end;
}

.suggestion-apply-btn,
.suggestion-dismiss-btn {
  padding: 6px 12px;
  border: none;
  border-radius: 3px;
  cursor: pointer;
  font-size: 12px;
  transition: all 0.2s;
}

.suggestion-apply-btn {
  background-color: #007acc;
  color: #fff;
}

.suggestion-apply-btn:hover {
  background-color: #005a9e;
}

.suggestion-dismiss-btn {
  background-color: var(--bg-tertiary);
  color: var(--text-secondary);
}

.suggestion-dismiss-btn:hover {
  background-color: var(--bg-hover);
}

/* ============================================================ */
/* Health Check Panel */
/* ============================================================ */

.health-check-panel {
  margin-top: 16px;
  padding: 12px 16px;
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 6px;
}

.health-check-panel:not(.expanded) .health-check-content {
  display: none;
}

.health-check-header {
  display: flex;
  align-items: center;
  gap: 12px;
  cursor: pointer;
  user-select: none;
}

.health-check-header h3 {
  font-size: 14px;
  font-weight: 600;
  color: var(--accent-color);
  margin: 0;
  flex: 1;
}

.health-score-badge {
  display: flex;
  align-items: center;
  gap: 8px;
}

.health-score-circle {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  border: 3px solid;
  display: flex;
  align-items: center;
  justify-content: center;
}

.health-score-value {
  font-size: 16px;
  font-weight: 700;
  color: #fff;
}

.health-score-label {
  font-size: 12px;
  color: var(--text-secondary);
  font-weight: 600;
}

.health-toggle {
  color: var(--text-muted);
  font-size: 12px;
}

.health-loading {
  padding: 2px 8px;
  background-color: #3c3c3c;
  color: #aaa;
  border-radius: 10px;
  font-size: 11px;
}

.health-check-content {
  margin-top: 16px;
}

.health-stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: 12px;
  margin-bottom: 16px;
}

.health-stat-item {
  display: flex;
  flex-direction: column;
  gap: 4px;
  padding: 12px;
  background-color: #2d2d2d;
  border-radius: 4px;
  text-align: center;
}

.health-stat-label {
  font-size: 11px;
  color: #888;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.health-stat-value {
  font-size: 24px;
  font-weight: 700;
  color: #007acc;
}

.health-filter {
  display: flex;
  gap: 8px;
  margin-bottom: 16px;
  flex-wrap: wrap;
}

.health-filter-btn {
  padding: 6px 12px;
  background-color: #3c3c3c;
  border: 1px solid #555;
  border-radius: 3px;
  color: #ccc;
  cursor: pointer;
  font-size: 12px;
  transition: all 0.2s;
}

.health-filter-btn:hover {
  background-color: #555;
}

.health-filter-btn.active {
  background-color: #007acc;
  border-color: #007acc;
  color: #fff;
}

.health-filter-btn.error.active {
  background-color: #f87171;
  border-color: #f87171;
}

.health-filter-btn.warning.active {
  background-color: #fbbf24;
  border-color: #fbbf24;
  color: #1e1e1e;
}

.health-filter-btn.info.active {
  background-color: #60a5fa;
  border-color: #60a5fa;
}

.health-empty {
  padding: 24px;
  text-align: center;
  color: #34d399;
  font-size: 14px;
  background-color: #2d2d2d;
  border-radius: 4px;
}

.health-issues {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.health-issue {
  padding: 12px;
  background-color: #2d2d2d;
  border-left: 3px solid;
  border-radius: 4px;
}

.health-issue.error {
  border-left-color: #f87171;
}

.health-issue.warning {
  border-left-color: #fbbf24;
}

.health-issue.info {
  border-left-color: #60a5fa;
}

.health-issue-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 6px;
}

.health-issue-icon {
  font-size: 16px;
}

.health-issue-category {
  font-size: 12px;
  font-weight: 600;
  color: #aaa;
  flex: 1;
}

.health-issue-severity {
  padding: 2px 8px;
  background-color: #3c3c3c;
  color: #aaa;
  border-radius: 10px;
  font-size: 10px;
  font-weight: 600;
  text-transform: uppercase;
}

.health-issue-message {
  font-size: 13px;
  color: #ccc;
  margin-bottom: 8px;
  line-height: 1.5;
}

.health-issue-note-link {
  padding: 4px 10px;
  background-color: #007acc;
  border: none;
  border-radius: 3px;
  color: #fff;
  cursor: pointer;
  font-size: 12px;
  transition: background-color 0.2s;
}

.health-issue-note-link:hover {
  background-color: #005a9e;
}

/* ============================================================ */
/* Note Creation Wizard */
/* ============================================================ */

.note-creation-wizard {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 600px;
  max-height: 80vh;
  background-color: #1e1e1e;
  border: 1px solid #3c3c3c;
  border-radius: 8px;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.6);
  display: flex;
  flex-direction: column;
  z-index: 1000;
}

.wizard-header {
  padding: 20px 24px;
  border-bottom: 1px solid var(--border-color);
}

.wizard-header h2 {
  font-size: 18px;
  font-weight: 600;
  color: var(--text-primary);
  margin: 0 0 16px 0;
}

.wizard-steps {
  display: flex;
  align-items: center;
  gap: 8px;
}

.wizard-step-indicator {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  background-color: #3c3c3c;
  color: #888;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  font-weight: 600;
}

.wizard-step-indicator.active {
  background-color: #007acc;
  color: #fff;
}

.wizard-step-connector {
  flex: 1;
  height: 2px;
  background-color: #3c3c3c;
}

.wizard-content {
  flex: 1;
  overflow-y: auto;
  padding: 24px;
}

.wizard-step {
  animation: fadeIn 0.3s ease-in;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.wizard-step-title {
  font-size: 16px;
  font-weight: 600;
  color: #007acc;
  margin: 0 0 20px 0;
}

.note-type-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 12px;
}

.note-type-card {
  padding: 16px;
  background-color: #2d2d2d;
  border: 2px solid #3c3c3c;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
}

.note-type-card:hover {
  border-color: #007acc;
  background-color: #3c3c3c;
}

.note-type-card.selected {
  border-color: #007acc;
  background-color: #007acc20;
}

.note-type-icon {
  font-size: 32px;
}

.note-type-label {
  font-size: 13px;
  color: #ccc;
  font-weight: 500;
}

.wizard-form {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.wizard-form-field {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.wizard-form-field label {
  font-size: 13px;
  color: #aaa;
  font-weight: 500;
}

.wizard-form-field input,
.wizard-form-field select {
  padding: 10px 12px;
  background-color: #2d2d2d;
  border: 1px solid #3c3c3c;
  border-radius: 4px;
  color: #ccc;
  font-size: 14px;
}

.wizard-form-field input:focus,
.wizard-form-field select:focus {
  outline: none;
  border-color: #007acc;
}

.wizard-summary {
  display: flex;
  flex-direction: column;
  gap: 12px;
  padding: 16px;
  background-color: #2d2d2d;
  border-radius: 6px;
  margin-bottom: 16px;
}

.wizard-summary-item {
  display: flex;
  gap: 12px;
}

.wizard-summary-label {
  font-size: 13px;
  color: #888;
  min-width: 100px;
}

.wizard-summary-value {
  font-size: 13px;
  color: #fff;
  font-weight: 500;
}

.wizard-info {
  padding: 12px 16px;
  background-color: #007acc20;
  border-left: 3px solid #007acc;
  border-radius: 4px;
}

.wizard-info p {
  margin: 0;
  font-size: 13px;
  color: #60a5fa;
}

.wizard-footer {
  padding: 16px 24px;
  border-top: 1px solid #3c3c3c;
  display: flex;
  gap: 8px;
  justify-content: flex-end;
}

.wizard-btn {
  padding: 8px 16px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 13px;
  font-weight: 500;
  transition: all 0.2s;
}

.wizard-btn-cancel {
  background-color: #3c3c3c;
  color: #ccc;
}

.wizard-btn-cancel:hover {
  background-color: #555;
}

.wizard-btn-back {
  background-color: #3c3c3c;
  color: #ccc;
}

.wizard-btn-back:hover {
  background-color: #555;
}

.wizard-btn-next,
.wizard-btn-create {
  background-color: #007acc;
  color: #fff;
}

.wizard-btn-next:hover,
.wizard-btn-create:hover {
  background-color: #005a9e;
}

/* ============================================================ */
/* Hover Editor Metadata Panel */
/* ============================================================ */

.hover-editor-metadata-panel {
  width: 400px;
  min-width: 300px;
  max-width: 500px;
  border-left: 1px solid var(--border-color, #3c3c3c);
  background-color: var(--bg-primary, #1e1e1e);
  overflow-y: auto;
  flex-shrink: 0;
}

.hover-editor-content-row {
  display: flex;
  flex: 1;
  overflow: hidden;
}

.hover-editor-body {
  flex: 1;
  overflow-y: auto;
  border-bottom-left-radius: 6px;
  border-bottom-right-radius: 6px;
}

/* Folder note metadata section (above search) */
.hover-editor-metadata-section {
  border-top: 1px solid var(--border-color, #3c3c3c);
  background-color: var(--bg-primary, #1e1e1e);
  overflow-y: auto;
  max-height: 400px;
  flex-shrink: 0;
}

/* ============================================================ */
/* Calendar View */
/* ============================================================ */

.calendar-view {
  display: flex;
  flex-direction: column;
  height: 100%;
  background-color: var(--bg-primary);
  color: var(--text-secondary);
}

.calendar-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 16px;
  border-bottom: 1px solid var(--border-color);
  flex-shrink: 0;
}

.calendar-content {
  display: flex;
  flex: 1;
  overflow: hidden;
}

.calendar-nav {
  display: flex;
  align-items: center;
  gap: 16px;
}

.calendar-nav-btn {
  background: none;
  border: none;
  color: var(--text-secondary);
  font-size: 24px;
  cursor: pointer;
  padding: 4px 12px;
  border-radius: 4px;
}

.calendar-nav-btn:hover {
  background-color: var(--bg-hover);
}

.calendar-month-year {
  font-size: 18px;
  font-weight: 600;
  min-width: 200px;
  text-align: center;
}

.calendar-toggle {
  display: flex;
  gap: 8px;
}

.calendar-toggle-btn {
  padding: 6px 16px;
  border: 1px solid var(--border-color);
  background-color: var(--bg-secondary);
  color: var(--text-secondary);
  border-radius: 4px;
  cursor: pointer;
  font-size: 13px;
}

.calendar-toggle-btn:hover {
  background-color: var(--bg-hover);
}

.calendar-toggle-btn.active {
  background-color: #007acc;
  border-color: #007acc;
  color: #ffffff;
}

.calendar-grid-container {
  flex: 1;
  padding: 16px;
  border-right: 1px solid var(--border-color);
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.calendar-weekdays {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 0;
  margin-bottom: 4px;
}

.calendar-weekday {
  text-align: center;
  font-size: 13px;
  font-weight: 600;
  color: var(--text-muted);
  padding: 10px 4px;
  text-transform: uppercase;
}

.calendar-days {
  flex: 1;
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  grid-template-rows: repeat(6, 1fr);
  gap: 0;
}

.calendar-day {
  background-color: var(--bg-primary);
  padding: 8px;
  cursor: pointer;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  position: relative;
  border: 1px solid var(--bg-tertiary);
}

.calendar-day.empty {
  background-color: var(--bg-secondary);
  cursor: default;
}

.calendar-day:not(.empty):hover {
  background-color: var(--bg-hover);
}

.calendar-day.today {
  background-color: var(--calendar-today-bg);
}

.calendar-day.today:hover {
  background-color: var(--calendar-today-hover);
}

.calendar-day.selected {
  background-color: var(--calendar-selected-bg);
  border: 2px solid var(--calendar-selected-border);
}

.calendar-day.has-memos .calendar-day-number {
  font-weight: 600;
}

.calendar-day-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
  margin-bottom: 4px;
  flex-shrink: 0;
}

.calendar-day-number {
  font-size: 16px;
  color: var(--text-secondary);
}

.calendar-day.today .calendar-day-number {
  color: var(--text-primary);
  font-weight: 700;
}

.calendar-day-badge {
  font-size: 10px;
  background-color: #007acc;
  color: #ffffff;
  padding: 2px 6px;
  border-radius: 10px;
  font-weight: 600;
  min-width: 18px;
  text-align: center;
}

.calendar-day-memos {
  flex: 1;
  width: 100%;
  overflow-y: auto;
  overflow-x: hidden;
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.calendar-day-memo-chip {
  font-size: 10px;
  padding: 3px 6px;
  border-radius: 3px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  cursor: pointer;
  flex-shrink: 0;
}

/* Memo (default - green) */
.calendar-day-memo-chip.memo {
  background-color: #2d4a3e;
  color: #a8d4b8;
}

.calendar-day-memo-chip.memo:hover {
  background-color: #3a5c4d;
}

/* Task (red) */
.calendar-day-memo-chip.task {
  background-color: #4a2d2d;
  color: #d4a8a8;
}

.calendar-day-memo-chip.task:hover {
  background-color: #5c3a3a;
}

.calendar-day-memo-chip.resolved {
  background-color: var(--bg-tertiary);
  color: var(--text-muted);
  text-decoration: line-through;
}

.calendar-memo-list {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  border-left: 1px solid var(--border-color);
}

.calendar-memo-list-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 20px;
  border-bottom: 1px solid var(--border-color);
  font-size: 14px;
  font-weight: 600;
}

.calendar-memo-count {
  color: var(--text-muted);
  font-weight: 400;
  font-size: 13px;
}

.calendar-memo-items {
  flex: 1;
  overflow-y: auto;
  padding: 8px;
}

.calendar-memo-item {
  display: flex;
  gap: 12px;
  padding: 12px 16px;
  margin-bottom: 4px;
  background-color: var(--bg-secondary);
  border-radius: 4px;
  cursor: pointer;
  transition: background-color 0.15s;
}

.calendar-memo-item:hover {
  background-color: var(--bg-hover);
}

.calendar-memo-item.resolved {
  opacity: 0.5;
}

.calendar-memo-checkbox {
  margin-top: 2px;
  cursor: pointer;
  flex-shrink: 0;
}

.calendar-memo-content {
  flex: 1;
  min-width: 0;
}

.calendar-memo-text {
  font-size: 14px;
  color: var(--text-secondary);
  margin-bottom: 4px;
  word-wrap: break-word;
}

.calendar-memo-meta {
  font-size: 12px;
  color: var(--text-muted);
  display: flex;
  gap: 4px;
}

.calendar-memo-note {
  font-weight: 500;
}

.calendar-memo-anchor {
  color: var(--text-muted);
}

.calendar-memo-empty {
  text-align: center;
  padding: 40px 20px;
  color: var(--text-muted);
  font-size: 14px;
}

/* ===== Note Creation Modals ===== */

/* Title Input Modal */
.title-input-modal {
  background-color: var(--bg-tertiary);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  width: 420px;
  max-width: 90vw;
  box-shadow: 0 8px 32px var(--shadow-color);
  display: flex;
  flex-direction: column;
}

.title-input-header {
  padding: 14px 18px;
  border-bottom: 1px solid var(--border-color);
  font-size: 15px;
  font-weight: 600;
  color: var(--text-primary);
}

.title-input-modal.with-template-info {
  width: 480px;
}

.title-input-template-info {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  padding: 16px 18px;
  background-color: var(--bg-secondary);
  border-bottom: 1px solid var(--border-color);
}

.title-input-template-icon {
  width: 32px;
  height: 32px;
  flex-shrink: 0;
  border-radius: 6px;
}

.title-input-template-details {
  flex: 1;
  min-width: 0;
}

.title-input-template-name {
  font-size: 14px;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 4px;
}

.title-input-template-desc {
  font-size: 12px;
  color: var(--text-muted);
  line-height: 1.4;
}

.title-input-body {
  padding: 18px;
}

.title-input-field {
  width: 100%;
  padding: 8px 12px;
  font-size: 14px;
  background-color: var(--bg-primary);
  border: 1px solid var(--border-color);
  border-radius: 4px;
  color: var(--text-primary);
  outline: none;
  transition: border-color 0.2s;
}

.title-input-field:focus {
  border-color: #007acc;
}

.title-input-actions {
  padding: 12px 18px;
  border-top: 1px solid var(--border-color);
  display: flex;
  justify-content: flex-end;
  gap: 10px;
}

.title-input-btn {
  padding: 6px 14px;
  font-size: 13px;
  border-radius: 4px;
  border: none;
  cursor: pointer;
  font-weight: 500;
  transition: background-color 0.2s;
}

.title-input-cancel {
  background-color: var(--bg-hover);
  color: var(--text-secondary);
}

.title-input-cancel:hover {
  background-color: var(--border-color);
}

.title-input-submit {
  background-color: #007acc;
  color: #ffffff;
}

.title-input-submit:hover {
  background-color: #0098ff;
}

/* Meeting Input Modal */
.meeting-input-modal {
  background-color: var(--bg-tertiary);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  width: 480px;
  max-width: 90vw;
  box-shadow: 0 8px 32px var(--shadow-color);
  display: flex;
  flex-direction: column;
}

.meeting-input-header {
  padding: 14px 18px;
  border-bottom: 1px solid var(--border-color);
  font-size: 15px;
  font-weight: 600;
  color: var(--text-primary);
}

.meeting-input-body {
  padding: 18px;
  display: flex;
  flex-direction: column;
  gap: 14px;
  max-height: 60vh;
  overflow-y: auto;
  overflow: visible;  /* ParticipantInput suggestions가 모달 밖으로 나갈 수 있도록 */
}

.meeting-input-field {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.meeting-input-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 14px;
}

.meeting-input-label {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.meeting-input-input {
  padding: 8px 12px;
  font-size: 14px;
  background-color: var(--bg-primary);
  border: 1px solid var(--border-color);
  border-radius: 4px;
  color: var(--text-primary);
  outline: none;
  transition: border-color 0.2s;
}

.meeting-input-input:focus {
  border-color: var(--accent-color, #007acc);
}

.meeting-input-actions {
  padding: 12px 18px;
  border-top: 1px solid var(--border-color);
  display: flex;
  justify-content: flex-end;
  gap: 10px;
}

.meeting-input-btn {
  padding: 6px 14px;
  font-size: 13px;
  border-radius: 4px;
  border: none;
  cursor: pointer;
  font-weight: 500;
  transition: background-color 0.2s;
}

.meeting-input-cancel {
  background-color: var(--bg-hover);
  color: var(--text-secondary);
}

.meeting-input-cancel:hover {
  background-color: var(--border-color);
}

.meeting-input-submit {
  background-color: #007acc;
  color: #ffffff;
}

.meeting-input-submit:hover {
  background-color: #0098ff;
}

/* Participant Input with @mention */
.participant-input-wrapper {
  position: relative;
}

.participant-suggestions {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  margin-top: 4px;
  background-color: var(--bg-tertiary);
  border: 1px solid var(--border-color);
  border-radius: 6px;
  box-shadow: 0 4px 16px var(--shadow-color);
  max-height: 240px;
  overflow-y: auto;
  z-index: 1000002 !important;  /* 모달 위에 표시 */
}

.participant-suggestion-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 12px;
  cursor: pointer;
  transition: background-color 0.15s;
}

.participant-suggestion-item:hover,
.participant-suggestion-item.selected {
  background-color: var(--bg-hover);
}

.participant-suggestion-avatar {
  width: 28px;
  height: 28px;
  border-radius: 50%;
  background-color: #007acc;
  color: #ffffff;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  font-weight: 600;
  flex-shrink: 0;
}

.participant-suggestion-info {
  flex: 1;
  min-width: 0;
}

.participant-suggestion-name {
  font-size: 13px;
  font-weight: 500;
  color: var(--text-primary);
}

.participant-suggestion-org {
  font-size: 11px;
  color: var(--text-secondary);
  margin-top: 1px;
}

/* Participant Chips Container */
.participant-chips-container {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  padding: 8px 10px;
  background-color: var(--bg-primary);
  border: 1px solid var(--border-color);
  border-radius: 6px;
  min-height: 40px;
  align-items: center;
  cursor: text;
  transition: border-color 0.2s;
}

.participant-chips-container:focus-within {
  border-color: #007acc;
}

.participant-chip {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 4px 8px;
  background-color: #e2e8f0;
  border: 1px solid var(--border-light);
  border-radius: 16px;
  font-size: 12px;
  color: #1a1a1a;
  font-family: "Malgun Gothic", "맑은 고딕", "Apple SD Gothic Neo", sans-serif;
}

.participant-chip.contact {
  background-color: #bfdbfe;
  border-color: #3b82f6;
  border-width: 2px;
  color: #1a1a1a;
}

.participant-chip-icon {
  font-weight: 600;
  opacity: 0.8;
}

.participant-chip-name {
  font-weight: 500;
}

.participant-chip-remove {
  padding: 0;
  margin-left: 2px;
  width: 16px;
  height: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  line-height: 1;
  color: inherit;
  background: none;
  border: none;
  border-radius: 50%;
  cursor: pointer;
  opacity: 0.6;
  transition: opacity 0.15s, background-color 0.15s;
}

.participant-chip-remove:hover {
  opacity: 1;
  background-color: rgba(0, 0, 0, 0.1);
}

.participant-input-inline {
  flex: 1;
  min-width: 120px;
  padding: 4px 0;
  background: transparent;
  border: none;
  outline: none;
  font-size: 13px;
  color: var(--text-primary);
  font-family: "Malgun Gothic", "맑은 고딕", "Apple SD Gothic Neo", sans-serif;
}

.participant-input-inline::placeholder {
  color: var(--text-muted);
}

/* Tag Input Section (for note creation modals) */
.tag-input-section {
  margin-top: 8px;
  border: 1px solid var(--border-light);
  border-radius: 6px;
  overflow: hidden;
}

.tag-input-section-header {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px 12px;
  background-color: var(--bg-hover);
  cursor: pointer;
  user-select: none;
  transition: background-color 0.2s;
}

.tag-input-section-header:hover {
  background-color: var(--bg-secondary);
}

.tag-input-collapse-icon {
  font-size: 10px;
  color: var(--text-secondary);
  transition: transform 0.2s;
}

.tag-input-collapse-icon.collapsed {
  transform: rotate(-90deg);
}

.tag-input-section-title {
  font-size: 13px;
  font-weight: 500;
  color: var(--text-primary);
}

.tag-input-section-count {
  font-size: 11px;
  color: var(--text-secondary);
  background-color: var(--bg-tertiary);
  padding: 2px 6px;
  border-radius: 8px;
}

.tag-input-section-content {
  padding: 8px 12px;
  border-top: 1px solid var(--border-light);
}

.tag-input-facet-row {
  display: flex;
  align-items: flex-start;
  gap: 8px;
  padding: 6px 0;
}

.tag-input-facet-label {
  width: 40px;
  flex-shrink: 0;
  font-size: 11px;
  color: var(--text-secondary);
  padding-top: 4px;
}

.tag-input-facet-content {
  flex: 1;
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  align-items: center;
}

.tag-input-chip {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 3px 8px;
  font-size: 11px;
  font-family: "Malgun Gothic", "맑은 고딕", "Apple SD Gothic Neo", "Noto Sans KR", sans-serif;
  color: var(--text-primary);
  background-color: var(--accent-primary);
  border-radius: 4px;
}

.tag-input-chip-remove {
  padding: 0;
  margin-left: 2px;
  font-size: 14px;
  line-height: 1;
  color: inherit;
  background: none;
  border: none;
  cursor: pointer;
  opacity: 0.7;
}

.tag-input-chip-remove:hover {
  opacity: 1;
}

.tag-input-add-btn {
  width: 22px;
  height: 22px;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  font-size: 14px;
  color: var(--text-secondary);
  background-color: transparent;
  border: 1px dashed var(--border-light);
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.2s;
}

.tag-input-add-btn:hover {
  color: var(--accent-primary);
  border-color: var(--accent-primary);
}

.tag-input-inline {
  flex: 1;
  min-width: 100px;
  padding: 3px 6px;
  font-size: 11px;
  color: var(--text-primary);
  background-color: var(--bg-secondary);
  border: 1px solid var(--accent-primary);
  border-radius: 4px;
  outline: none;
}

.tag-input-inline::placeholder {
  color: var(--text-secondary);
}

/* Tag Input Autocomplete - rendered via Portal */
.tag-input-suggestions {
  background-color: var(--bg-tertiary);
  border: 1px solid var(--border-color);
  border-radius: 4px;
  box-shadow: 0 4px 12px var(--shadow-color);
  max-height: 200px;
  overflow-y: auto;
}

.tag-input-suggestion-item {
  display: block;
  width: 100%;
  padding: 6px 10px;
  font-size: 12px;
  color: var(--text-primary);
  background: none;
  border: none;
  text-align: left;
  cursor: pointer;
  transition: background-color 0.1s;
}

.tag-input-suggestion-item:hover,
.tag-input-suggestion-item.selected {
  background-color: var(--accent-primary);
  color: var(--bg-primary);
}

/* Tag Context Menu */
.tag-context-menu {
  background-color: var(--bg-tertiary);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  box-shadow: 0 4px 16px var(--shadow-color);
  padding: 12px;
  min-width: 200px;
  max-height: min(500px, calc(100vh - 80px));
  overflow-y: auto;
}

.tag-context-menu::-webkit-scrollbar {
  width: 6px;
}

.tag-context-menu::-webkit-scrollbar-track {
  background: transparent;
}

.tag-context-menu::-webkit-scrollbar-thumb {
  background: var(--border-color, #3c3c3c);
  border-radius: 3px;
}

.tag-context-menu::-webkit-scrollbar-thumb:hover {
  background: var(--text-muted, #666);
}

.tag-context-menu-header {
  font-size: 14px;
  font-weight: 600;
  color: var(--text-primary);
  padding-bottom: 8px;
  border-bottom: 1px solid var(--border-light);
  margin-bottom: 10px;
}

.tag-context-menu-section {
  margin-bottom: 10px;
}

.tag-context-menu-label {
  display: block;
  font-size: 11px;
  color: var(--text-secondary);
  margin-bottom: 6px;
}

.tag-context-menu-color-row {
  display: flex;
  align-items: center;
  gap: 8px;
}

.tag-context-menu-color-input {
  width: 32px;
  height: 32px;
  border: 1px solid var(--border-light);
  border-radius: 4px;
  cursor: pointer;
  background: transparent;
}

.tag-context-menu-color-none {
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  color: var(--text-secondary);
  background-color: transparent;
  border: 1px dashed var(--border-light);
  border-radius: 4px;
  cursor: pointer;
}

.tag-context-menu-color-none:hover {
  border-color: var(--accent-primary);
}

.tag-context-menu-color-none.active {
  border-color: var(--accent-primary);
  color: var(--accent-primary);
}

.tag-context-menu-preview {
  flex: 1;
  padding: 4px 10px;
  font-size: 12px;
  font-weight: 600;
  color: #fff;
  text-shadow: 0 1px 2px rgba(0,0,0,0.3);
  border-radius: 4px;
  text-align: center;
}

.tag-context-menu-actions {
  display: flex;
  gap: 8px;
  justify-content: flex-end;
  padding-top: 8px;
  border-top: 1px solid var(--border-light);
  margin-top: 4px;
}

.tag-context-menu-btn {
  padding: 6px 12px;
  font-size: 12px;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.2s;
}

.tag-context-menu-remove {
  color: var(--text-secondary);
  background: transparent;
  border: 1px solid var(--border-light);
}

.tag-context-menu-remove:hover {
  color: #f87171;
  border-color: #f87171;
}

.tag-context-menu-save {
  color: #fff;
  background-color: var(--accent-primary);
  border: none;
}

.tag-context-menu-save:hover {
  background-color: #5a8be0;
}

/* Tag Context Menu Preset Grid */
.tag-context-menu-preset-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 4px;
}

.tag-context-menu-preset-btn {
  width: 28px;
  height: 28px;
  border: 2px solid transparent;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.15s;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  color: var(--text-secondary);
}

.tag-context-menu-preset-btn:hover {
  transform: scale(1.1);
  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
}

.tag-context-menu-preset-btn.active {
  border-color: #fff;
  box-shadow: 0 0 0 2px var(--accent-primary);
}

.tag-context-menu-preset-btn.preset-none {
  border: 2px dashed var(--border-light);
  background-color: transparent !important;
}

.tag-context-menu-preset-btn.preset-none:hover {
  border-color: var(--accent-primary);
}

.tag-context-menu-preset-btn.preset-none.active {
  border-color: var(--accent-primary);
  border-style: solid;
}

/* Unified Color Scheme Grid (10 schemes with light bg + dark border) */
.tag-context-menu-scheme-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 6px;
}

.tag-context-menu-scheme-btn {
  width: 36px;
  height: 36px;
  border: 3px solid;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.15s;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  color: var(--text-secondary);
}

.tag-context-menu-scheme-btn:hover {
  transform: scale(1.08);
  box-shadow: 0 2px 10px rgba(0,0,0,0.25);
}

.tag-context-menu-scheme-btn.active {
  box-shadow: 0 0 0 3px var(--accent-primary), 0 2px 8px rgba(0,0,0,0.2);
}

.tag-context-menu-scheme-btn.preset-none {
  border: 2px dashed var(--border-light);
  font-size: 16px;
}

.tag-context-menu-scheme-btn.preset-none:hover {
  border-color: var(--accent-primary);
}

.tag-context-menu-scheme-btn.preset-none.active {
  border-color: var(--accent-primary);
  border-style: solid;
}

.tag-context-menu-preview-section {
  margin-top: 12px;
  padding-top: 10px;
  border-top: 1px solid var(--border-light);
  display: flex;
  flex-direction: column;
  gap: 6px;
}

/* Settings Tag Color List Updates */
.tag-color-preset-btn {
  width: 20px;
  height: 20px;
  border: 2px solid transparent;
  border-radius: 3px;
  cursor: pointer;
  transition: all 0.15s;
}

.tag-color-preset-btn:hover {
  transform: scale(1.15);
}

.tag-color-preset-btn.active {
  border-color: #fff;
  box-shadow: 0 0 0 2px var(--accent-primary);
}

/* Settings Tag Color Scheme Grid (11 items: 10 colors + no border) */
.tag-color-scheme-grid {
  display: grid !important;
  grid-template-columns: repeat(11, 1fr);
  gap: 4px;
  flex: 1;
}

.tag-color-scheme-btn {
  width: 24px;
  height: 24px;
  border: 2px solid !important;
  border-radius: 4px;
  font-size: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-secondary);
}

.tag-color-scheme-btn.active {
  box-shadow: 0 0 0 2px var(--accent-primary);
}

.tag-color-scheme-btn.preset-none {
  border: 2px dashed var(--border-light) !important;
}

.tag-color-scheme-btn.preset-none.active {
  border-color: var(--accent-primary) !important;
  border-style: solid !important;
}

/* Paper Input Modal */
.paper-input-modal {
  background-color: var(--bg-tertiary);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  width: 480px;
  max-width: 90vw;
  box-shadow: 0 8px 32px var(--shadow-color);
  display: flex;
  flex-direction: column;
}

.paper-input-header {
  padding: 14px 18px;
  border-bottom: 1px solid var(--border-color);
  font-size: 15px;
  font-weight: 600;
  color: var(--text-primary);
}

.paper-input-body {
  padding: 18px;
  display: flex;
  flex-direction: column;
  gap: 14px;
  max-height: 60vh;
  overflow-y: auto;
}

.paper-input-field {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.paper-input-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 14px;
}

.paper-input-label {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.paper-input-input {
  padding: 8px 12px;
  font-size: 14px;
  background-color: var(--bg-primary);
  border: 1px solid var(--border-color);
  border-radius: 4px;
  color: var(--text-primary);
  outline: none;
  transition: border-color 0.2s;
}

.paper-input-input:focus {
  border-color: var(--accent-color, #007acc);
}

.paper-input-actions {
  padding: 12px 18px;
  border-top: 1px solid var(--border-color, #3c3c3c);
  display: flex;
  justify-content: flex-end;
  gap: 10px;
}

.paper-input-btn {
  padding: 6px 14px;
  font-size: 13px;
  border-radius: 4px;
  border: none;
  cursor: pointer;
  font-weight: 500;
  transition: background-color 0.2s;
}

.paper-input-cancel {
  background-color: var(--bg-tertiary);
  color: var(--text-secondary);
}

.paper-input-cancel:hover {
  background-color: var(--bg-hover);
}

.paper-input-submit {
  background-color: #007acc;
  color: #ffffff;
}

.paper-input-submit:hover {
  background-color: #0098ff;
}

/* TagInputSection inside PaperInputModal - scrollable content */
.paper-input-body .tag-input-section-content {
  max-height: 150px;
  overflow-y: auto;
  overflow-x: hidden;
}

/* Literature Input Modal */
.literature-input-modal {
  background-color: var(--bg-secondary, #2d2d2d);
  border: 1px solid var(--border-color, #3c3c3c);
  border-radius: 8px;
  width: 480px;
  max-width: 90vw;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
  display: flex;
  flex-direction: column;
}

.literature-input-header {
  padding: 14px 18px;
  border-bottom: 1px solid var(--border-color, #3c3c3c);
  font-size: 15px;
  font-weight: 600;
  color: var(--text-primary, #e0e0e0);
}

.literature-input-body {
  padding: 18px;
  display: flex;
  flex-direction: column;
  gap: 14px;
  max-height: 60vh;
  overflow-y: auto;
}

.literature-input-field {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.literature-input-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 14px;
}

.literature-input-label {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-muted, #aaa);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.literature-input-input {
  padding: 8px 12px;
  font-size: 14px;
  background-color: var(--bg-primary, #1e1e1e);
  border: 1px solid var(--border-color, #3c3c3c);
  border-radius: 4px;
  color: var(--text-primary, #e0e0e0);
  outline: none;
  transition: border-color 0.2s;
}

.literature-input-input:focus {
  border-color: var(--accent-color, #007acc);
}

.literature-input-actions {
  padding: 12px 18px;
  border-top: 1px solid var(--border-color, #3c3c3c);
  display: flex;
  justify-content: flex-end;
  gap: 10px;
}

.literature-input-btn {
  padding: 6px 14px;
  font-size: 13px;
  border-radius: 4px;
  border: none;
  cursor: pointer;
  font-weight: 500;
  transition: background-color 0.2s;
}

.literature-input-cancel {
  background-color: var(--bg-tertiary);
  color: var(--text-secondary);
}

.literature-input-cancel:hover {
  background-color: var(--bg-hover);
}

.literature-input-submit {
  background-color: #007acc;
  color: #ffffff;
}

.literature-input-submit:hover {
  background-color: #0098ff;
}

/* TagInputSection inside LiteratureInputModal - scrollable content */
.literature-input-body .tag-input-section-content {
  max-height: 150px;
  overflow-y: auto;
  overflow-x: hidden;
}

/* Event Input Modal */
.event-input-modal {
  background-color: var(--bg-secondary, #2d2d2d);
  border: 1px solid var(--border-color, #3c3c3c);
  border-radius: 8px;
  width: 480px;
  max-width: 90vw;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
  display: flex;
  flex-direction: column;
}

.event-input-header {
  padding: 14px 18px;
  border-bottom: 1px solid var(--border-color, #3c3c3c);
  font-size: 15px;
  font-weight: 600;
  color: var(--text-primary, #e0e0e0);
}

.event-input-body {
  padding: 18px;
  display: flex;
  flex-direction: column;
  gap: 14px;
  max-height: 60vh;
  overflow-y: auto;
  overflow: visible;  /* ParticipantInput suggestions가 모달 밖으로 나갈 수 있도록 */
}

.event-input-field {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.event-input-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 14px;
}

.event-input-label {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-muted, #aaa);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.event-input-input {
  padding: 8px 12px;
  font-size: 14px;
  background-color: var(--bg-primary, #1e1e1e);
  border: 1px solid var(--border-color, #3c3c3c);
  border-radius: 4px;
  color: var(--text-primary, #e0e0e0);
  outline: none;
  transition: border-color 0.2s;
}

.event-input-input:focus {
  border-color: var(--accent-color, #007acc);
}

.event-input-actions {
  padding: 12px 18px;
  border-top: 1px solid var(--border-color, #3c3c3c);
  display: flex;
  justify-content: flex-end;
  gap: 10px;
}

.event-input-btn {
  padding: 6px 14px;
  font-size: 13px;
  border-radius: 4px;
  border: none;
  cursor: pointer;
  font-weight: 500;
  transition: background-color 0.2s;
}

.event-input-cancel {
  background-color: var(--bg-tertiary);
  color: var(--text-secondary);
}

.event-input-cancel:hover {
  background-color: var(--bg-hover);
}

.event-input-submit {
  background-color: #007acc;
  color: #ffffff;
}

.event-input-submit:hover {
  background-color: #0098ff;
}

/* Confirm Delete Modal */
.confirm-delete-modal {
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  width: 380px;
  max-width: 90vw;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
  display: flex;
  flex-direction: column;
}

.confirm-delete-header {
  padding: 14px 18px;
  border-bottom: 1px solid var(--border-color);
  font-size: 15px;
  font-weight: 600;
  color: #e06c75;
}

.confirm-delete-body {
  padding: 18px;
}

.confirm-delete-message {
  color: var(--text-primary);
  font-size: 14px;
  margin: 0 0 8px 0;
}

.confirm-delete-message strong {
  color: var(--text-primary);
  font-weight: 600;
}

.confirm-delete-warning {
  color: var(--text-muted);
  font-size: 13px;
  margin: 0;
}

.confirm-delete-actions {
  padding: 12px 18px;
  border-top: 1px solid var(--border-color);
  display: flex;
  justify-content: flex-end;
  gap: 10px;
}

.confirm-delete-btn {
  padding: 6px 14px;
  font-size: 13px;
  border-radius: 4px;
  border: none;
  cursor: pointer;
  font-weight: 500;
  transition: background-color 0.2s;
}

.confirm-delete-cancel {
  background-color: var(--bg-tertiary);
  color: var(--text-secondary);
}

.confirm-delete-cancel:hover {
  background-color: var(--bg-hover);
}

.confirm-delete-confirm {
  background-color: #e06c75;
  color: #ffffff;
}

.confirm-delete-confirm:hover {
  background-color: #d95763;
}

/* Alert Modal */
.alert-modal {
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  width: 420px;
  max-width: 90vw;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
  display: flex;
  flex-direction: column;
}

.alert-modal-header {
  padding: 14px 18px;
  border-bottom: 1px solid var(--border-color);
  font-size: 15px;
  font-weight: 600;
  color: #f0a020;
}

.alert-modal-body {
  padding: 18px;
}

.alert-modal-message {
  color: var(--text-primary);
  font-size: 14px;
  margin: 0;
  line-height: 1.6;
  white-space: pre-wrap;
}

.alert-modal-actions {
  padding: 12px 18px;
  border-top: 1px solid var(--border-color);
  display: flex;
  justify-content: flex-end;
}

.alert-modal-btn {
  padding: 6px 18px;
  font-size: 13px;
  border-radius: 4px;
  border: none;
  cursor: pointer;
  font-weight: 500;
  background-color: #007acc;
  color: #ffffff;
  transition: background-color 0.2s;
}

.alert-modal-btn:hover {
  background-color: #0098ff;
}

/* ============================================================ */
/* Vault Lock Modal */
/* ============================================================ */
.vault-lock-modal {
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  width: 420px;
  max-width: 90vw;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
  display: flex;
  flex-direction: column;
}

.vault-lock-modal-header {
  padding: 16px 20px;
  border-bottom: 1px solid var(--border-color);
  display: flex;
  align-items: center;
  gap: 10px;
}

.vault-lock-modal-header .vault-lock-icon {
  font-size: 20px;
}

.vault-lock-modal-header h2 {
  margin: 0;
  font-size: 16px;
  font-weight: 600;
  color: #f0a020;
}

.vault-lock-modal-body {
  padding: 20px;
}

.vault-lock-message {
  color: var(--text-primary);
  font-size: 14px;
  margin: 0 0 16px 0;
  line-height: 1.5;
}

.vault-lock-info {
  background-color: var(--bg-primary);
  border: 1px solid var(--border-color);
  border-radius: 6px;
  padding: 12px 16px;
  margin-bottom: 16px;
}

.vault-lock-info-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 4px 0;
}

.vault-lock-info-label {
  color: var(--text-secondary);
  font-size: 13px;
}

.vault-lock-info-value {
  color: var(--text-primary);
  font-size: 13px;
  font-weight: 500;
}

.vault-lock-stale-warning {
  color: #4ade80;
  font-size: 13px;
  margin: 0;
  padding: 10px 12px;
  background-color: rgba(74, 222, 128, 0.1);
  border-radius: 4px;
  line-height: 1.5;
}

.vault-lock-active-warning {
  color: #f0a020;
  font-size: 13px;
  margin: 0;
  padding: 10px 12px;
  background-color: rgba(240, 160, 32, 0.1);
  border-radius: 4px;
  line-height: 1.5;
}

.vault-lock-modal-footer {
  padding: 14px 20px;
  border-top: 1px solid var(--border-color);
  display: flex;
  justify-content: flex-end;
  gap: 10px;
}

.vault-lock-btn {
  padding: 8px 18px;
  font-size: 13px;
  border-radius: 4px;
  border: none;
  cursor: pointer;
  font-weight: 500;
  transition: all 0.2s;
}

.vault-lock-btn.cancel {
  background-color: var(--bg-tertiary);
  color: var(--text-secondary);
}

.vault-lock-btn.cancel:hover {
  background-color: var(--bg-hover);
}

.vault-lock-btn.force {
  color: #ffffff;
}

.vault-lock-btn.force.recommended {
  background-color: #4ade80;
}

.vault-lock-btn.force.recommended:hover {
  background-color: #22c55e;
}

.vault-lock-btn.force.dangerous {
  background-color: #e06c75;
}

.vault-lock-btn.force.dangerous:hover {
  background-color: #d95763;
}

/* ============================================================ */
/* Window Context Menu - Hover Panel Window Actions */
/* ============================================================ */
.window-context-menu {
  position: fixed;
  z-index: 999999;
  background: var(--bg-tertiary);
  border: 1px solid var(--border-light);
  border-radius: 4px;
  padding: 4px;
  box-shadow: 0 4px 12px var(--shadow-color);
  min-width: 120px;
  max-height: min(500px, calc(100vh - 80px));
  overflow-y: auto;
}

.window-context-menu::-webkit-scrollbar {
  width: 6px;
}

.window-context-menu::-webkit-scrollbar-track {
  background: transparent;
}

.window-context-menu::-webkit-scrollbar-thumb {
  background: var(--border-color, #3c3c3c);
  border-radius: 3px;
}

.window-context-menu::-webkit-scrollbar-thumb:hover {
  background: var(--text-muted, #666);
}

.window-context-menu-item {
  display: block;
  width: 100%;
  padding: 6px 12px;
  background: transparent;
  border: none;
  color: var(--text-secondary);
  font-size: 13px;
  text-align: left;
  cursor: pointer;
  border-radius: 3px;
  transition: background-color 0.15s;
}

.window-context-menu-item:hover {
  background: var(--bg-hover);
  color: var(--text-primary);
}

.window-context-menu-item-danger {
  color: #e06c75;
}

.window-context-menu-item-danger:hover {
  background: rgba(224, 108, 117, 0.15);
  color: #ff7b85;
}

/* ============================================================ */
/* Update Checker */
/* ============================================================ */
.update-checker {
  position: fixed;
  bottom: 20px;
  right: 20px;
  z-index: 10000;
  background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%);
  border: 1px solid rgba(96, 165, 250, 0.4);
  border-radius: 12px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4), 0 0 0 1px rgba(255, 255, 255, 0.05);
  min-width: 320px;
  max-width: 400px;
  animation: slideInUp 0.3s ease-out;
}

@keyframes slideInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.update-checker-content {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  padding: 16px;
}

.update-checker-icon {
  flex-shrink: 0;
  width: 36px;
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(96, 165, 250, 0.2);
  border-radius: 8px;
  color: #60a5fa;
}

.update-checker-info {
  flex: 1;
  min-width: 0;
}

.update-checker-title {
  font-size: 14px;
  font-weight: 600;
  color: #ffffff;
  margin-bottom: 4px;
}

.update-checker-body {
  font-size: 12px;
  color: rgba(255, 255, 255, 0.7);
  line-height: 1.4;
  margin-bottom: 8px;
}

.update-checker-error {
  font-size: 12px;
  color: #f87171;
  margin-top: 4px;
}

.update-checker-progress {
  position: relative;
  height: 6px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 3px;
  overflow: hidden;
  margin-top: 8px;
}

.update-checker-progress-bar {
  position: absolute;
  left: 0;
  top: 0;
  height: 100%;
  background: linear-gradient(90deg, #60a5fa, #3b82f6);
  border-radius: 3px;
  transition: width 0.3s ease;
}

.update-checker-progress-text {
  position: absolute;
  right: 0;
  top: -18px;
  font-size: 11px;
  color: rgba(255, 255, 255, 0.7);
}

.update-checker-actions {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-shrink: 0;
}

.update-checker-btn {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 14px;
  border: none;
  border-radius: 6px;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
}

.update-checker-btn-primary {
  background: #3b82f6;
  color: #ffffff;
}

.update-checker-btn-primary:hover {
  background: #2563eb;
}

.update-checker-btn-dismiss {
  background: rgba(255, 255, 255, 0.1);
  color: rgba(255, 255, 255, 0.7);
  padding: 8px;
}

.update-checker-btn-dismiss:hover {
  background: rgba(255, 255, 255, 0.15);
  color: #ffffff;
}

.update-checker-installing {
  font-size: 13px;
  color: #60a5fa;
  font-weight: 500;
}
/* ============================================================ */
/* Loading Screen */
/* ============================================================ */
.loading-screen {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: var(--bg-primary, #1a1a2e);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.loading-content {
  text-align: center;
  animation: slideUp 0.5s ease;
}

@keyframes slideUp {
  from {
    transform: translateY(20px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

.loading-spinner {
  width: 60px;
  height: 60px;
  border: 4px solid var(--border-color, rgba(0, 255, 213, 0.2));
  border-top: 4px solid var(--accent, #00ffd5);
  border-radius: 50%;
  margin: 0 auto 24px;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

.loading-text {
  font-size: 32px;
  font-weight: 600;
  color: var(--text-primary, #e0e0e0);
  margin-bottom: 12px;
  letter-spacing: 0.5px;
}

.loading-status {
  font-size: 14px;
  color: var(--text-muted, #888);
  min-height: 20px;
}

/* ============================================================ */
/* HoverWindowApp - Separate OS Window Mode */
/* ============================================================ */

.hover-window-app {
  width: 100vw;
  height: 100vh;
  background-color: var(--bg-primary);
  color: var(--text-primary);
  overflow: hidden;
  /* Content ready before show() - instant display */
  opacity: 1;
}

.hover-window-app.closing {
  opacity: 0;
  transition: opacity 0.1s ease-out;
}

.hover-window-app .hover-editor {
  position: relative;
  width: 100%;
  height: 100%;
  border: none;
  border-radius: 0;
  box-shadow: none;
}

.hover-window-app .hover-title-bar {
  display: none; /* Window uses OS decorations */
}

.hover-window-loading {
  width: 100vw;
  height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: var(--bg-primary);
}

.hover-window-error {
  width: 100vw;
  height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: var(--bg-primary);
  color: var(--text-secondary);
  font-size: 14px;
}
